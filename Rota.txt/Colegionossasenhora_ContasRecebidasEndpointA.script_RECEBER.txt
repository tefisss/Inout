{import: io_contabil.PadroesERP};
{import: io_contabil.PadroesCartoes};
{import: io_contabil.Database};
{import: io_contabil.Regras};
{import: io_contabil.Duplicatas};
{import: io_contabil.Util};
{import: io_contabil.Classes.Extrato};
// TEMPLATE 22.08.2019
// CORRIGIDO BUGS DE EXTRATOS QUE TRATAVAM EM 2/4
// Adicionado tratamento para identificar um terceiro padrao de cartao CIELO na funcao readCartaoCieloExcel2. @Becker
// Adicionado tratamento [comentado] de comparacao de razaoSocial entre movimento e duplicata. @Becker
// Alteracao no padrao de leitura de data para deta serial. @Becker
// Regra nova "getTratarValorAlternativo", feita pra diferenciar qual ? o valor alternativo na coluna. @Vinicios
public JSONArray run(InoutLogger logger) throws Exception {

    JSONArray  records  = new JSONArray();
    JSONObject ultimoJS = new JSONObject();

    // Carrega as propriedades
    SysProperties props = SysProperties.getInstance();
    JSONObject roteiroCRMPrincipal = getRoteiro();
    JSONObject roteiroCRM = getRoteiro();
    JSONObject jStatus = new JSONObject();

    JSONObject objetoRoteiro = new JSONObject();
    objetoRoteiro.put("contabilidade", roteiroCRM.optString("contabilidade"));
    props.load("contabil/" + roteiroCRM.optString("contabilidade") + "/contabil.properties");

    //Conectar na Base de Dados IO_CONTABIL.
    DataBase dbIOCont = null;

    String empresa = getNomeEmpresa();
    String codEmpresa = props.get(empresa + "_COD_EMPRESA");
    String ERPContabil = props.get("ERP_CONTABILIDADE");
    String nomeEmpresa = props.get(empresa + "_NOME_EMPRESA");
    String cnpjEmpresa = props.get(empresa + "_CNPJ_EMPRESA");
    String emailResponsavel = props.get(empresa + "_EMAIL_RESPONSAVEL");
    String emailCanal = props.get("EMAIL_CANAL");

    String tipoLancamento = getNomeRota();
    if (tipoLancamento.toUpperCase().contains("PAGAS"))    tipoLancamento = "PAGAR";
    if (tipoLancamento.toUpperCase().contains("RECEBIDA")) tipoLancamento = "RECEBER";


    String compDirName = nomeEmpresa + "_#" + codEmpresa;
    String dirName = "";
    if (tipoLancamento.contains("PAGAR"))   dirName = RouteEngine.INOUT_HOME + "/contabil/" + roteiroCRM.optString("contabilidade") + "/" + compDirName + "/APagar";
    if (tipoLancamento.contains("RECEBER")) dirName = RouteEngine.INOUT_HOME + "/contabil/" + roteiroCRM.optString("contabilidade") + "/" + compDirName + "/AReceber";


    String backupDirName = dirName + "/Processado";

    boolean erroShrink = false;
    boolean geraCabecalhoCordilheira = true;
    boolean cabecalhoNaoEncontrada        = true;
    boolean apagaExtrato        = false;
    boolean geraRegraPortador   = false;
    boolean comparaRazao        = false;
    String tipoEmail            = "";

    HashMap mapaVariavel		= new HashMap();
    HashMap mapaLote			= new HashMap();
    HashMap mapaDePara			= new HashMap();
    HashMap mapaOficial			= new HashMap();
	HashMap mapaDesconto		= new HashMap();
	HashMap mapaJuros   		= new HashMap();
	HashMap mapaPlano   		= new HashMap();
	HashMap mapaParcelaDominio	= new HashMap();
	HashMap mapaFornecedor 		= new HashMap();
	HashMap mapaPartPlano 		= new HashMap();

	JSONObject recordF = new JSONObject();


    String cruzaExtrato			= "";
    String Cruza_Extrato_com_Extrato = "";
    String mesAnoAnterior		= "";
    String mesAno2Anterior		= "";
    String mesAnoAtual			= "";
    int mesRef					= 0;
    int anoRef					= 0;
    String contaJuros			= "";
    String contaDesconto		= "";
    String contaMulta			= "";
    String contaTransitoria		= "";
    String contaEmpresaBranco	= "";
    String movimentoPortador	= "";
    String contaFixaDebito		= "";
    String contaFixaCredito		= "";
    String contaPortador		= "";		//pg - cred | rec - deb
    String contaMovimento		= "";		//pg - deb | rec - cred
    String tabelaContabil       = "";
    String dataMovimento        = "";
    String classificaPlano      = "";
    String classificaFornec     = "";

    boolean geraFiscal			= false;
    String loteFiscal			= "";
	boolean apagaStatus         = false;

    String Conta_Fixa_Cruzamento_Extrato = "";
    String contaInvertida	= "";
    String contaBuscaPlano	= "";
    String nomeArquivo      = "";
    String chave			= "";
    String classificacao	= "";
    String dataLote			= DateUtil.dateToString(new Date(),"yyyy-MM");
    String lote				= "";
    boolean enviouEmail 	= false;
    boolean primeiraVezDuplicata	= true;
    boolean primeiroArquivo 		= true;
    String regraContaMovimento 		= "";
    String regraHistorico 			= "";
    String separadorCsv				= "";
    String tipoPlanilha				= "";
	boolean dupliNaoEncontContabil	= false;
	String contaTemp				= "";
	boolean acumulouAntes			= false;
	boolean leuFinanceiro			= false;

    try {

		// #DOCUMENTACAO
		// FOR leitura dos arquivos das extensoes abaixo
		// altera-se aqui para NAO LER xlsx por exemplo
		
        String extensao = "";
        for(int extArquivo = 0; extArquivo < 15; extArquivo++){
            if(extArquivo == 0) extensao = ".ofx,.OFX";
            if(extArquivo == 1) extensao = ".ofx,.OFX";
            if(extArquivo == 2) extensao = ".ofx,.OFX";
            if(extArquivo == 3) extensao = ".csv,.CSV";
            if(extArquivo == 4) extensao = ".csv,.CSV";
            if(extArquivo == 5) extensao = ".csv,.CSV";
            if(extArquivo == 6) extensao = ".xlsx,.XLSX";
            if(extArquivo == 7) extensao = ".xlsx,.XLSX";
            if(extArquivo == 8) extensao = ".xlsx,.XLSX";
            if(extArquivo == 9) extensao = ".txt,.TXT";
            if(extArquivo == 10) extensao = ".txt,.TXT";
            if(extArquivo == 11) extensao = ".txt,.TXT";
            if(extArquivo == 12) extensao = ".pdf,.PDF";
            if(extArquivo == 13) extensao = ".pdf,.PDF";
            if(extArquivo == 14) extensao = ".pdf,.PDF";


            for (int porAba = 0; porAba < 60; porAba++) {



				// #DOCUMENTACAO
				// tratamento de abas vindas do CRM
                String apagaArquivo		= backupDirName;
                String abasEspecificas	= roteiroCRMPrincipal.optString("Abas_Especificas");
                abasEspecificas 		= abasEspecificas.replace(",",";");
                if (abasEspecificas.equals("")) {
                    if (porAba > 0) break;
                }
                if (!abasEspecificas.equals("")) {
                    if (!abasEspecificas.contains(String.valueOf(porAba))) {
                        continue;
                    }

                    String ultimaAba = abasEspecificas;
                    if (ultimaAba.contains(";")) ultimaAba = ultimaAba.substring(ultimaAba.lastIndexOf(";")+1).trim();
                    if (!ultimaAba.equals(String.valueOf(porAba)) && extensao.contains(".XLSX")) apagaArquivo = null;
                }

				// #DOCUMENTACAO
				// auto ajuste do separador de CSV
                if(extensao.contains("CSV")){
                    FilesLoader fileLoader2 = new FilesLoader(dirName, extensao, null, true, logger);
                    fileLoader2.loadFiles();
                    for (MemoryFile memFile: fileLoader2.getMemFiles()) {
                        if(memFile.getFilename().startsWith("OK_DeParaConta__")) importaDePara(memFile, dirName, extensao, logger);
                        if (memFile.getFilename().toUpperCase().contains("CSV")) {
                            while (memFile.hasNextLine()) {
                                try {
                                    String line = memFile.nextLine();
                                    line = StringUtil.removeSpecialCharsToUC(line).replaceAll("\"","");
                                    if (line.length() < 10) continue;
                                    String [] fields1 = line.split(";");
                                    String [] fields2 = line.split(",");
                                    if(fields1.length > 0 && fields2.length > 0){
                                        if(fields1.length < fields2.length) { separadorCsv = ","; break; }
                                        if(fields1.length > fields2.length) { separadorCsv = ";"; break; }
                                    }
                                }
                                catch(Exception xx) {}
                            }
                            break;
                        }
                    }
                }

				// #DOCUMENTACAO
				// carregamento do arquivo
                FilesLoader fileLoader = new FilesLoader(dirName, extensao, apagaArquivo, true, logger);
                int[] abas = {porAba};
                fileLoader.setSheetsToRead(abas);
                fileLoader.loadFiles();

                for (MemoryFile memFile: fileLoader.getMemFiles()) {

                    putStatus(dirName, "01--Etapa 1 de 4--" + tipoLancamento + ".status", jStatus, logger);

                    // =======================  =================   =======================
                    // =======================  VARIAVEIS PADROES   =======================
                    // =======================  =================   =======================
                    String historico      = "";

                    String codCcOrigem    = "";
                    String cpfCnpj        = "";
                    String nomeOrigem     = "";
                    String nomePortador   = "";
                    String nomePortador2  = "";
                    String documento      = "";
                    int    parcelaDoc     = 1;
                    double valorDocumento = 0.00;
                    double valorPagamento = 0.00;
                    double valorDesconto  = 0.00;
                    double valorJuros     = 0.00;
                    double valorMulta     = 0.00;
					double valorAlternativo = 0;
					
                    int icodCcOrigem    = -1;
                    int icpfCnpj        = -1;
                    int inomeOrigem     = -1;
                    int inomePortador   = -1;
                    int idocumento      = -1;
                    int idataMovimento  = -1;
                    int ivalorDocumento = -1;
                    int ivalorAlternativo = -1;
                    int ivalorPagamento = -1;
                    int ivalorDesconto  = -1;
                    int ivalorJuros     = -1;
                    int ivalorMulta     = -1;
                    int icomplemento01  = -1;
                    int icomplemento02  = -1;
                    int icomplemento03	= -1;
                    int icomplemento04  = -1;
                    int icomplemento05	= -1;
                    int icomplemento06	= -1;
                    int icomplemento07	= -1;
                    int icomplemento08	= -1;
                    int icomplemento09	= -1;
                    int icomplemento10	= -1;
                    int idataFake		= -1;

                    String contaGetConta	= "";
                    contaPortador	= "";		//pg - cred | rec - deb
                    contaMovimento	= "";		//pg - deb | rec - cred


                    String complemento01	= "";
                    String complemento02	= "";
                    String complemento03	= "";
                    String complemento04	= "";
                    String complemento05	= "";
                    String complemento06	= "";
                    String complemento07	= "";
                    String complemento08	= "";
                    String complemento09	= "";
                    String complemento10	= "";
                    String codCentroCusto	= "";
                    String codFilial        = "";

                    double valorTotalDoc	= 0.0;
                    double valorTotalJuros	= 0.0;
                    double valorTotalDesc	= 0.0;

                    String classJur			= "";
                    String classDes			= "";
                    String classMul			= "";

                    String codErroString	= "";
                    int cont				= 0;
                    String linhasProblema	= "";
                    String idEmpresa        = "";
                    String idRoteiro  	    = "";

                    String histAux			= "";
                    String anoData			= "";
                    boolean zerar			= true;
					boolean filtro			= true;

                    String lerAposPrincipal   = "";
                    boolean isLinhaPrincipal  = false;
                    boolean ignorarAntes	  = false;
                    boolean tratarComoExtrato = false;
					boolean tratarComoDesconto = false;
					boolean tratarComoJuros = false;

					dataMovimento        = "";


					// #DOCUMENTACAO
					// definicao de separador do arquivo
					// se ouver separador em TXT deve ser tratado caso a caso
					// evitar usar tabulacao como separador 
                    if(extensao.contains(".xlsx,.XLSX")) memFile.setFieldSeparator("\\|");
                    if(extensao.contains(".pdf,.PDF"))   memFile.setFieldSeparator("\\|");
                    if(extensao.contains(".csv,.CSV"))	 memFile.setFieldSeparator(separadorCsv);
					
					//nao pode usar o line contem  ';' pois nao existe line neste ponto ainda.
					if(roteiroCRM.optString("Integracao_fiscal").toUpperCase().contains("TRUE") && roteiroCRM.optString("erpContabilidade").contains("DOMINIO")) {
						if(extensao.contains(".txt,.TXT"))	 memFile.setFieldSeparator(";");
					}
					
                    nomeArquivo = memFile.getFilename().replace("%","");


					// #DOCUMENTACAO
					// conecta ao BANCO DE DADOS
                    if (dbIOCont == null) {
                        dbIOCont = connectIOContabil(props, logger);
                    }

                    if(primeiroArquivo) {
                        limparIORoteiro(codEmpresa, tipoLancamento, dbIOCont, logger);
                        primeiroArquivo = false;
                    }

                    //########################################################################

                    contaJuros		    = roteiroCRM.optString("contaFixaJuros");
                    contaFixaCredito    = roteiroCRM.optString("contaFixaCredito");
                    contaFixaDebito     = roteiroCRM.optString("contaFixaDebito");
                    contaDesconto 	    = roteiroCRM.optString("contaFixaDesconto");
                    contaMulta		    = roteiroCRM.optString("contaFixaMulta");
                    idEmpresa      	    = roteiroCRM.optString("idEmpresa");
                    idRoteiro   	    = roteiroCRM.optString("idRoteiro");
                    movimentoPortador   = roteiroCRM.optString("movimentoPortador");
                    classificaPlano     = roteiroCRM.optString("classificaPlano");
                    classificaFornec    = roteiroCRM.optString("classificaFornec");
                    cruzaExtrato	    = roteiroCRM.optString("cruzaExtrato").toUpperCase();
                    Cruza_Extrato_com_Extrato = roteiroCRM.optString("Cruza_Extrato_com_Extrato").toUpperCase();

                    tipoPlanilha = "MOVIMENTO";
                    boolean enviaEmailExtrato = false;
                    boolean naoLeMais = false;

                    tipoEmail = "CLIENTE";
                    if (nomeArquivo.toUpperCase().contains("OTTIMIZZA"))  tipoEmail = "CANAL";
                    if (nomeArquivo.toUpperCase().contains("OTTIMIZZAF")) tipoEmail = "SUPORTE";

                    String debitoCredito   		 = "";
                    String chaveExtrato    		 = "";


                    //if(roteiroCRM.has("contaBuscaPlano"))contaBuscaPlano = roteiroCRM.optString("contaBuscaPlano");

                    //########################################################################

                    // COLOCAR AQUI funcao para carregar variaveis do cliente
                    // CNPJ, EMAIL, contas fixas, etc.


                    // =======================  ========================   =======================
                    // =======================  VARIAVEIS PERSONALIZADAS   =======================
                    // =======================  ========================   =======================


                    JSONObject objetoParametro = new JSONObject();

					// #DOCUMENTACAO
					// busca de indices da planilha principal
                    if (tipoPlanilha.equals("MOVIMENTO")) {
                        roteiroCRM = getRoteiro();

                        inomeOrigem     = getIndice("nomeOrigem", inomeOrigem, roteiroCRM);
						idataMovimento  = getIndice("dataMovimento", idataMovimento, roteiroCRM);
						inomePortador   = getIndice("nomePortador", inomePortador, roteiroCRM);
						idocumento      = getIndice("documento", idocumento, roteiroCRM);
						ivalorDocumento = getIndice("valorDocumento", ivalorDocumento, roteiroCRM);
						ivalorJuros     = getIndice("valorJuros", ivalorJuros, roteiroCRM);
						ivalorDesconto  = getIndice("valorDesconto", ivalorDesconto, roteiroCRM);
						ivalorMulta     = getIndice("valorMulta", ivalorMulta, roteiroCRM);
						icodCcOrigem    = getIndice("codCcOrigem", icodCcOrigem, roteiroCRM);
						ivalorPagamento = getIndice("valorPagamento", ivalorPagamento, roteiroCRM);
						ivalorAlternativo = getIndice("valorAlternativo", ivalorAlternativo, roteiroCRM);
						icomplemento01  = getIndice("complemento01", icomplemento01, roteiroCRM);
						icomplemento02	= getIndice("complemento02", icomplemento02, roteiroCRM);
						icomplemento03  = getIndice("complemento03", icomplemento03, roteiroCRM);
						icomplemento04  = getIndice("complemento04", icomplemento04, roteiroCRM);
						icomplemento05  = getIndice("complemento05", icomplemento05, roteiroCRM);
						icomplemento06  = getIndice("complemento06", icomplemento06, roteiroCRM);
						icomplemento07  = getIndice("complemento07", icomplemento07, roteiroCRM);
						icomplemento08  = getIndice("complemento08", icomplemento08, roteiroCRM);
						icomplemento09  = getIndice("complemento09", icomplemento09, roteiroCRM);
						icomplemento10  = getIndice("complemento10", icomplemento10, roteiroCRM);
						idataFake		= getIndice("dataFake", idataFake, roteiroCRM);
						icpfCnpj		= getIndice("cpfCnpj", icpfCnpj, roteiroCRM);
						
						zerar 			= !Boolean.parseBoolean(roteiroCRM.optString("naoZerarValores").toLowerCase().trim());
                    }

					jStatus = new JSONObject();
					putStatus(dirName, "", jStatus, logger);
					try{
						// #DOCUMENTACAO
						// leitura linha a linha
						while (memFile.hasNextLine()) {

							try {
								String line = memFile.nextLine();
								line = StringUtil.removeSpecialCharsToUC(line);

								if (cont < 10)  putStatus(dirName, "02--Etapa 2 de 4--" + tipoLancamento + ".status", jStatus, logger);    



								////////////////////////////////////////////////////////////////////////////////
								///////////////////////////////////////////////////////////// INICIO DOS PADROES
								////////////////////////////////////////////////////////////////////////////////


								//--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
								//LEITURA PADRAO ARQUIVOS .OFX
								//--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
								if (nomeArquivo.toUpperCase().contains(".OFX")) {
									tipoPlanilha = "EXTRATO-OFX";     putStatus(dirName, "02--Etapa 2 de 4--" + tipoLancamento + ".status", new JSONObject(), logger);
									JSONObject jDados = new JSONObject();
									jDados.put("CODEMPRESA", codEmpresa);
									jDados.put("TIPOLANCAMENTO", tipoLancamento);
									jDados.put("NOMEEMPRESA",    nomeEmpresa);
									jDados.put("NOMEARQUIVO",    nomeArquivo);
									if (roteiroCRM.optString("Aloca_Checknum").toUpperCase().equals("TRUE")) jDados.put("CHECKNUM", "CHECKNUM");	//usar para retornar o documento do OFX no complemento02
									readOFXDefault(memFile, jDados, dbIOCont, logger);
									jStatus = new JSONObject();
									putStatus(dirName, "", jStatus, logger);
									break;
								} // Fim  -> Captura de Dados quando Tipo Planilha -> ".OFX"
								// ----------------------------------------------------------------------------------------------------------

								if (!roteiroCRM.optString("Planilhas_Padroes").equals("") && apagaArquivo != null) {

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //  LEITURA PADRAO - EXTRATO - BRADESCO TXT
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Bradesco_TXT")) {
                                            // Nome Portador  ->  "BRADESCO {AGENCIA} {CONTA}"
                                            if (line.contains("EXTRATO DE: AG") && line.contains("NCIA:") && line.contains("CONTA:")) {
                                                nomePortador = ("BRADESCO " + line.substring(line.indexOf("NCIA:")+5, line.indexOf("NCIA:")+11).trim() + " " + line.substring(line.indexOf("CONTA:")+6).trim()).trim();

                                                tipoPlanilha = "EXTRATO-BRADESCO-TXT";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                
                                                readExtratoBradescoTxt(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO BANCO BRADESCO TXT"

                                        //  LEITURA PADRAO - EXTRATO - BANESTE
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Banestes_Excel")) {

                                            if (line.toUpperCase().trim().startsWith("BANESTES S/A") && 
                                                    line.toUpperCase().trim().contains("SISTEMA DE SALDOS")&&
                                                        line.toUpperCase().trim().contains("EXTRATOS")) {
                                                tipoPlanilha = "EXTRATOBANESTE";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);

                                                readExtratoBanesteDefault(memFile, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO BANESTE"
                                        
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        // 								LEITURA PADRAO - BEN VISA  									     //
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_BenVisa_Excel") && nomeArquivo.toUpperCase().contains("BEN") && nomeArquivo.toUpperCase().contains("VISA")) {
                                            String lineAux = line.replaceAll("\"", "");
                                            if (lineAux.contains("NRO DOC") &&
                                            lineAux.contains("ESTABELECIMENTO") &&
                                            lineAux.contains("CNPJ") &&
                                            lineAux.contains("VALOR") &&
                                            lineAux.contains("VENDA") &&
                                            lineAux.contains("TAXAS")) {
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readCartaoBenVisaExcel(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //  LEITURA PADRAO - EXTRATO - Extrato_Daycoval_Excel
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Daycoval_Excel")) {
                                            if (nomeArquivo.toUpperCase().contains("DAYCOVAL") && (extensao.contains(".xlsx,.XLSX") || extensao.contains(".csv,.CSV")) ) {
                                                tipoPlanilha = "EXTRATODAYCOVAL";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);

                                                readExtratoDaycoval(memFile, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO Daycoval"

                                        //  LEITURA PADRAO - EXTRATO - SICOOB
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Sicoob_Txt")) {

                                            if (line.startsWith("SICOOB")) {
                                                tipoPlanilha = "EXTRATOSICOOB";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);

                                                readExtratoSicoobTxt(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO SICOOB"


                                         //  LEITURA PADRAO - EXTRATO - Sicredi
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Sicredi_TXT")) {
                                            if (line.contains("COOP") && line.contains("CRED") && line.contains("EXTRATO") && line.contains("CONTA") && line.contains("CORRENTE")) {
                                                tipoPlanilha = "EXTRATOSICREDI";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);

                                                readExtratoSicrediTxt(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO SICOOB"

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - Topazio
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Topazio_Excel")) {
                                            if(line.contains("TOPAZ BANKING")) {


                                                tipoPlanilha = "EXTRATOTOPAZIO";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                                readExtratoTopazioExcel(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }

                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - UNICRED
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if(roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Unicred_TXT") && nomeArquivo.toUpperCase().contains(".TXT") && nomeArquivo.toUpperCase().contains("UNICRED")){
                                            tipoPlanilha = "EXTRATO-UNICRED";
                                            JSONObject jDados = new JSONObject();
                                            jDados.put("CODEMPRESA", codEmpresa);
                                            jDados.put("NOMEARQUIVO", nomeArquivo);
                                            readExtratoUNICREDDefault(memFile, jDados, dbIOCont, logger);
                                            putStatus(dirName, "", jStatus, logger);
                                            break;
                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - SEM PARAR
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Sem_Parar_Csv")) {


                                            if (memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("LOCAL") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA LOTE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(8).replaceAll("\"","").contains("VALOR ACEITO") && 
                                                memFile.getStringFieldRemoveEspCharsUpper(9).replaceAll("\"","").contains("VALOR REPASSE")) {
                                                tipoPlanilha = "CARTAO-SEM PARAR";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                                mapaVariavel = readExtratoSemParar(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } 
                                            
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("LOCAL") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA LOTE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").replace("\"","").replace("'","").equals("LOTE") && 
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("ENV. ")&&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("ENV. ") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("REJ. ") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(6).replaceAll("\"","").contains("REJ. ") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(7).replaceAll("\"","").contains("ACEITO ") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(8).replaceAll("\"","").contains("ACEITO ") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(9).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA REPASSE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(10).replaceAll("\"","").contains("REPASSE ")){
                                                tipoPlanilha = "SEMPARARNOVO";
                                                
                                                JSONObject jDados = new JSONObject();
                                                
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                                mapaVariavel = readExtratoSemParar2(memFile, jDados, mapaVariavel, logger);
                                                break; // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO SEM PARAR"
                                            }
                                        }
                                        
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - BANRISUL
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if(roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Banrisul_TXT") && nomeArquivo.toUpperCase().contains(".TXT") 
                                        && line.contains("B A N R I S U L")){
                                            nomePortador  = StringUtil.removeSpecialCharsToUC(nomeArquivo);
                                            complemento01 = nomePortador;
                                            tipoPlanilha = "EXTRATO-BANRISUL";
                                            JSONObject jDados = new JSONObject();
                                            jDados.put("CODEMPRESA", codEmpresa);
                                            jDados.put("NOMEARQUIVO", nomeArquivo);
                                            readExtratoBANRISULDefault(memFile, nomePortador, jDados, dbIOCont, logger);
                                            putStatus(dirName, "", jStatus, logger);
                                            break;
                                        }


                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - BOTICARIO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Boticario_Excel")) {
                                            if (line.contains("NSU") && line.contains("SITEF") && line.contains("ADQUIRENTE") && !line.contains("PEDIDO")) {

                                                tipoPlanilha = "BOTICARIO";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                                mapaVariavel = readBoticario(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO SEM PARAR"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - STONE
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Stone_Excel")) {
                                            if (line.contains("HORA DA VENDA") && line.contains("BANDEIRA") && line.contains("STONE ID")) {
                                                tipoPlanilha = "CARTAO-STONE";
                                                
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);

                                                mapaVariavel = readExtratoStone(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO STONE"
                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - Cartao_Paypal_Excel
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                       if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Paypal_Excel") && 
                                        nomeArquivo.toUpperCase().contains("PAYPAL") &&
                                        nomeArquivo.toUpperCase().endsWith(".XLSX")) {
                                                if (line.contains("DATA") &&
                                                line.contains("MOEDA") &&
                                                line.contains("STATUS") &&
                                                line.contains("HORA") &&
                                                line.contains("TARIFA")) {
                                                    
                                                    tipoPlanilha = "CARTAO-PAYPAL";
                                                    
                                                    JSONObject jDados = new JSONObject();
                                                    jDados.put("CODEMPRESA", codEmpresa);
                                                    jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                    jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                    jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                    jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                                    
                                                mapaVariavel = readCartaoPayPal(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO STONE"
                                            if (line.contains("DATA") &&
                                            line.contains("PAGAMENTOS") &&
                                            line.contains("RECEBIDOS") &&
                                            line.contains("REEMBOLSADAS") &&
                                            line.contains("TARIFAS")) {
                                                
                                                tipoPlanilha = "CARTAO-PAYPAL";
                                                
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",    tipoPlanilha);

                                                mapaVariavel = readCartaoPayPal2(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO STONE"
                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - ELAVON
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Elavon_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(11).replaceAll("\"","").replace("\"","").replace("'","").equals("NSU") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(23).replaceAll("\"","").contains("ECOM") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(23).replaceAll("\"","").contains("RECORRENTE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(29).replaceAll("\"","").contains("DO BATCH IATA")) {
                                                tipoPlanilha = "CARTAO-ELAVON";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoElavon(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO ELAVON"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - PAGSEGURO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_PagSeguro_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("TRANSACAO_ID") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("CLIENTE_NOME") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").replace("\"","").replace("'","").equals("CLIENTE_EMAIL") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(17).replaceAll("\"","").replace("\"","").replace("'","").equals("CODIGO_USUARIO")) {

                                                tipoPlanilha = "CARTAO-PAGSEGURO";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoPagSeguro(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO PAGSEGURO"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - MOIP
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Moip_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("ID") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(8).replaceAll("\"","").replace("\"","").replace("'","").equals("EVENTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(11).replaceAll("\"","").contains("ID PROPRIO")) {

                                                tipoPlanilha = "CARTAO-MOIP";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoMoip(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO MOIP"
                                            if (line.replaceAll("\"","").replace("\"","").replace("'","").contains("DATA INICIAL") &&
                                                line.replaceAll("\"","").replace("\"","").replace("'","").contains("OUTROS RECEBEDORES") &&
                                                line.replaceAll("\"","").contains("NUMERO DE PARCELAS")) {
                                                
                                                tipoPlanilha = "CARTAO-MOIP";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoMoip2(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO MOIP"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //  LEITURA PADRAO - EXTRATO - BANCO DO BRASIL
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_BB_TXT")) {

                                            // Nome Portador  ->  "BANCO DO BRASIL {AGENCIA} {CONTA}"
                                            if (line.contains("EXTRATO CONTA CORRENTE") && nomeArquivo.toUpperCase().contains(".TXT")) {

                                                tipoPlanilha = "EXTRATO-BB";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                
                                                readExtratoBancoDoBrasilDoc2(memFile, "BANCO DO BRASIL", jDados, dbIOCont, logger);

                                                // readExtratoBancoDoBrasilDoc(memFile, "BANCO DO BRASIL", jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO BANCO DO BRASIL"



                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - GETNET
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_GetNet_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("DETALHAMENTO DAS VENDAS") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(7).replaceAll("\"","").contains("VALOR BRUTO:") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(14).replaceAll("\"","").contains("VALOR DA TAXA:")) {

                                                tipoPlanilha = "CARTAO-GETNET";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoGetNet(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } else if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("COD. ESTABELECIMENTO") &&
                                                    memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("CARTOES") &&
                                                    memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("DATA/HORA")) {

                                                tipoPlanilha = "CARTAO-GETNET";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoGetNet2(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO GETNET"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - SIPAG
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Sipag_Excel")) {
                                            if (line.contains("CODIGO DO CLIENTE") && line.contains("COMPROVANTES") && line.contains("VLR. DESC") && line.contains("PLANO")) {

                                                tipoPlanilha = "CARTAO-SIPAG";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readExtratoSipag(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO SIPAG"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - ITAU
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Itau_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(5).contains("CONTA")) {
                                                nomePortador  = "ITAU " + memFile.getStringFieldRemoveEspCharsUpper(5) +  memFile.getStringFieldRemoveEspCharsUpper(6);
                                                nomePortador2 = "ITAU " + memFile.getStringFieldRemoveEspCharsUpper(5) +  memFile.getStringFieldRemoveEspCharsUpper(6);
                                                complemento01 = nomePortador2;
                                                continue;
                                            }

                                            if (memFile.getStringFieldRemoveEspCharsUpper(1).contains("EXTRATO")) {
                                                anoData = memFile.getStringFieldRemoveEspCharsUpper(6);
                                                if (anoData.contains("/")) anoData = anoData.substring(anoData.lastIndexOf("/")+1).trim();
                                                if (!anoData.equals("") && anoData.contains("-")) anoData = anoData.substring(0, anoData.indexOf("-")).trim();
                                                if (anoData.equals("")) anoData = memFile.getStringFieldRemoveEspCharsUpper(1).substring(memFile.getStringFieldRemoveEspCharsUpper(1).lastIndexOf("/")).trim();
                                                continue;
                                            }

                                            if (memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").replace("\"","").replace("'","").contains("AMENTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("VALOR") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(6).replaceAll("\"","").contains("SALDO")) {
                                                tipoPlanilha = "EXTRATO-ITAU";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoItauDefault(memFile, anoData, "TIPO01", nomePortador2, jDados, dbIOCont, logger);
                                                jStatus = new JSONObject();
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO ITAU"

                                            if (memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").replace("\"","").replace("'","").equals("LANCAMENTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(6).replaceAll("\"","").contains("VALOR") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(7).replaceAll("\"","").contains("SALDO")) {
                                                tipoPlanilha = "EXTRATO-ITAU";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoItauDefault(memFile, anoData, "TIPO02", nomePortador2, jDados, dbIOCont, logger);

                                                jStatus = new JSONObject();
                                                putStatus(dirName, "", jStatus, logger);

                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO ITAU"
                                        }
                                        // ----------------------------------------------------------------------------------------------------------

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - UNICRED
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Unicred_Excel")) {

                                            if (memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").replaceAll(" ","").contains("ID.DOC") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("HISTORICOS") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("LANCAMENTOS") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("SALDO")) {

                                                nomePortador  = "UNICRED";
                                                complemento02 = nomePortador;

                                                tipoPlanilha = "EXTRATO-UNICRED";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoUnicredDefault(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO UNICRED"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - PAGUECOM CSV
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Paguecom_CSV")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("DATA DA TRANSA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("DIGO DO CLIENTE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("COMPROVANTE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("PRODUTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("TIPO DE TRANSA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("PARCELAS")) {

                                                tipoPlanilha = "PAGUECOM-CSV";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readPaguecomCSV(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO ELAVON"
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - TICKET
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Ticket_Excel")) {

                                            if (line.contains("DATA CORTE") && line.contains("DATA TRANSACAO") && line.contains("DESCRICAO LANCAMENTO")
                                                && line.contains("NUMERO DOCTO") && line.contains("NUMERO CARTAO"))  {

                                                tipoPlanilha = "CARTAO-TICKET";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);

                                                if(line.contains("DATA CORTE") && line.contains("DATA TRANSACAO") && line.contains("DESCRICAO LANCAMENTO")
                                                && line.contains("NUMERO DOCTO") && line.contains("NUMERO CARTAO")) {

                                                    for (int i = 0; i < memFile.getFieldsSize(); i++) {
                                                        if (memFile.getStringFieldRemoveEspCharsUpper(i).replace("\"","").replace("'","").equals("")) continue;

                                                        if (memFile.getStringFieldRemoveEspCharsUpper(i).contains("VALOR")) jDados.put("IVALORDOCUMENTO", i);
                                                        if (memFile.getStringFieldRemoveEspCharsUpper(i).contains("DATA TRANSACAO")) jDados.put("IDATAMOVIMENTO", i);
                                                        if (memFile.getStringFieldRemoveEspCharsUpper(i).contains("DESCRICAO LANCAMENTO")) jDados.put("INOMEORIGEM", i);
                                                    }
                                                }

                                                mapaVariavel = readExtratoTicketNovo(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }

                                            if (line.contains("EXTRATO DETALHADO") && line.contains("TICKET ALIMENTACAO")) {

                                                tipoPlanilha = "CARTAO-TICKET";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);

                                                mapaVariavel = readExtratoTicket(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "CARTAO TICKET"
                                        }


                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //  LEITURA PADRAO - EXTRATO - SICREDI
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Sicredi_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).contains("ASSOCIADO:")) {
                                                nomePortador  = "SICREDI";
                                                nomePortador2 = nomePortador;

                                                continue;
                                            }
                                            if(nomePortador2.contains("SICREDI") && memFile.getStringFieldRemoveEspCharsUpper(0).contains("CONTA CORRENTE:")){
                                                nomePortador2 += " "+ memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","");
                                                complemento01 = nomePortador2;

                                                continue;
                                            }

                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("DESCRICAO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("DOCUMENTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("VALOR") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("SALDO") ) {

                                                nomePortador = nomePortador2;

                                                tipoPlanilha = "EXTRATO-SICREDI";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoSicrediDefault(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO SICREDI"
                                        }
                                        // ----------------------------------------------------------------------------------------------------------

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - BRADESCO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Bradesco_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).contains("EXTRATO DE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(0).contains("AGENCIA")) {
                                                nomePortador  = "BRADESCO " +  memFile.getStringFieldRemoveEspCharsUpper(0);
                                                complemento01 = nomePortador;
                                                continue;
                                            }

                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("LANCAMENTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("DCTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("CREDITO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("DEBITO") ) {
                                                tipoPlanilha = "EXTRATO-BRADESCO";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoBradescoDefault(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO BRADESCO"
                                        }
                                        // ----------------------------------------------------------------------------------------------------------
                                        
                                        // ----------------------------------------------------------------------------------------------------------
                                        //                      LEITURA PADRAO EXTRATO REDECARD - XLSX
                                        //---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Redecard_Excel")) {
                                            if ((line.contains("HORA DA VENDA") && line.contains("MODALIDADE") && line.contains("NSU/CV") && line.contains("TIPO DE TERMINAL"))
                                            && (line.replaceAll("\"","").contains("CHARGEBACK") && line.replaceAll("\"","").contains("NACIONALIDADE DO CART") && line.replaceAll("\"","").contains("MODALIDADE"))){
                                                tipoPlanilha = "CARTAO-REDECARD";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("NOMEEMPRESA", nomeEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                nomePortador = "REDECARD";
                                                readCartaoRedecardNovoPadrao(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO REDECARD"
                                            if ((line.contains("HORA DA VENDA") && line.contains("MODALIDADE") && line.contains("NSU/CV") && line.contains("TIPO DE TERMINAL"))
                                            || (line.replaceAll("\"","").contains("PRAZO DE RECEB") && line.replaceAll("\"","").contains("RESUMO DE VENDAS") && line.replaceAll("\"","").contains("MODALIDADE"))){
                                                tipoPlanilha = "CARTAO-REDECARD";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("NOMEEMPRESA", nomeEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                nomePortador = "REDECARD";
                                                readCartaoRedecard(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO REDECARD"
                                        }
                                        // ----------------------------------------------------------------------------------------------------------
                                        
                                        // ----------------------------------------------------------------------------------------------------------
                                        //                      LEITURA PADRAO EXTRATO REDECARD
                                        //---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Redecard_TXT")) {

                                            if (line.replaceAll("\"","").contains("E X T R A T O   P A R A   S I M P L E S ")) {
                                                tipoPlanilha = "CARTAO-REDECARD";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("NOMEEMPRESA", nomeEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                nomePortador = "REDECARD";
                                                readCartaoRedecardDefault(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO REDECARD"
                                        }


                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - CARTAO AMERICAN EXPRESS
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_American_Express_Extrato_Excel")) {
                                            if (line.contains("DATA RECEB") && line.contains("CREDITO") && line.contains("DEBITO") && line.contains("REFERENCIA")) {
                                                tipoPlanilha = "AMERICAN-EXTRATO";
                                                JSONObject jDados = new JSONObject();

                                                String[] head = StringUtil.removeSpecialChars(line).split("\\|");
                                                for (int i = 0; i < head.length; i++) {
                                                    if (head[i].contains("VALOR LIQUIDO")) ivalorDocumento = i;
                                                }
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("IVALORDOCUMENTO",  ivalorDocumento);
                                                mapaVariavel = readCartaoAmericanExtratoDefault(memFile, jDados, mapaVariavel, logger);
                                                break;

                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - CARTAO AMERICAN EXPRESS
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_American_Express_Excel")) {
                                            if (line.contains("DATA RECEB") && line.contains("TRANSACAO") && line.contains("PARCELAS")) {
                                                tipoPlanilha = "AMERICAN-EXPRESS";
                                                JSONObject jDados = new JSONObject();

                                                String[] head = StringUtil.removeSpecialChars(line).split("\\|");
                                                for (int i = 0; i < head.length; i++) {
                                                    if (head[i].contains("VALOR TOTAL")) ivalorDocumento = i;
                                                }

                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("IVALORDOCUMENTO",  ivalorDocumento);
                                                mapaVariavel =  readCartaoAmericanExpressDefault(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - SODEXO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Sodexo_Excel")) {
                                            if (line.contains("PRODUTO:") &&  ((line.contains("ALIMENTA") || line.contains("REFEI") || line.contains("PREMIUM") || line.contains("GIFT")) && line.contains("PASS"))) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoSodexo(memFile, jDados, mapaVariavel, logger);

                                                break;
                                            }
                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - BONUS
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Bonus_Excel")) {
                                            if ((nomeArquivo.toUpperCase().contains("BONUS") && !extensao.contains(".TXT")) && (memFile.getStringFieldRemoveEspCharsUpper(0).contains("DOCTO") && line.contains("CARTAO") && line.contains("CAPTURA"))) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoBonus(memFile, jDados, mapaVariavel, logger);

                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - NUTRICARD
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Nutricard_Excel")) {
                                            if ((extensao.contains(".XLSX") || extensao.contains(".CSV")) && (memFile.getStringFieldRemoveEspCharsUpper(0).contains("DOCTO") && line.contains("CARTAO") && line.contains("CAPTURA"))) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoNutricard(memFile, jDados, mapaVariavel, logger);

                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - GOODCARD
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Goodcard_Excel")) {
                                            if (line.contains("COD. DE VENDA") && line.contains("REDE CAPTURA")&& line.contains("AUTORIZACAO")) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoGoodcard(memFile, jDados, mapaVariavel, logger);

                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - SENFF
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Senff_Excel")) {
                                            if (line.contains("CARTAO") && line.contains("AUTORIZACAO") && line.contains("PARCELAS") && line.contains("CLIENTE")) {
                                                
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoSenff(memFile, jDados, mapaVariavel, logger);
                                                
                                                break;
                                            }
                                            if (line.contains("DATA") && line.contains("HOMOLOGADO")) {
                                                
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoSenffLayout2(memFile, jDados, mapaVariavel, logger);
                                                
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        // LEITURA PADRAO - EXTRATO - VRALIMENTACAO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_VRAlimentacao_TXT")) {
                                            if ((line.length() > 40) && line.substring(34,40).contains("******") && extensao.contains(".TXT")) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo para leitura de Extrato.
                                                mapaVariavel = readExtratoVRAlimentacao(line, memFile, jDados, mapaVariavel, logger);


                                                break;
                                            }
                                        }
                                        // ----------------------------------------------------------------------------------------------------------


                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - SANTANDER
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Santander_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).contains("NOME:") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).contains("AGENCIA:") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).contains("CONTA CORRENTE:")) {
                                                line = StringUtil.removeSpecialCharsToUC(memFile.nextLine());
                                                nomePortador = String.format("%s %s %s",
                                                                            "SANTANDER",
                                                                            memFile.getStringFieldRemoveEspCharsUpper(3), // Agencia.
                                                                            memFile.getStringFieldRemoveEspCharsUpper(5)  // Conta Corrente.
                                                                            );
                                                complemento01 = nomePortador;
                                                continue;
                                            }
                                            if (nomeArquivo.toUpperCase().contains("SANTANDER") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(0).contains("AGENCIA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).contains("CONTA")) {
                                                nomePortador = String.format("%s %s %s",
                                                                            "SANTANDER",
                                                                            memFile.getStringFieldRemoveEspCharsUpper(1), // Agencia.
                                                                            memFile.getStringFieldRemoveEspCharsUpper(3)  // Conta Corrente.
                                                                            );
                                                complemento01 = nomePortador;
                                                continue;
                                            }

                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").replace("\"","").replace("'","").equals("HISTORICO") &&
                                                (memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("DOCTO") || memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("DOCUMENTO")) &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("VALOR") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("SALDO")) {
                                                tipoPlanilha = "EXTRATO-SANTANDER";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoSantanderDefault(memFile, nomePortador, jDados, dbIOCont, logger);
                                                break;
                                            } // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO BRADESCO"
                                        }
                                        // ----------------------------------------------------------------------------------------------------------


                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - ERP - BYSOFT I-BROKER
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("BySoft_i-Broker")) {
                                            if (line.contains("RELATORIO") && line.contains("MOVIMENTACAO") && line.contains("FINANCEIRA") && line.contains("ANALITICO")) {
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readBysoftIBroker(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO ERP - GENESYS MCP002 (Interfoc)
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Interfoc_Genesys_mcp002")) {
                                            if (line.contains("ROTINA") && line.contains("MCP002")) {
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readInterfocGenesysMCP002(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO ERP - PROSYST
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Prosyst")) {
                                            JSONObject jDados = new JSONObject();
                                            jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                            jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                            jDados.put("CODEMPRESA",     codEmpresa);
                                            jDados.put("NOMEARQUIVO",    nomeArquivo);
                                            if (line.contains("PR00428")) {
                                                mapaVariavel = readProsystPR00428(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                            if (line.contains("PRX004815")) {
                                                mapaVariavel = readProsystPRX004815(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }/*~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--*/

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO ERP - SISJURI (BCS Financeiro)
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").toUpperCase().contains("SISJURI_BCS_FINANCEIRO")) {
                                            if (line.contains("BCS") && line.contains("FINANCEIRO")) {
                                                JSONObject jDados = new JSONObject();

                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEEMPRESA", nomeEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readSisjuriBCSFinanceiro(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO ERP - SOFTPHARMA FCPA200 (Linx)
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Linx_Softpharma_fcpa200")) {
                                            if (line.contains("****") && line.contains("INICIO")) {
                                                JSONObject jDados = new JSONObject();

                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEEMPRESA", nomeEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readLinxSoftpharmaFCPA200(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO ERP - SYSTEXTIL
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Systextil")) {
                                            if (line.contains("EMPRESA") && line.contains("SYSTEXTIL")) {
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readSystextil(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }// Fim - Leitura Padrao - SYSTEXTIL
                                        } 
                                        /*~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--*/

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO CARTAO - CIELO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Cielo")) {
                                            if (line.contains("EXTRATO") && line.contains("SIMPLES") && line.contains("CONFERENCIA")) {
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readCartaoCielo(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            } 
                                            if ((roteiroCRM.optString("contabilidade").toUpperCase().equals("CONTASPRO") && // valida??o para contaspro
                                            (line.contains("ESTABELECIMENTO") && 
                                            line.contains("BANDEIRA") && 
                                            line.contains("FORMA DE PAGAMENTO") &&
                                            line.contains("VALOR LIQUIDO")))
                                            || 
                                            (line.contains("BANDEIRA") && 
                                            line.contains("FORMA DE PAGAMENTO") &&
                                            line.contains("DATA DA AUTORIZACAO") &&
                                            line.contains("QUANTIDADE DE PARCELAS") &&
                                            line.contains("VALOR LIQUIDO"))) {

                                            JSONObject jDados = new JSONObject();
                                            jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                            jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                            jDados.put("CODEMPRESA",     codEmpresa);
                                            jDados.put("NOMEARQUIVO",    nomeArquivo);

                                            // Chama metodo do Erp do Cliente da Contabilidade.
                                            mapaVariavel = readCartaoCieloExcel2(memFile, jDados, mapaVariavel, logger);

                                            break;
                                        }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO CARTAO - REDECARD
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Redecard_Excel")) {

                                            if (memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("PRAZO DE RECEB") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("RESUMO DE VENDAS") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(6).replaceAll("\"","").contains("MODALIDADE")) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readCartaoRedecardCred(memFile, jDados, mapaVariavel, logger);

                                                jStatus = new JSONObject();
                                                putStatus(dirName, "", jStatus, logger);

                                                break;
                                            }
                                            if (memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("RESUMO DE VENDAS") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("MODALIDADE") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(6).replaceAll("\"","").contains("BANDEIRA")) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readCartaoRedecardDeb(memFile, jDados, mapaVariavel, logger);

                                                jStatus = new JSONObject();
                                                putStatus(dirName, "", jStatus, logger);

                                                break;
                                            }
                                        }
                                        //LEITURA PADRAO CARTAO - CIELO SEM BANDEIRA
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Cielo_Simples_Sem_Bandeira")) {

                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").replace("\"","").replace("'","").equals("DATA DE VENDA") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").replace("\"","").replace("'","").equals("VALOR BRUTO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("VALOR") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("QUIDO") &&
                                                memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").replace("\"","").replace("'","").equals("TAXA")) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readCartao_Cielo_Simples_Sem_Bandeira(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }


                                            ///////////////////////////////////////////////////////// // #Fabrica(2019-08-06) @Vini
									if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Abrapetite_Excel") && nomeArquivo.toUpperCase().contains("ABRAPETITE")) {

                                        if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("DATA") &&
											memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("QUANTIDADE") &&
											memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("VALOR") &&
											memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("TRANSACOES")) {
                                            
                                            tipoPlanilha = "CARTAOABRAPETITE";

											JSONObject jDados = new JSONObject();
											jDados.put("TIPOLANCAMENTO", tipoLancamento);
											jDados.put("NOMEEMPRESA",    nomeEmpresa);
											jDados.put("CODEMPRESA",     codEmpresa);
											jDados.put("NOMEARQUIVO",    nomeArquivo);
											jDados.put("TIPOPLANILHA",   tipoPlanilha);


											// Chama metodo do Erp do Cliente da Contabilidade.
											mapaVariavel = readCartaoAbrapetite(memFile, jDados, mapaVariavel, logger);
											break;
										}
                                    }
                                    ///////////////////////////////////////////////////////// // #Fabrica(2019-08-08) @Batistella
									if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Masterfarma_Excel") && nomeArquivo.toUpperCase().contains("MASTERFARMA")) {
                                        //DATA EMISS?O	DATA VENCIMENTO	VLR. BRUTO	VLR. DESCTO.	VLR. COMIS.	VLR. LIQ.	TX. ADM.	TAXA ADICIONAL	VLR. LIQ.
                                        if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("DATA") &&
											memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("VENCIMENTO") &&
                                            memFile.getStringFieldRemoveEspCharsUpper(2).replaceAll("\"","").contains("BRUTO") &&
                                            memFile.getStringFieldRemoveEspCharsUpper(3).replaceAll("\"","").contains("DESCTO") &&
											memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("COMIS")) {
                                            
                                            tipoPlanilha = "CARTAOMASTERFARMA";

											JSONObject jDados = new JSONObject();
											jDados.put("TIPOLANCAMENTO", tipoLancamento);
											jDados.put("NOMEEMPRESA",    nomeEmpresa);
											jDados.put("CODEMPRESA",     codEmpresa);
											jDados.put("NOMEARQUIVO",    nomeArquivo);
											jDados.put("TIPOPLANILHA",   tipoPlanilha);


											
											mapaVariavel = readCartaoMasterFarma(memFile, jDados, mapaVariavel, logger);
											break;
										}
									}
                                    ///////////////////////////////////////////////////////// // // #Fabrica(2019-08-07) @Vini
									if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Cabal_Excel") && nomeArquivo.toUpperCase().contains("CABAL")) {

                                        if (memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("DATA") &&
                                            memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("VENDA") &&
											memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("PREVISAO") &&
											memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("PAGAMENTO") &&
											memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("VALOR") &&
											memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("VENDA") &&
											memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("VALOR") &&
											memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("LIQUIDO")) {
                                            
                                            tipoPlanilha = "CARTAOCABAL";

											JSONObject jDados = new JSONObject();
											jDados.put("TIPOLANCAMENTO", tipoLancamento);
											jDados.put("NOMEEMPRESA",    nomeEmpresa);
											jDados.put("CODEMPRESA",     codEmpresa);
											jDados.put("NOMEARQUIVO",    nomeArquivo);
											jDados.put("TIPOPLANILHA",   tipoPlanilha);


											// Chama metodo do Erp do Cliente da Contabilidade.
											mapaVariavel = readCartaoCabal(memFile, jDados, mapaVariavel, logger);
											break;
										}
                                    }
                                    
                                    ///////////////////////////////////////////////////////// // // #Fabrica(2019-08-0) @BATISTELLA
									if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Calcard_Excel") && nomeArquivo.toUpperCase().contains("CALCARD")) {
                                        //DT.TRANSACAO	DT.CREDITO	CARTAO	DESCRIAOO DA TRANSAAOO	VALOR BRUTO	VALOR LIQUIDO
                                        if ((memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("DT") &&
                                            memFile.getStringFieldRemoveEspCharsUpper(0).replaceAll("\"","").contains("TRANSACAO")) &&
											(memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("DT") &&
											memFile.getStringFieldRemoveEspCharsUpper(1).replaceAll("\"","").contains("CREDITO")) &&
											(memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("VALOR") &&
											memFile.getStringFieldRemoveEspCharsUpper(4).replaceAll("\"","").contains("BRUTO")) &&
											(memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("VALOR") &&
											memFile.getStringFieldRemoveEspCharsUpper(5).replaceAll("\"","").contains("LIQUIDO"))) {
                                            
                                            tipoPlanilha = "CARTAOCALCARD";

											JSONObject jDados = new JSONObject();
											jDados.put("TIPOLANCAMENTO", tipoLancamento);
											jDados.put("NOMEEMPRESA",    nomeEmpresa);
											jDados.put("CODEMPRESA",     codEmpresa);
											jDados.put("NOMEARQUIVO",    nomeArquivo);
											jDados.put("TIPOPLANILHA",   tipoPlanilha);


											// Chama metodo do Erp do Cliente da Contabilidade.
											mapaVariavel = readCartaoCalcard(memFile, jDados, mapaVariavel, logger);
											break;
										}
									}

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO ERP - AutoSystem (Linx)
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Linx_AutoSystem")) {

                                            JSONObject jDados = new JSONObject();
                                            jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                            jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                            jDados.put("CODEMPRESA",     codEmpresa);
                                            jDados.put("NOMEARQUIVO",    nomeArquivo);

                                            if (line.startsWith(StringUtil.removeSpecialCharsToUC(roteiroCRM.optString("complemento06")))) {
                                                tipoPlanilha = "Linx_AutoSystem";
                                                continue;
                                            }
                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replace("\"","").replace("'","").equals("")) continue;

                                            jDados.put("TIPOPLANILHA", tipoPlanilha);

                                            if (tipoPlanilha.equals("Linx_AutoSystem")) {
                                                tipoPlanilha = memFile.getStringFieldRemoveEspCharsUpper(0);
                                                continue;
                                            }
                                            if (tipoPlanilha.equals("CONTAS PAGAS")) {
                                                mapaVariavel = readLinx_AutoSystem_ContasPagas(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                            if (tipoPlanilha.equals("RECEBIMENTOS")) {
                                                mapaVariavel = readLinx_AutoSystem_Recebimentos(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                            if (tipoPlanilha.equals("EXTRATO BANCARIO")) {
                                                mapaVariavel = readLinx_AutoSystem_ExtratoBancario(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                            if (tipoPlanilha.equals("MOVIMENTACAO DE CONTAS")) {
                                                mapaVariavel = readLinx_AutoSystem_MovimentacaoContas(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - CEF
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_CEF_TXT")) {
                                            if(nomeArquivo.toUpperCase().contains(".TXT") && line.contains("CONTA")
                                            && line.contains("DATA_MOV")
                                            && line.contains("NR_DOC")
                                            && line.contains("HISTORICO")
                                            && line.contains("VALOR")
                                            && line.contains("DEB_CRED")){

                                                nomePortador  = "CEF "+nomeArquivo;
                                                complemento01 = nomePortador;
                                                tipoPlanilha = "EXTRATO-CEF";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoCEFDefaultNovo(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - CEF EXCEL
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Cef_Excel")) {
                                            if(nomeArquivo.toUpperCase().contains(".XLSX")  && memFile.getStringFieldRemoveEspCharsUpper(0).contains("DATA")
                                            && memFile.getStringFieldRemoveEspCharsUpper(0).contains("MOV")
                                            && memFile.getStringFieldRemoveEspCharsUpper(1).contains("NR")
                                            && memFile.getStringFieldRemoveEspCharsUpper(1).contains("DOC")
                                            && memFile.getStringFieldRemoveEspCharsUpper(2).contains("HISTORICO")
                                            && memFile.getStringFieldRemoveEspCharsUpper(3).contains("VALOR")
                                            && memFile.getStringFieldRemoveEspCharsUpper(4).contains("SALDO")){
                                                nomePortador  = "CEF EXCEL "+nomeArquivo;
                                                complemento01 = nomePortador;
                                                tipoPlanilha = "EXTRATO-CEF-EXCEL";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoCEFExcel(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        }

                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - SICOOB
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Sicoob")) {
                                            if(nomeArquivo.toUpperCase().contains(".XLSX") && memFile.getStringFieldRemoveEspCharsUpper(0).contains("DATA")
                                            && memFile.getStringFieldRemoveEspCharsUpper(1).contains("DOCUMENTO")
                                            && memFile.getStringFieldRemoveEspCharsUpper(2).contains("HISTORICO")
                                            && memFile.getStringFieldRemoveEspCharsUpper(3).contains("VALOR")){


                                                nomePortador  = "SICOOB "+nomeArquivo;
                                                complemento01 = nomePortador;
                                                tipoPlanilha = "EXTRATO-SICOOB";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoSicoobDefaultNovo(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - SAFRA EXCEL
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~--
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Safra_Excel")) {

                                            if(nomeArquivo.toUpperCase().contains(".XLSX") && line.contains("BANCO SAFRA S/A")){

                                                if (line.contains("AGENCIA") && !nomePortador.contains("SAFRA")) nomePortador  = "SAFRA "+ line.replaceAll("\\|","");
                                                complemento01 = nomePortador;
                                                tipoPlanilha = "EXTRATO-SAFRA-EXCEL";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);

                                                if(line.contains("EXTRATO MENSAL:")) jDados.put("ANO", cutString(line,"EXTRATO MENSAL:").replaceAll("\\|","").trim());

                                                readExtratoSafraExcel(memFile, nomePortador, jDados, dbIOCont, logger);
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                        }

                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        // 								LEITURA PADRAO - BIN  									 //
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Bin_Excel")) {
                                            if (line.contains("RESUMO DE VENDAS") &&
                                                line.contains("PRODUTO") &&
                                                line.contains("COMPROVANTES")) {

                                                tipoPlanilha = "CARTAO-BIN";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readCartaoBinExcel(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - BANPARA
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Banpara_Excel")) {
                                            if (nomeArquivo.toUpperCase().contains("BANPARA")) {
                                                nomePortador  = "BANPARA ";
                                                tipoPlanilha = "EXTRATO-BANPARA";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoBanpara(memFile, nomePortador, jDados, dbIOCont, logger);
                                                break;
                                            }
                                            // Fim  -> Captura de Dados quando Tipo Planilha -> "EXTRATO BANPARA"
                                        }
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        // 								LEITURA PADRAO - SAFRA  									 //
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Safra_CSV")) {
                                            if  (line.contains("DATA") &&
                                        line.contains("VENDA") &&
                                        line.contains("VENDAS") &&
                                        line.contains("VALOR") &&
                                        line.contains("BRUTO") &&
                                        line.contains("TAXA") &&
                                        line.contains("QUIDO"))  {

                                                tipoPlanilha = "SAFRA";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readCartaocSafraCsv(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }
                                         // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        // 								LEITURA PADRAO - STELO  									 //
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Stelo_Excel") && nomeArquivo.toUpperCase().contains("STELO")) {
                                            
                                            if  (
                                            line.contains("STATUS") &&
                                            line.contains("DATA") &&
                                            line.contains("HORA") &&
                                            line.contains("DOC") &&
                                            line.contains("PGTO") &&
                                            line.contains("PLANO"))  {
                                             
 
                                                 tipoPlanilha = "STELO";
                                                 JSONObject jDados = new JSONObject();
                                                 jDados.put("CODEMPRESA", codEmpresa);
                                                 jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                 jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                 jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                 jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                 mapaVariavel = readCartaoSteloCsv(memFile, jDados, mapaVariavel, logger);
                                                 break;
                                             }
                                         }
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        //LEITURA PADRAO - EXTRATO - UNIPRIME
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Uniprime_Excel")) {
                                            if (line.contains("EXTRATO") &&
                                                line.contains("CONTA CORRENTE") &&
                                                line.contains("UNIPRIME")) {

                                                tipoPlanilha = "EXTRATO-UNIPRIME";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                readExtratoUniprime(memFile, nomePortador, jDados, dbIOCont, logger);
                                                break;
                                            }
                                        }
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        // 								LEITURA PADRAO - MOOZ  									     //
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Mooz_CSV")) {
                                            if (line.contains("NSU") && line.contains("SITEF") && line.contains("ADQUIRENTE") && line.contains("PEDIDO")) {

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);

                                                // Chama metodo do Erp do Cliente da Contabilidade.
                                                mapaVariavel = readCartaoMoozCsv(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        }

                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        // 								LEITURA PADRAO - SUMUP  									     //
                                        // --~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~-- //
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Sumup_Excel")) {

                                            if (memFile.getStringFieldRemoveEspCharsUpper(0).replace("\"","").replace("'","").equals("E-MAIL") && 
                                                memFile.getStringFieldRemoveEspCharsUpper(1).replace("\"","").replace("'","").equals("DATA") && 
                                                memFile.getStringFieldRemoveEspCharsUpper(2).replace("\"","").replace("'","").equals("ID DA TRANSACAO")) {

                                                tipoPlanilha = "CARTAO-SUMUP";
                                                JSONObject jDados = new JSONObject();
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("CODEMPRESA",     codEmpresa);
                                                jDados.put("NOMEARQUIVO",    nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                mapaVariavel = readCartaoSumup(memFile, jDados, mapaVariavel, logger);
                                                break;
                                            }
                                        } // Fim  -> Captura e dados quando Tipo Planilha -> "CARTAO SUMUP"

                                        // ----------------------------------------------------------------------------------------------------------
                                        //  LEITURA PADRAO - EXTRATO - TRIBANCO
                                        //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                        if (roteiroCRM.optString("Planilhas_Padroes").contains("Extrato_Tribanco_Excel")) {
                                            if (memFile.getStringFieldRemoveEspCharsUpper(4).contains("D/C")) {
                                                tipoPlanilha = "EXTRATO-TRIBANCO";

                                                JSONObject jDados = new JSONObject();
                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);

                                                readExtratoTribancoExcel(memFile, nomePortador, jDados, dbIOCont, logger);
                                                jStatus = new JSONObject();
                                                putStatus(dirName, "", jStatus, logger);
                                                break;
                                            }
                                            jStatus = new JSONObject();
                                            putStatus(dirName, "", jStatus, logger);
                                        }

                                    //---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
                                    //                      LEITURA PADRAO CARTAO COOPER
                                    //---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
                                
                                    if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_Coopercard_Excel")) {
                                        if(line.toUpperCase().contains("FILTROS:") && line.toUpperCase().contains("PERIODO:") && line.toUpperCase().contains("ESTABELECIMENTO:")) {
                                                
                                                tipoPlanilha = "CARTAO-COOPER";
                                                
                                                JSONObject jDados = new JSONObject();

                                                jDados.put("CODEMPRESA", codEmpresa);
                                                jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                                jDados.put("NOMEARQUIVO", nomeArquivo);
                                                jDados.put("TIPOPLANILHA",   tipoPlanilha);
                                                jDados.put("TIPOLANCAMENTO", tipoLancamento);

                                                mapaVariavel = readCartaoCooper(memFile, jDados, mapaVariavel, logger);
                                                break;


                                        }
                                    }

                                    //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                    //  LEITURA PADRAO - CARTAO - IFOOD EXCEL  #BATISTELLA
                                    //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
                                    if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_IFood_Excel")) {
                                        if(line.contains("TOTAL PRATOS")
                                        && line.contains("DATA DO CANCELAMENTO")
                                        && line.contains("ORIGEM DO CANCELAMENTO")) {

                                            tipoPlanilha = "CARTAO IFOOD";
                                            JSONObject jDados = new JSONObject();
                                            jDados.put("CODEMPRESA", codEmpresa);
                                            jDados.put("TIPOLANCAMENTO", tipoLancamento);
                                            jDados.put("NOMEEMPRESA",    nomeEmpresa);
                                            jDados.put("NOMEARQUIVO",    nomeArquivo);
                                            jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                            readExtratoIFood(memFile, jDados, mapaVariavel, logger);
                                            putStatus(dirName, "", jStatus, logger);
                                            break;
                                        }
                                    }

                                    //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
									//LEITURA PADRAO CARTAO - PoliCard
									//--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
									if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_PoliCard_Excel")) {

                                        String padraoCabecalho = "";
                                        if(line.contains("DATA") && 
                                            line.contains("PRODUTO") && 
                                            line.contains("ESTABELECIMENTO") && 
                                            line.contains("CNPJ") && 
                                            line.contains("LANCAMENTO") && 
                                            line.contains("DATA REPASSE") && 
                                            line.contains("USUARIO") && 
                                            line.contains("COD. AUT.") && 
                                            line.contains("TIPO") && 
                                            line.contains("NSU") && 
                                            line.contains("CREDITO") && 
                                            line.contains("DEBITO") && 
                                            line.contains("SALDO")){
                                                padraoCabecalho = "PADRAO-1";
                                            }
                                        if( line.contains("RAZAO SOCIAL") && 
                                            line.contains("DT.MOVIMENTO") && 
                                            line.contains("VL.COMISSAO") && 
                                            line.contains("DT.REPASSE") && 
                                            line.contains("VL.LIQUIDO") &&
                                            line.contains("VL.BRUTO") && 
                                            line.contains("EMPRESA") && 
                                            line.contains("PRODUTO") && 
                                            line.contains("CARTAO") && 
                                            line.contains("NUMERO") && 
                                            line.contains("CNPJ")){
                                                padraoCabecalho = "PADRAO-2";
                                            }
                                        if(!padraoCabecalho.equals("")){
                                            tipoPlanilha = "CARTAO-POLICARD";
                                            JSONObject jDados = new JSONObject();
                                            jDados.put("PADRAOCABECALHO", padraoCabecalho);
                                            jDados.put("TIPOLANCAMENTO",  tipoLancamento);
                                            jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                            jDados.put("NOMEEMPRESA",     nomeEmpresa);
                                            jDados.put("NOMEARQUIVO",     nomeArquivo);
                                            jDados.put("CODEMPRESA",      codEmpresa);
                                            jDados.put("LINE",            line);
											mapaVariavel = readCartaoPoliCard(memFile, jDados, mapaVariavel, logger);
											break;
                                        }
									}

                                    //--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~----~
									//LEITURA PADRAO CARTAO - TrioCard
									//--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--~--
									if (roteiroCRM.optString("Planilhas_Padroes").contains("Cartao_TrioCard_Excel")) {
                                        String padraoCabecalho = "";
                                        // NOMSUBREDE|DATA|AUTORIZ|TRANSACAO|CARTAO|VALOR|VAL_LIQ|DT_FECH|NUM_FECHTO|CREDENCIADO|NOME_CREDENCIADO
                                        if(line.contains("NOMSUBREDE") && 
                                            line.contains("DATA") && 
                                            line.contains("AUTORIZ") && 
                                            line.contains("TRANSACAO") && 
                                            line.contains("CARTAO") && 
                                            line.contains("VALOR") && 
                                            line.contains("VAL_LIQ") && 
                                            line.contains("DT_FECH") && 
                                            line.contains("NUM_FECHTO") && 
                                            line.contains("CREDENCIADO") && 
                                            line.contains("NOME_CREDENCIADO")){
                                                padraoCabecalho = "PADRAO-1";
                                            }
                                        if(!padraoCabecalho.equals("")){
                                            tipoPlanilha = "CARTAO-TRIOCARD";
                                            JSONObject jDados = new JSONObject();
                                            jDados.put("PADRAOCABECALHO", padraoCabecalho);
                                            jDados.put("TIPOLANCAMENTO",  tipoLancamento);
                                            jDados.put("TIPOPLANILHA",    tipoPlanilha);
                                            jDados.put("NOMEEMPRESA",     nomeEmpresa);
                                            jDados.put("NOMEARQUIVO",     nomeArquivo);
                                            jDados.put("CODEMPRESA",      codEmpresa);
                                            jDados.put("LINE",            line);
											mapaVariavel = readCartaoTrioCard(memFile, jDados, mapaVariavel, logger);
											break;
                                         }
									}
                                }

								//---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
								//                      LEITURA PADRAO DE DUPLICATAS
								//---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
								if(roteiroCRM.optString("Integracao_fiscal").toUpperCase().contains("TRUE")){

                                    JSONObject jDados               = new JSONObject();

                                    jDados.put("erpContabilidade",  roteiroCRM.optString("erpContabilidade"));
                                    jDados.put("CODEMPRESA",        codEmpresa);
                                    jDados.put("NOMEARQUIVO",       nomeArquivo);
                                    jDados.put("LINE",              line);
                                    jDados.put("PRIMEIRAVEZ",       primeiraVezDuplicata);   jDados.put("DIRNAME",      		dirName);
                                    jDados.put("TIPOPLANILHA",      tipoPlanilha);
                                    jDados.put("TIPOLANCAMENTO",    tipoLancamento);
                                    
                                    primeiraVezDuplicata = leituraDuplicataPadrao(jDados, memFile, mapaVariavel, dbIOCont, logger);

                                    if(!primeiraVezDuplicata){
                                        jStatus = new JSONObject();
									    putStatus(dirName, "", jStatus, logger);
                                        break;
                                    }
								} 
								// ----------------------------------------------------------------------------------------------------------

								////////////////////////////////////////////////////////////////////////////////
								//////////////////////////////////////////////////////////////// FIM DOS PADROES
								////////////////////////////////////////////////////////////////////////////////
								
								// #DOCUMENTACAO
								// lipeza de variaveis e de indices ao mudar de TIPOPLANILHA
								JSONObject jDadosObj = new JSONObject();
								if(!tipoPlanilha.equals(getTipoPlanilha(line, tipoPlanilha, StringUtil.removeSpecialChars(nomeArquivo), jDadosObj))){
									inomeOrigem			= -1;		nomeOrigem		= "";
									idataMovimento		= -1;		dataMovimento	= "";
									inomePortador		= -1;		nomePortador	= "";
									idocumento			= -1;		documento		= "";
									icpfCnpj			= -1;		cpfCnpj			= "";
									icodCcOrigem		= -1;       codCcOrigem		= "";
									icomplemento01		= -1;      	complemento01	= "";
									icomplemento02		= -1;      	complemento02	= "";
									icomplemento03		= -1;      	complemento03	= "";
									icomplemento04		= -1;      	complemento04	= "";
									icomplemento05		= -1;      	complemento05	= "";
									icomplemento06		= -1;      	complemento06	= "";
									ivalorDocumento		= -1;		complemento07	= "";
									ivalorAlternativo	= -1;		complemento08	= "";
									ivalorJuros			= -1;		complemento09	= "";
									ivalorDesconto		= -1;		complemento10	= "";
									ivalorMulta			= -1;
									ivalorPagamento		= -1;
									idataFake			= -1;
								}
								// #DOCUMENTACAO
								// busca tipoplanilha e indices da planilhas secundarias
								tipoPlanilha = getTipoPlanilha(line, tipoPlanilha, StringUtil.removeSpecialChars(nomeArquivo), jDadosObj);
								if(!tipoPlanilha.equals("MOVIMENTO")){
									roteiroCRM = buscaRoteiro("getRoteiro"+tipoPlanilha, logger);
									inomeOrigem     = getIndice("nomeOrigem", inomeOrigem, roteiroCRM);
									idataMovimento  = getIndice("dataMovimento", idataMovimento, roteiroCRM);
									inomePortador   = getIndice("nomePortador", inomePortador, roteiroCRM);
									idocumento      = getIndice("documento", idocumento, roteiroCRM);
									ivalorDocumento = getIndice("valorDocumento", ivalorDocumento, roteiroCRM);
									ivalorJuros     = getIndice("valorJuros", ivalorJuros, roteiroCRM);
									ivalorDesconto  = getIndice("valorDesconto", ivalorDesconto, roteiroCRM);
									ivalorMulta     = getIndice("valorMulta", ivalorMulta, roteiroCRM);
									icodCcOrigem    = getIndice("codCcOrigem", icodCcOrigem, roteiroCRM);
									ivalorPagamento = getIndice("valorPagamento", ivalorPagamento, roteiroCRM);
									ivalorAlternativo = getIndice("valorAlternativo", ivalorAlternativo, roteiroCRM);
									icomplemento01  = getIndice("complemento01", icomplemento01, roteiroCRM);
									icomplemento02	= getIndice("complemento02", icomplemento02, roteiroCRM);
									icomplemento03  = getIndice("complemento03", icomplemento03, roteiroCRM);
									icomplemento04  = getIndice("complemento04", icomplemento04, roteiroCRM);
									icomplemento05  = getIndice("complemento05", icomplemento05, roteiroCRM);
									icomplemento06  = getIndice("complemento06", icomplemento06, roteiroCRM);
									icomplemento07  = getIndice("complemento07", icomplemento07, roteiroCRM);
									icomplemento08  = getIndice("complemento08", icomplemento08, roteiroCRM);
									icomplemento09  = getIndice("complemento09", icomplemento09, roteiroCRM);
									icomplemento10  = getIndice("complemento10", icomplemento10, roteiroCRM);
									idataFake		= getIndice("dataFake", idataFake, roteiroCRM);
									icpfCnpj		= getIndice("cpfCnpj", icpfCnpj, roteiroCRM);
									
									zerar			= !Boolean.parseBoolean(roteiroCRM.optString("naoZerarValores").toLowerCase().trim());
                                    
                                    // Em casos onde a planilha secund?ria precisa de uma aba espec?fica descomentar essa linha
                                    // if(!roteiroCRM.optString("Abas_Especificas").contains(String.valueOf(porAba))) continue;

								}


								// #DOCUMENTACAO
								// tratamento de "Agrupar Colunas Excel" e "Agrupar a partir da coluna"
								 
                                try {
                                    fazerShrinkDelimitandoPosicoes(roteiroCRM, memFile);
                                } catch (IllegalArgumentException e) {
                                    //TODO: handle exception
                                    erroShrink = true;
                                    logger.logError("Deu ruim no shrink \n"+e);
                                    break;
                                }
								/////////////////////////////
								// VALIDACAO POR CABECALHO //
								/////////////////////////////

								inomeOrigem		= getIndiceCabecalho("nomeOrigem", inomeOrigem, memFile, roteiroCRM);
								idataMovimento	= getIndiceCabecalho("dataMovimento", idataMovimento, memFile, roteiroCRM);
								inomePortador	= getIndiceCabecalho("nomePortador", inomePortador, memFile, roteiroCRM);
								idocumento		= getIndiceCabecalho("documento", idocumento, memFile, roteiroCRM);
								ivalorDocumento	= getIndiceCabecalho("valorDocumento", ivalorDocumento, memFile, roteiroCRM);
								ivalorJuros		= getIndiceCabecalho("valorJuros", ivalorJuros, memFile, roteiroCRM);
								ivalorDesconto	= getIndiceCabecalho("valorDesconto", ivalorDesconto, memFile, roteiroCRM);
								ivalorMulta		= getIndiceCabecalho("valorMulta", ivalorMulta, memFile, roteiroCRM);
								ivalorAlternativo = getIndiceCabecalho("valorAlternativo", ivalorAlternativo, memFile, roteiroCRM);
								ivalorPagamento	= getIndiceCabecalho("valorPagamento", ivalorPagamento, memFile, roteiroCRM);
								icodCcOrigem	= getIndiceCabecalho("codCcOrigem", icodCcOrigem, memFile, roteiroCRM);
								
								icomplemento01	= getIndiceCabecalho("complemento01", icomplemento01, memFile, roteiroCRM);
								icomplemento02	= getIndiceCabecalho("complemento02", icomplemento02, memFile, roteiroCRM);
								icomplemento03	= getIndiceCabecalho("complemento03", icomplemento03, memFile, roteiroCRM);
								icomplemento04	= getIndiceCabecalho("complemento04", icomplemento04, memFile, roteiroCRM);
								icomplemento05	= getIndiceCabecalho("complemento05", icomplemento05, memFile, roteiroCRM);
								icomplemento06	= getIndiceCabecalho("complemento06", icomplemento06, memFile, roteiroCRM);
								icomplemento07	= getIndiceCabecalho("complemento07", icomplemento07, memFile, roteiroCRM);
								icomplemento08	= getIndiceCabecalho("complemento08", icomplemento08, memFile, roteiroCRM);
								icomplemento09	= getIndiceCabecalho("complemento09", icomplemento09, memFile, roteiroCRM);
								icomplemento10	= getIndiceCabecalho("complemento10", icomplemento10, memFile, roteiroCRM);
								idataFake		= getIndiceCabecalho("dataFake", idataFake, memFile, roteiroCRM);
								icpfCnpj		= getIndiceCabecalho("cpfCnpj", icpfCnpj, memFile, roteiroCRM);
								
								isLinhaPrincipal = false;
								ignorarAntes = false;

								JSONObject histobj = new JSONObject();
								lerAposPrincipal = roteiroCRM.optString("lerAposPrincipal").toUpperCase();

								// #DOCUMENTACAO
								// ignorar antes
								if (!roteiroCRM.optString("tipoArquivo").toUpperCase().contains("ARQUIVO TEXTO")) {

									histobj.put("nomeOrigem", getCampoString(nomeOrigem, inomeOrigem, line, zerar, roteiroCRM.optString("fornecedor").toUpperCase(), memFile, logger));
									histobj.put("documento", getCampoString(documento, idocumento, line, zerar, roteiroCRM.optString("documentoNF").toUpperCase(), memFile, logger));
									histobj.put("complemento01", getCampoString(complemento01,	icomplemento01, line, zerar, roteiroCRM.optString("complemento01").toUpperCase(), memFile, logger));
									histobj.put("complemento02", getCampoString(complemento02,	icomplemento02, line, zerar, roteiroCRM.optString("complemento02").toUpperCase(), memFile, logger));
									histobj.put("complemento03", getCampoString(complemento03,	icomplemento03, line, zerar, roteiroCRM.optString("complemento03").toUpperCase(), memFile, logger));
									histobj.put("complemento04", getCampoString(complemento04,	icomplemento04, line, zerar, roteiroCRM.optString("complemento04").toUpperCase(), memFile, logger));
									histobj.put("complemento05", getCampoString(complemento05,	icomplemento05, line, zerar, roteiroCRM.optString("complemento05").toUpperCase(), memFile, logger));
									histobj.put("complemento06", getCampoString(complemento06,	icomplemento06, line, zerar, roteiroCRM.optString("complemento06").toUpperCase(), memFile, logger));
									histobj.put("nomePortador", getCampoString(nomePortador,	inomePortador, line, zerar, roteiroCRM.optString("portador").toUpperCase(), memFile, logger));
									histobj.put("dataMovimento", "");
									histobj.put("mesAnoAnterior", "");
									histobj.put("mesAno2Anterior", "");
									histobj.put("mesAnoAtual", "");
									histobj.put("contaMovimento", "");
									histobj.put("contaPortador", "");
									histobj.put("contaDebito", "");
									histobj.put("contaCredito", "");
									histobj.put("contaJuros", contaJuros);
									histobj.put("contaDesconto", contaDesconto);
									histobj.put("contaMulta", contaMulta);
									histobj.put("valorDocumento", "");
									histobj.put("valorJuros", "");
									histobj.put("valorDesconto", "");
									histobj.put("valorMulta","");
									histobj.put("codFilial", "");
									histobj.put("numeroAba", String.valueOf(porAba));
									histobj.put("tipoPlanilha", tipoPlanilha);
									histobj.put("nomeArquivo", nomeArquivo.toUpperCase());

									ignorarAntes = getTratarLinhaIgnorar(line.replaceAll("\\|","").replaceAll(";","").replaceAll(",","").trim(), tipoLancamento,
																		 getCampoString(documento, idocumento, line, zerar, roteiroCRM.optString("documentoNF").toUpperCase(), memFile, logger),
																		 getCampoString(nomeOrigem, inomeOrigem, line, zerar, roteiroCRM.optString("fornecedor").toUpperCase(), memFile, logger), histobj);

									if (ignorarAntes) continue;

									double valorValido = 0;
									try{valorValido = Math.abs(memFile.getDoubleField(ivalorDocumento));}
									catch (Exception vlrd) { valorValido = 0; }

									if(ivalorDocumento < 0 && ivalorPagamento >= 0){
										try{valorValido = Math.abs(memFile.getDoubleField(ivalorPagamento));}
										catch (Exception vlrd) { valorValido = 0; }
									}


									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("VALOR DOCUMENTO") &&  valorValido > 0) isLinhaPrincipal = true;
									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("FORNECEDOR-CLIENTE") && !histobj.optString("nomeOrigem").equals("")) isLinhaPrincipal = true;

								}

								if (naoLeMais) continue;
								if (tipoPlanilha.equals("")) continue;


								// #DOCUMENTACAO
								// leitura de xlsx e csv
								if (!roteiroCRM.optString("tipoArquivo").toUpperCase().contains("ARQUIVO TEXTO") || (!roteiroCRM.optString("dataMovimento").toUpperCase().startsWith("COLUNA(") && !roteiroCRM.optString("dataMovimento").toUpperCase().startsWith("COLUNA ("))) {
									zerar 			  = !Boolean.parseBoolean(roteiroCRM.optString("naoZerarValores").toLowerCase().trim());

                                    // #Fabrica(2019-05-20)
                                    try{
                                        dataMovimento     = getDate(dataMovimento, idataMovimento, line, false, roteiroCRM.optString("dataMovimento").toUpperCase(), memFile, logger);
                                        dataLote		  = getCampoDate(dataMovimento, "", "yyyy-MM");
                                    }catch(Exception e){
                                        // dataMovimento   = "";
                                        // dataLote        = "";
                                    }
                                   
                                    // leitura de data mantida por seguranca
									// String dataString = getCampoString(dataMovimento, idataMovimento, line, false, roteiroCRM.optString("dataMovimento").toUpperCase(), memFile, logger);
									// if (!dataString.equals("")) {
									// 	String dataMovimentoAux	  = getCampoDate(dataString);
									// 	if (dataMovimentoAux.contains("/")) {
									// 		dataMovimento     = getCampoDate(dataString);
									// 		dataLote		  = getCampoDate(dataMovimento, "", "yyyy-MM");
											
									// 	}
									// }

									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("DATA MOVIMENTO") && !dataMovimento.equals("")) isLinhaPrincipal = true;
									
									nomePortador	= getCampoString(nomePortador, inomePortador, line, zerar, roteiroCRM.optString("portador").toUpperCase(), memFile, logger);
									nomeOrigem		= getCampoString(nomeOrigem, inomeOrigem, line, zerar, roteiroCRM.optString("fornecedor").toUpperCase(), memFile, logger);
									documento		= getCampoString(documento, idocumento, line, zerar, roteiroCRM.optString("documentoNF").toUpperCase(), memFile, logger);

									complemento01	= getCampoString(complemento01,	icomplemento01, line, zerar, roteiroCRM.optString("complemento01").toUpperCase(), memFile, logger);
									complemento02	= getCampoString(complemento02,	icomplemento02, line, zerar, roteiroCRM.optString("complemento02").toUpperCase(), memFile, logger);
									complemento03	= getCampoString(complemento03,	icomplemento03, line, zerar, roteiroCRM.optString("complemento03").toUpperCase(), memFile, logger);
									complemento04	= getCampoString(complemento04,	icomplemento04, line, zerar, roteiroCRM.optString("complemento04").toUpperCase(), memFile, logger);
									complemento05	= getCampoString(complemento05,	icomplemento05, line, zerar, roteiroCRM.optString("complemento05").toUpperCase(), memFile, logger);

									complemento06	= getCampoString(complemento06,	icomplemento06, line, zerar, roteiroCRM.optString("complemento06").toUpperCase(), memFile, logger);
									complemento07	= getCampoString(complemento07,	icomplemento07, line, zerar, roteiroCRM.optString("complemento07").toUpperCase(), memFile, logger);
									complemento08	= getCampoString(complemento08,	icomplemento08, line, zerar, roteiroCRM.optString("complemento08").toUpperCase(), memFile, logger);
									complemento09	= getCampoString(complemento09,	icomplemento09, line, zerar, roteiroCRM.optString("complemento09").toUpperCase(), memFile, logger);
									complemento10	= getCampoString(complemento10,	icomplemento10, line, zerar, roteiroCRM.optString("complemento10").toUpperCase(), memFile, logger);
									cpfCnpj			= getCampoString(cpfCnpj,		icpfCnpj, 		line, zerar, roteiroCRM.optString("cpfCnpj").toUpperCase(), memFile, logger);
									codCcOrigem		= getCampoString(codCcOrigem,	icodCcOrigem, line, false, roteiroCRM.optString("centroCusto").toUpperCase(), memFile, logger);

									historico		= "";
									parcelaDoc      = 1;

									valorDocumento	= 0;
									valorJuros		= 0;
									valorDesconto	= 0;
									valorMulta		= 0;
									valorPagamento	= 0;
									
									debitoCredito 	= "";
									valorAlternativo = 0;
									
									if(ivalorJuros >=0){
										try{valorJuros = Math.abs(memFile.getDoubleField(ivalorJuros));}
										catch (Exception vlrj) { valorJuros = 0;}
									}
									if(ivalorDesconto >=0){
										try{valorDesconto = Math.abs(memFile.getDoubleField(ivalorDesconto));}
										catch(Exception vlrd) {valorDesconto = 0;}
									}
									if(ivalorMulta >=0){
										try{valorMulta = Math.abs(memFile.getDoubleField(ivalorMulta));}
										catch(Exception vlrm) {valorMulta = 0;}
									}
									
									//---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
									if(ivalorDocumento >=0){
										try{valorDocumento = memFile.getDoubleField(ivalorDocumento);}
										catch (Exception vlrd) { valorDocumento = 0; }
									}
									
									if(ivalorPagamento >=0){
										try{valorPagamento	= memFile.getDoubleField(ivalorPagamento);}
										catch(Exception vlrp) {valorPagamento = 0;}
									}
									
									if(ivalorAlternativo >= 0){
										try{valorAlternativo = memFile.getDoubleField(ivalorAlternativo);}
										catch (Exception vlrd) { valorAlternativo = 0; }
									}
                                    
                                    if (tipoLancamento.equals("PAGAR")) 
                                        if (ivalorAlternativo != -1) 			debitoCredito = "EXTRATO-DEBITO";
                                    
                                    if (tipoLancamento.equals("RECEBER")) 
                                        if (ivalorAlternativo != -1) 			debitoCredito = "EXTRATO-CREDITO";
                                

                                    // fazer regra quando tiver valor documento e alternativo na mesma coluna
									String tratarComoValorAlternativo = getTratarValorAlternativo(histobj);
									if (!tratarComoValorAlternativo.equals("")) {											
										if (tipoLancamento.equals("PAGAR")) 	debitoCredito = "EXTRATO-CREDITO";
										if (tipoLancamento.equals("RECEBER")) 	debitoCredito = "EXTRATO-DEBITO";
                                        if(ivalorAlternativo >= 0) valorDocumento = valorAlternativo;
									}else{// n?o fazer regra quando for valor documento e alternativo em colunas diferentes	
										if(valorDocumento == 0 && ivalorAlternativo >= 0){		
											if (tipoLancamento.equals("PAGAR")) 	debitoCredito = "EXTRATO-CREDITO";
											if (tipoLancamento.equals("RECEBER")) 	debitoCredito = "EXTRATO-DEBITO";
											valorDocumento = valorAlternativo;
										}
									}

									//---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
									if(ivalorDocumento < 0 && valorDocumento == 0){
										if		(valorPagamento > 0) valorDocumento = valorPagamento + valorDesconto - valorJuros - valorMulta;
										else if	(valorPagamento < 0) valorDocumento = valorPagamento - valorDesconto + valorJuros + valorMulta;
									}
									if(valorDocumento>0 && ivalorJuros < 0 && ivalorDesconto < 0 && valorPagamento > 0){
										if(valorPagamento > valorDocumento) valorJuros = DecimalUtil.toDecimal(String.format("%.2f", valorPagamento - valorDocumento));
										if(valorPagamento < valorDocumento) valorDesconto = DecimalUtil.toDecimal(String.format("%.2f", valorDocumento - valorPagamento));
									}

									valorDocumento = Math.abs(valorDocumento);
									
									// ---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---
									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("VALOR DOCUMENTO") &&  valorDocumento > 0) isLinhaPrincipal = true;
									
									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("VALOR DOCUMENTO") &&
										lerAposPrincipal.equals("") && valorDocumento == 0) {
										continue;
									}

								}


								// #DOCUMENTACAO
								// leitura de TXT
								if (roteiroCRM.optString("tipoArquivo").toUpperCase().contains("ARQUIVO TEXTO") && roteiroCRM.optString("dataMovimento").toUpperCase().startsWith("COLUNA(") && roteiroCRM.optString("dataMovimento").endsWith(")")) {

                                    if (!tipoPlanilha.equals("MOVIMENTO")) {
                                        String dataString = getCampoString(dataMovimento, idataMovimento, line, false, roteiroCRM.optString("dataMovimento").toUpperCase(), memFile, roteiroCRM, logger).trim();
                                        if (!dataString.equals("") && dataString.contains("/")) {
                                            String dataMovimentoAux	  = getCampoDate(dataString);
                                            if (dataMovimentoAux.contains("/")) {
                                                dataMovimento     = getCampoDate(dataString);
                                                dataLote		  = getCampoDate(dataMovimento, "", "yyyy-MM");
                                                // continue;
                                            }
                                        }
                                    }
                                    

                                    // logger.logDebug("BTL -> 2414|  -> " + dataMovimento  + "|  -> " + dataString  );


									complemento01 = getStringTXT(roteiroCRM.optString("complemento01").toUpperCase(), line, objetoParametro);
									complemento02 = getStringTXT(roteiroCRM.optString("complemento02").toUpperCase(), line, objetoParametro);
									complemento03 = getStringTXT(roteiroCRM.optString("complemento03").toUpperCase(), line, objetoParametro);
									if(tipoPlanilha.equals("MOVIMENTO")) {
                                        if(line.startsWith("*") && line.contains(" - ")) {
                                            complemento04 = line;
                                            continue;
                                        }
                                    
                                        if (line.trim().matches("[0-9]{8}\\s.*")) {
                                            String dataTeste = cutString(line, 0,8);
                                            Date dt = DateUtil.stringToDate(dataTeste, "ddMMyyyy");
                                            dataMovimento = DateUtil.dateToString(dt, "dd/MM/yyyy");
                                            dataLote	  = getCampoDate(dataMovimento, "", "yyyy-MM");
                                        } else { continue;}

                                        String dataNomeArquivo = cutString(nomeArquivo, 0, 8).replaceAll("[^0-9]", "");
                                        String dataAux = getCampoDate(dataNomeArquivo);
                                        logger.logDebug("BTL -> 2420|  -> " + dataMovimento + " |  -> " + dataAux);
                                        Calendar cal = Calendar.getInstance();
                                        cal.setTime(DateUtil.stringToDate(dataMovimento, "dd/MM/yyyy"));
                                        int mesLancamento = cal.get(Calendar.MONTH);
                                        int anoLancamento = cal.get(Calendar.YEAR);
                                        cal.setTime(DateUtil.stringToDate(dataAux, "dd/MM/yyyy"));
                                        int mesNomeArquivo = cal.get(Calendar.MONTH);
                                        int anoNomeArquivo = cal.get(Calendar.YEAR);
                                        if (mesLancamento == mesNomeArquivo && anoLancamento == anoNomeArquivo)
                                            logger.logDebug("BTL -> 2431|  -> ESTAMOS PROCESSANDO O MESMO MES!!!!" + dataNomeArquivo + " |  -> " + dataMovimento );
                                        if (mesLancamento != mesNomeArquivo || anoLancamento != anoNomeArquivo) {
                                            logger.logDebug("BTL -> 2431|  -> NAO ESTAMOS PROCESSANDO O MESMO MES!!!!" + dataNomeArquivo + " |  -> " + dataMovimento );
                                            dataMovimento = dataAux;
                                            dataLote = getCampoDate(dataMovimento, "", "yyyy-MM");
                                            logger.logDebug("BTL -> 2460| NOVA DATA MOVIMENTO -> " + dataMovimento );
                                        }
                                    }else{
                                        complemento04 = getStringTXT(roteiroCRM.optString("complemento04").toUpperCase(), line, objetoParametro);
                                    }
                                    complemento05 = getStringTXT(roteiroCRM.optString("complemento05").toUpperCase(), line, objetoParametro);
									complemento06 = getStringTXT(roteiroCRM.optString("complemento06").toUpperCase(), line, objetoParametro);
									complemento07 = getStringTXT(roteiroCRM.optString("complemento07").toUpperCase(), line, objetoParametro);
									complemento08 = getStringTXT(roteiroCRM.optString("complemento08").toUpperCase(), line, objetoParametro);
									complemento09 = getStringTXT(roteiroCRM.optString("complemento09").toUpperCase(), line, objetoParametro);
									complemento10 = getStringTXT(roteiroCRM.optString("complemento10").toUpperCase(), line, objetoParametro);
									cpfCnpj		  = getStringTXT(roteiroCRM.optString("cpfCnpj").toUpperCase(), line, objetoParametro);

									nomePortador  = getStringTXT(roteiroCRM.optString("portador").toUpperCase(), line, objetoParametro);
									documento     = getStringTXT(roteiroCRM.optString("documentoNF").toUpperCase(), line, objetoParametro);
									codCcOrigem   = getStringTXT(roteiroCRM.optString("centroCusto").toUpperCase(), line, objetoParametro);
									nomeOrigem    = getStringTXT(roteiroCRM.optString("fornecedor").toUpperCase(), line, objetoParametro);


									valorDocumento = getDoubleTXT(roteiroCRM.optString("valorDocumento").toUpperCase(), line, objetoParametro);
									valorJuros	   = getDoubleTXT(roteiroCRM.optString("valorJuros").toUpperCase(), line, objetoParametro);
									valorDesconto  = getDoubleTXT(roteiroCRM.optString("valorDesconto").toUpperCase(), line, objetoParametro);
									valorMulta 	   = getDoubleTXT(roteiroCRM.optString("valorMulta").toUpperCase(), line, objetoParametro);
									valorPagamento = getDoubleTXT(roteiroCRM.optString("valorPagamento").toUpperCase(), line, objetoParametro);

                                    if (tipoLancamento.equals("PAGAR")) 
                                        if(roteiroCRM.optString("valorAlternativo").toUpperCase().contains("COLUNA"))
                                            debitoCredito = "EXTRATO-DEBITO";
                                    
                                    if (tipoLancamento.equals("RECEBER")) 
                                        if(roteiroCRM.optString("valorAlternativo").toUpperCase().contains("COLUNA"))
                                            debitoCredito = "EXTRATO-CREDITO";

                                    // fazer regra quando tiver valor documento e alternativo na mesma coluna
                                    String tratarComoValorAlternativo = getTratarValorAlternativo(histobj);
                                    if (!tratarComoValorAlternativo.equals("")) {											
                                        if (tipoLancamento.equals("PAGAR")) 	debitoCredito = "EXTRATO-CREDITO";
                                        if (tipoLancamento.equals("RECEBER")) 	debitoCredito = "EXTRATO-DEBITO";
                                        if(roteiroCRM.optString("valorAlternativo").toUpperCase().contains("COLUNA")) valorDocumento = valorAlternativo;
                                    }else{// n?o fazer regra quando for valor documento e alternativo em colunas diferentes	
                                        if(valorDocumento == 0 && roteiroCRM.optString("valorAlternativo").toUpperCase().contains("COLUNA")){		
                                            if (tipoLancamento.equals("PAGAR")) 	debitoCredito = "EXTRATO-CREDITO";
                                            if (tipoLancamento.equals("RECEBER")) 	debitoCredito = "EXTRATO-DEBITO";
                                            valorDocumento = valorAlternativo;
                                        }
                                    }

                                    if(!roteiroCRM.optString("valorDocumento").toUpperCase().contains("COLUNA") && valorDocumento == 0){
										if		(valorPagamento > 0) valorDocumento = valorPagamento + valorDesconto - valorJuros - valorMulta;
										else if	(valorPagamento < 0) valorDocumento = valorPagamento - valorDesconto + valorJuros + valorMulta;
									}
									if(valorDocumento > 0 && !roteiroCRM.optString("valorJuros").toUpperCase().contains("COLUNA") && !roteiroCRM.optString("valorDesconto").toUpperCase().contains("COLUNA") && valorPagamento > 0){
										if(valorPagamento > valorDocumento) valorJuros = DecimalUtil.toDecimal(String.format("%.2f", valorPagamento - valorDocumento));
										if(valorPagamento < valorDocumento) valorDesconto = DecimalUtil.toDecimal(String.format("%.2f", valorDocumento - valorPagamento));
									}

									valorDocumento = Math.abs(valorDocumento);

                                    logger.logDebug("BTL -> 2493|  -> " + dataMovimento + " |  -> " + valorDocumento + " |  -> " + complemento04 + " |  -> " + complemento01 + " |  -> \n" + line );

									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("DATA MOVIMENTO") && !dataMovimento.equals(""))  isLinhaPrincipal = true;;
									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("VALOR DOCUMENTO") && valorDocumento > 0)		  isLinhaPrincipal = true;
									if (roteiroCRM.optString("campoLinhaPrincipal").toUpperCase().equals("FORNECEDOR-CLIENTE") && !nomeOrigem.equals("")) isLinhaPrincipal = true;
								}


								// #DOCUMENTACAO
								// mes ano anterior 
								if(dataMovimento.length() > 9){
									mesRef	= Integer.parseInt(dataMovimento.substring(3,5));
									anoRef	= Integer.parseInt(dataMovimento.substring(6,10));
									mesAnoAtual = StringUtil.leftPad(String.valueOf(mesRef),2,"0") + "/" + String.valueOf(anoRef);

									mesRef	= mesRef - 1;
									if (mesRef	== 0) {
										mesRef	= 12;
										anoRef	= anoRef - 1;
									}
									mesAnoAnterior = StringUtil.leftPad(String.valueOf(mesRef),2,"0") + "/" + String.valueOf(anoRef);
									mesRef	= mesRef - 1;
									if (mesRef	== 0) {
										mesRef	= 12;
										anoRef	= anoRef - 1;
									}
									mesAno2Anterior = StringUtil.leftPad(String.valueOf(mesRef),2,"0") + "/" + String.valueOf(anoRef);
								}
								//---~---~---~---~---~---~-


								//##########################################################

								// #DOCUMENTACAO
								// filtro de datas (parametro definido por integracao no CRM, e informado a cada processamento de arquivos)
								if (nomeArquivo.toUpperCase().contains("FILTRO_")) filtro = validaFiltro(nomeArquivo, dataMovimento);
								if (!filtro) continue;

								valorTotalDoc   += valorDocumento;
								valorTotalJuros += valorJuros;
								valorTotalDesc  += valorDesconto;

								if (documento.contains(".") && documento.contains("E")) {
									documento = removerNotacaoCientificaExcel(documento);
								}
								
								// #DOCUMENTACAO
								// cpfCnpj
								boolean aceitaCpf = true;

								if(!cpfCnpj.equals("")){
									if(Boolean.parseBoolean(roteiroCRM.optString("cnpjSomenteNumeros").toLowerCase().trim())){
										if(!aceitaCpf)	cpfCnpj = trataCpfCnpj(cpfCnpj, true, false);
										else			cpfCnpj = trataCpfCnpj(cpfCnpj);
									}
									if(!Boolean.parseBoolean(roteiroCRM.optString("cnpjSomenteNumeros").toLowerCase().trim())){
										if(!aceitaCpf)	cpfCnpj = trataCpfCnpj(cpfCnpj, false, false);
										else			cpfCnpj = trataCpfCnpj(cpfCnpj, false, true);
									}
								}

								// #DOCUMENTACAO
								// ajustes fornecedor/cliente e portador
								if (nomeOrigem.equals("") && !roteiroCRM.optString("lerAposPrincipal").toUpperCase().contains("FORNECEDOR")) nomeOrigem = complemento01 + " " + dataMovimento + " R$" + String.valueOf(valorDocumento);
								nomeOrigem = nomeOrigem.trim();
								nomeOrigem = nomeOrigem.replaceAll("EAMP;","&").replaceAll("\t"," ").replaceAll(";","").replace("'","").replace("!","").trim();
								nomeOrigem = stringNormalizer(nomeOrigem, true);
								
								if (roteiroCRM.optString("portador").toUpperCase().contains("NOME") && roteiroCRM.optString("portador").toUpperCase().contains("ARQUIVO")) nomePortador = StringUtil.removeSpecialCharsToUC(nomeArquivo).toUpperCase();
								nomePortador = nomePortador.replaceAll("EAMP;","&").replaceAll("\t"," ").replaceAll(";","").replace("'","").replace("!","").trim();
								nomePortador = stringNormalizer(nomePortador, true);
								
								if(dataMovimento.equals("")) continue;
								// quando for ler linha principal zerar as variaveis que vem depois da principal para nao sobrepor campos.
								if(isLinhaPrincipal) {
									// #DOCUMENTACAO
									// cont define que eh um novo lancamento (normalmente uma nova linha)
									cont++;

									if (lerAposPrincipal.contains("FORNECEDOR"))	nomeOrigem = "";
									if (lerAposPrincipal.contains("DOCUMENTO"))		documento = "";
									if (lerAposPrincipal.contains("PORTADOR")) 		nomePortador = "";
									if (lerAposPrincipal.contains("COMPLEMENTO01")) complemento01 = "";
									if (lerAposPrincipal.contains("COMPLEMENTO02")) complemento02 = "";
									if (lerAposPrincipal.contains("COMPLEMENTO03")) complemento03 = "";
									if (lerAposPrincipal.contains("COMPLEMENTO04")) complemento04 = "";
									if (lerAposPrincipal.contains("COMPLEMENTO05")) complemento05 = "";
									if (lerAposPrincipal.contains("COMPLEMENTO06")) complemento06 = "";

								}
								if(cont == 0) continue;

								histobj.put("nomeOrigem", nomeOrigem);					histobj.put("documento", documento);
								histobj.put("complemento01", complemento01);			histobj.put("complemento02", complemento02);
								histobj.put("complemento03", complemento03);			histobj.put("complemento04", complemento04);
								histobj.put("complemento05", complemento05);			histobj.put("complemento06", complemento06);
								histobj.put("complemento07", complemento07);			histobj.put("complemento08", complemento08);
								histobj.put("complemento09", complemento09);			histobj.put("complemento10", complemento10);
								histobj.put("dataMovimento", dataMovimento);			histobj.put("mesAnoAnterior", mesAnoAnterior);
								histobj.put("mesAno2Anterior", mesAno2Anterior);		histobj.put("mesAnoAtual", mesAnoAtual);
								histobj.put("nomePortador", nomePortador);				histobj.put("contaMovimento", contaMovimento);
								histobj.put("contaPortador", contaPortador);	   		histobj.put("contaDebito", "");
								histobj.put("contaCredito", "");						histobj.put("contaJuros", contaJuros);
								histobj.put("contaDesconto", contaDesconto);			histobj.put("contaMulta", contaMulta);
								histobj.put("valorDocumento", valorDocumento);			histobj.put("tipoPlanilha", tipoPlanilha); 
								histobj.put("valorJuros", valorJuros);   				histobj.put("valorDesconto", valorDesconto);
								histobj.put("valorMulta", valorMulta); 				    histobj.put("codFilial", codFilial);
								histobj.put("nomeArquivo", nomeArquivo.toUpperCase()); // foi ajustado 
								
								// #DOCUMENTACAO
								// TRATA PLANILHA OU LANCAMENTO EXPECIFICO COMO EXTRATO
								tratarComoExtrato = getTratarComoExtrato(line.replaceAll("\\|","").replaceAll(";","").replaceAll(",","").trim(), tipoLancamento, documento, nomeOrigem, histobj);
                                nomeOrigem = nomeOrigem.replaceAll("  ", " ").trim();
								if (tratarComoExtrato) {
                                    if (nomeOrigem.length() > 199) nomeOrigem = cutString(nomeOrigem, 0, 180); // #Fabrica(2019-10-03) @Becker
									JSONObject jDados = new JSONObject();
									jDados.put("PORTADOR",    		nomePortador);
									jDados.put("EMPRESA",     		codEmpresa);
									jDados.put("DATAMOVIMENTO",	 	dataMovimento);
									jDados.put("NOMEARQUIVO",       debitoCredito+nomeArquivo.toUpperCase()); // #DOCUMENTACAO EVITA PROBLEMA DE TRANSFERENCIAS NO MESMO ARQUIVO
									jDados.put("NOMEORIGEM",    	nomeOrigem);
									jDados.put("VALORDOCUMENTO",    valorDocumento);
									jDados.put("COMPLEMENTO01",     complemento02);
									jDados.put("DEBITO-CREDITO",    debitoCredito);
									jDados.put("CONT",  			String.valueOf(cont));
									boolean primExtrato = insertIOExtrato(jDados, dbIOCont, logger );
									jStatus = new JSONObject();
									putStatus(dirName, "", jStatus, logger);
									continue;									
								}
								
								debitoCredito = ""; // zera aqui para n?o confundir com extratos bancarios.


								// #DOCUMENTACAO
								// trata lancamento como juros (de outro lancamento)
								complemento10 = "";
								tratarComoJuros = getTratarComoJuros(line.replaceAll("\\|","").replaceAll(";","").replaceAll(",","").trim(), tipoLancamento, documento, nomeOrigem, histobj);
								if (tratarComoJuros) {
									complemento10 = dataMovimento + "-" + documento + "-JUROS";
									ttJuros ttJ    = (ttJuros)mapaJuros.get(complemento10);
									if (ttJ == null) {
										ttJ  = new ttJuros();
										ttJ.documento  = documento;
										ttJ.valorJur   = valorDocumento;
										ttJ.valorLido  = 0;
									}
									mapaJuros.put(complemento10,ttJ);
									continue;
								}

								// #DOCUMENTACAO
								// trata lancamento como desconto (de outro lancamento)
								tratarComoDesconto = getTratarComoDesconto(line.replaceAll("\\|","").replaceAll(";","").replaceAll(",","").trim(), tipoLancamento, documento, nomeOrigem, histobj);
								if (tratarComoDesconto) {
									complemento10  = dataMovimento + "-" + documento + "-DESCONTO";
									ttDesconto ttD    = (ttDesconto)mapaDesconto.get(complemento10);

									if(valorDocumento == 0) continue;

									if (ttD == null) {
										ttD  = new ttDesconto();
										ttD.documento  = documento;
										ttD.valorDesc  = valorDocumento;
										ttD.valorLido  = 0;
									}
									mapaDesconto.put(complemento10,ttD);
									continue;
								}

								int restoLinha = 0;
								restoLinha = (cont % 100);
								if (restoLinha == 0) putStatus(dirName, "02--Etapa 2 de 4 - " + String.valueOf(cont) + "--" + tipoLancamento + ".status", jStatus, logger);


								String contLinhaTexto = String.valueOf(cont);
								contLinhaTexto = StringUtil.leftPad(contLinhaTexto, 05, "0");
								String consolidaClass = StringUtil.leftPad(String.valueOf(porAba), 02, "0") + contLinhaTexto;

								classificacao         = dataMovimento.replace("/","").trim() + consolidaClass;
								
								//alterado para evitar problemas de lote (maiusculo)
								lote = nomeEmpresa + "_" + codEmpresa + "__" + nomeArquivo  + "__" + tipoLancamento;
								chave = lote + "-" + String.valueOf(porAba) + "-" + contLinhaTexto;
                                // lote = nomeEmpresa + "_" + codEmpresa + "_" + nomeArquivo  + "_" + dataLote + "_" + tipoLancamento;

								if(chave.length() > 200)  chave = chave.substring(0, 199);
								
								// #DOCUMENTACAO
								////////////////////////////////////////////////////////////// ACUMULA ANTES
								histobj.put("nomeOrigem", nomeOrigem);
								histobj.put("documento", documento);
								histobj.put("complemento01", complemento01);
								histobj.put("complemento02", complemento02);
								histobj.put("complemento03", complemento03);
								histobj.put("complemento04", complemento04);
								histobj.put("complemento05", complemento05);
								histobj.put("complemento06", complemento06);
								histobj.put("nomePortador", nomePortador);
								histobj.put("dataMovimento", dataMovimento);
								histobj.put("mesAnoAnterior", mesAnoAnterior);
								histobj.put("mesAno2Anterior", mesAno2Anterior);
								histobj.put("mesAnoAtual", mesAnoAtual);
								histobj.put("valorDocumento", valorDocumento);
								histobj.put("valorJuros", valorJuros);
								histobj.put("valorDesconto", valorDesconto);
								histobj.put("valorMulta",valorMulta);
								histobj.put("tipoPlanilha", tipoPlanilha);
								histobj.put("nomeArquivo", nomeArquivo.toUpperCase());
								
								String testeChave = getRegrasParaAcumular(lote, chave, tipoLancamento, documento, nomeOrigem, histobj).replaceAll("[^0-9a-zA-Z]*", "");
								if(testeChave.toUpperCase().contains("ACUMULAANTES") || testeChave.toUpperCase().contains("ACUMULARANTES")) {
									chave = testeChave;
									if(chave.length() > 180) chave = cutString(chave, 0, 179);
									acumulouAntes = true;
								}
								////////////////////////////////////////////////////////////////////////////////////
								String key = chave  + "-CTB";
								nomeOrigem = nomeOrigem.replaceAll("  "," ").trim();

								
								// #DOCUMENTACAO
								// insere numa tabela temporaria
								ttMovimentoPadrao ttMov2      = (ttMovimentoPadrao)mapaVariavel.get(key);
								if (ttMov2 == null) {
									ttMov2 = new ttMovimentoPadrao();
									ttMov2.lote              = lote;
									ttMov2.codEmpresa        = codEmpresa;
									ttMov2.nomeEmpresa       = nomeEmpresa;
									ttMov2.dataMovimento     = dataMovimento;
									ttMov2.tipoMovimento     = "CTB";
									ttMov2.tipoLancamento    = tipoLancamento;
									ttMov2.historico         = historico;
									ttMov2.contaJuros        = contaJuros;
									ttMov2.contaMulta        = contaMulta;
									ttMov2.contaDesconto     = contaDesconto;
									ttMov2.centroCusto       = codCcOrigem;
									ttMov2.cpfCnpj           = cpfCnpj;
									ttMov2.chave             = chave + "-CTB";
									ttMov2.classificacao     = classificacao;
									ttMov2.codFilial         = codFilial;
									ttMov2.complemento07     = complemento07;
									ttMov2.complemento08     = complemento08;
									ttMov2.complemento09     = complemento09;
									ttMov2.complemento10     = complemento10;
									ttMov2.nomeArquivo       = nomeArquivo.toUpperCase();
									ttMov2.tipoPlanilha      = tipoPlanilha;
									ttMov2.chaveExtrato      = chaveExtrato;
									ttMov2.debitoCredito     = debitoCredito;
                                    ttMov2.contLinha         = contLinhaTexto;
									ttMov2.historicoMulta    = "";
									ttMov2.historicoJuros    = "";
									ttMov2.historicoDesconto = "";
									ttMov2.contaDebito       = "";
									ttMov2.contaCredito      = "";
									ttMov2.naturezaContabil  = "";
									ttMov2.contador 		 = 0;
									ttMov2.parcelaDoc        = parcelaDoc;
									ttMov2.abaPlanilha       = String.valueOf(porAba);

									if(!lerAposPrincipal.contains("FORNECEDOR"))	ttMov2.nomeOrigem    = nomeOrigem;
									if(!lerAposPrincipal.contains("DOCUMENTO")) 	ttMov2.documento 	 = documento;
									if(!lerAposPrincipal.contains("PORTADOR"))      ttMov2.nomePortador  = nomePortador;
									if(!lerAposPrincipal.contains("COMPLEMENTO01")) ttMov2.complemento01 = complemento01;
									if(!lerAposPrincipal.contains("COMPLEMENTO02")) ttMov2.complemento02 = complemento02;
									if(!lerAposPrincipal.contains("COMPLEMENTO03")) ttMov2.complemento03 = complemento03;
									if(!lerAposPrincipal.contains("COMPLEMENTO04")) ttMov2.complemento04 = complemento04;
									if(!lerAposPrincipal.contains("COMPLEMENTO05")) ttMov2.complemento05 = complemento05;
									if(!lerAposPrincipal.contains("COMPLEMENTO06")) ttMov2.complemento06 = complemento06;


								}

								///  -------------------------------------------------------------------------------------------------------
								///	 QUANDO FOR PLANILHA COM MAIS DE UMA LINHA, JOGAR OS VALORES PARA CIMA (dentro da parte de inclusao)
								///  E PASSAR PARA BAIXO OS CAMPOS QUE PODEM SER SOBREPOSTOS. Exemplo para a linha de baixo:
								///  if (!complemento02.equals("")) ttMov2.complemento02 = complemento02;
								///  -------------------------------------------------------------------------------------------------------

								// #DOCUMENTACAO
								// acumula linhas secundarias ou apenas l? as secundarias
								boolean acumulaSegundaLinha = true;
								
								if(acumulaSegundaLinha){
									if (!nomeOrigem.equals("")    && lerAposPrincipal.contains("FORNECEDOR"))	 ttMov2.nomeOrigem    = (ttMov2.nomeOrigem    + " " + nomeOrigem).trim();
									if (!documento.equals("") 	  && lerAposPrincipal.contains("DOCUMENTO")) 	 ttMov2.documento	  = (ttMov2.documento + " " + documento).trim();
									if (!nomePortador.equals("")  && lerAposPrincipal.contains("PORTADOR"))      ttMov2.nomePortador  = (ttMov2.nomePortador  + " " + nomePortador).trim();
									if (!complemento01.equals("") && lerAposPrincipal.contains("COMPLEMENTO01")) ttMov2.complemento01 = (ttMov2.complemento01 + " " + complemento01).trim();
									if (!complemento02.equals("") && lerAposPrincipal.contains("COMPLEMENTO02")) ttMov2.complemento02 = (ttMov2.complemento02 + " " + complemento02).trim();
									if (!complemento03.equals("") && lerAposPrincipal.contains("COMPLEMENTO03")) ttMov2.complemento03 = (ttMov2.complemento03 + " " + complemento03).trim();
									if (!complemento04.equals("") && lerAposPrincipal.contains("COMPLEMENTO04")) ttMov2.complemento04 = (ttMov2.complemento04 + " " + complemento04).trim();
									if (!complemento05.equals("") && lerAposPrincipal.contains("COMPLEMENTO05")) ttMov2.complemento05 = (ttMov2.complemento05 + " " + complemento05).trim();
									if (!complemento06.equals("") && lerAposPrincipal.contains("COMPLEMENTO06")) ttMov2.complemento06 = (ttMov2.complemento06 + " " + complemento06).trim();
								}
								if(!acumulaSegundaLinha){
									if (!nomeOrigem.equals("")    && lerAposPrincipal.contains("FORNECEDOR"))	 ttMov2.nomeOrigem    = nomeOrigem.trim();
									if (!documento.equals("") 	  && lerAposPrincipal.contains("DOCUMENTO")) 	 ttMov2.documento	  = documento.trim();
									if (!nomePortador.equals("")  && lerAposPrincipal.contains("PORTADOR"))      ttMov2.nomePortador  = nomePortador.trim();
									if (!complemento01.equals("") && lerAposPrincipal.contains("COMPLEMENTO01")) ttMov2.complemento01 = complemento01.trim();
									if (!complemento02.equals("") && lerAposPrincipal.contains("COMPLEMENTO02")) ttMov2.complemento02 = complemento02.trim();
									if (!complemento03.equals("") && lerAposPrincipal.contains("COMPLEMENTO03")) ttMov2.complemento03 = complemento03.trim();
									if (!complemento04.equals("") && lerAposPrincipal.contains("COMPLEMENTO04")) ttMov2.complemento04 = complemento04.trim();
									if (!complemento05.equals("") && lerAposPrincipal.contains("COMPLEMENTO05")) ttMov2.complemento05 = complemento05.trim();
									if (!complemento06.equals("") && lerAposPrincipal.contains("COMPLEMENTO06")) ttMov2.complemento06 = complemento06.trim();
								}
								
								ttMov2.valorDocumento   = ttMov2.valorDocumento  + valorDocumento;
								ttMov2.valorDesconto    = ttMov2.valorDesconto   + valorDesconto;
								ttMov2.valorMulta       = ttMov2.valorMulta      + valorMulta;
								if(!ttMov2.tipoPlanilha.equals("MOVIMENTO")) ttMov2.valorJuros       = ttMov2.valorJuros      + valorJuros;
								leuFinanceiro = true;
								mapaVariavel.put(key,ttMov2);
                                if(ttMov2.tipoPlanilha.equals("MOVIMENTO") && 
                                        valorJuros> 0){
                                            cont++;
                                            contLinhaTexto = String.valueOf(cont);
                                            contLinhaTexto = StringUtil.leftPad(contLinhaTexto, 05, "0");
                                            consolidaClass = StringUtil.leftPad(String.valueOf(porAba), 02, "0") + contLinhaTexto;

                                            classificacao         = dataMovimento.replace("/","").trim() + consolidaClass;

                                            chave = lote + "-" + String.valueOf(porAba) + "-EXTRA-" + contLinhaTexto;
                                            key = chave  + "-CTB";

                                            ttMovimentoPadrao ttMov = geralancamentoExtraInterno((ttMovimentoPadrao)mapaVariavel.get(chave), 
                                            ttMov2, key, true, 6, "EXTRA-JUROS", classificacao);
                                            
                                            ttMov.valorDocumento = valorJuros;
                                            mapaVariavel.put(key,ttMov);

                                            
                                        }

                                if(ttMov2.tipoPlanilha.equals("MOVIMENTO") && 
                                    ttMov2.complemento04.contains("ANTECIPA")){
                                        cont++;

                                        String dataAux2 = dataMovimento;
                                        dataMovimento =   "01/" + complemento03.trim();
                                        dataLote = getCampoDate(dataMovimento, "", "yyyy-MM");
                                        lote = nomeEmpresa + "_" + codEmpresa + "__" + nomeArquivo  + "__" + tipoLancamento;

                                        classificacao         = dataMovimento.replace("/","").trim() + consolidaClass;
                                        chave = lote + "-" + String.valueOf(porAba) + "-EXTRA2-" + contLinhaTexto;

                                        chave = chave.replaceAll(getCampoDate(dataAux2, "", "yyyy-MM"), getCampoDate(dataMovimento, "", "yyyy-MM"));

                                        contLinhaTexto = String.valueOf(cont);
                                        contLinhaTexto = StringUtil.leftPad(contLinhaTexto, 05, "0");
                                        consolidaClass = StringUtil.leftPad(String.valueOf(porAba), 02, "0") + contLinhaTexto;

                                        key = chave  + "-CTB";

                                        ttMovimentoPadrao ttMov = geralancamentoExtraInterno((ttMovimentoPadrao)mapaVariavel.get(chave), 
                                        ttMov2, key, true, 6, "EXTRA-ANTECIPACAO", classificacao);
                                        ttMov.dataMovimento = dataMovimento;
                                        ttMov.chave             = chave + "-CTB";
                                        ttMov.lote = lote;
                                        
                                        mapaVariavel.put(key,ttMov);
                                    }



							} catch (Exception e) {
								logger.logError("EndpointA:", e);
							}
						} // while
					}finally {
						
						/*if (memFile != null) { //closeFile
							try {memFile.closeFile(); } 
							catch (Exception ex) { }
						}*/ //closeFile
						
					}
				}

            }
            try{
                FileUtil.moveToDir(dirName+"/"+nomeArquivo, backupDirName);
            }catch(Exception ee){}

        }
    } catch (Exception ee) {
        putStatus(dirName, tipoLancamento + ".err", jStatus, logger);
        logger.logError("EndpointA: ", ee);
    }

    if(erroShrink){
        putStatus(dirName, tipoLancamento + ".err", jStatus, logger);
        throw new Exception();
    }
	// --------------------------------------------------------------------------------------------------------------------
	// #DOCUMENTACAO
	// BUSCA INFORMACAO DE EXTRATOS SALVOS
	if (leuFinanceiro && cruzaExtrato.contains("TRUE") || (tipoPlanilha.contains("EXTRATO") && cruzaExtrato.contains("FALSE")) ||
        (Cruza_Extrato_com_Extrato.contains("TRUE") && cruzaExtrato.contains("FALSE")) ||
        (Cruza_Extrato_com_Extrato.contains("FALSE") && cruzaExtrato.contains("FALSE"))) {

        try {
            JSONArray extratoEmpresa = getExtratosEmpresa(codEmpresa, dbIOCont, logger);

            if (extratoEmpresa != null && extratoEmpresa.length() > 0) {
                for (int t=0; t<extratoEmpresa.length(); t++) {

                    JSONObject recMov = extratoEmpresa.optJSONObject(t);

                    recMov.put("CODEMPRESA", codEmpresa);
                    recMov.put("NOMEEMPRESA", nomeEmpresa);

                    //QUANDO FOR CRUZAMENTO DE EXTRATO, MANTER NOME UNICO NO ARQUIVO FINAL.
                    if (leuFinanceiro && cruzaExtrato.contains("TRUE")) {
                        recMov.put("NOMEARQUIVO", nomeArquivo);
                    }
                    else {
                        recMov.put("NOMEARQUIVO", "");
                    }

                    recMov.put("TIPOLANCAMENTO", tipoLancamento);
                    recMov.put("CONTAMOVIMENTO", "");
                    recMov.put("CONTAPORTADOR", "");
                    recMov.put("CONTLINHATEXTO", String.valueOf(t));

                    ttMovimentoPadrao ttMovExtrato = getMovimentoExtrato(recMov, logger);
                    if (nomeArquivo.toUpperCase().contains("FILTRO_")){
                        boolean filtro = validaFiltro(nomeArquivo, ttMovExtrato.dataMovimento);
                        if(!filtro) continue; 
                    } 
                    mapaVariavel.put(ttMovExtrato.chave, ttMovExtrato);
                    apagaExtrato    = true;

                }
            }
        }
        catch (Exception xx) {
            logger.logDebug("ATENCAO - PROBLEMA NA LEITURA DE EXTRATO - BANCO");
        }

    } // if tipo planilha nao igual extrato
    // --------------------------------------------------------------------------------------------------------------------
	// #DOCUMENTACAO
	// INICIO DAS ITERACOES
    StringBuilder txtFiscal     = new StringBuilder();
    StringBuilder txtFornecedor = new StringBuilder();
    StringBuilder txtPortador   = new StringBuilder();
    String nomePortadorAnterior = "";
    if(roteiroCRMPrincipal.optString("erpContabilidade").equals("MAKROWEB")) txtFiscal.append("PGTOFOR").append(cnpjEmpresa).append("\r\n");  // #Fabrica(2019-08-13) @Vini


    int contRegra = -1;
    try {
        Iterator itExtrato = mapaVariavel.keySet().iterator();
        while (itExtrato.hasNext()) {
            String chaveExtrato     = "";

            String key = (String)itExtrato.next();
            ttMovimentoPadrao ttMov = (ttMovimentoPadrao)mapaVariavel.get(key);

            if ((ttMov.complemento04.contains("MENSALIDADES RECEBIDAS DE ANOS ANTERIORES") || ttMov.complemento04.contains("CURRICULAR RECEBIDAS DE ANOS ANTERIORES")) && !ttMov.complemento06.contains("EXTRA-JUROS")) {
				int anoLancamento = 0;
				int anoCompetencia = 0;
				// logger.logDebug("ANO " + " | " + ttMov.complemento03.substring(3,7) + " | " + ttMov.dataMovimento.substring(6,10));
				try {
					anoLancamento = Integer.parseInt(ttMov.dataMovimento.substring(6,10));
                } catch(Exception e) {}
				try {				
					anoCompetencia = Integer.parseInt(ttMov.complemento03.substring(3,7));
				} catch(Exception e) {}
				
				// logger.logDebug("CP4 " + ttMov.complemento04 + " | " + anoLancamento + " | " + anoCompetencia);
				
                if ((anoLancamento - 1) == anoCompetencia) {
                    ttMov.complemento06 = "IGUAL";
                } else {
                    if ((anoLancamento - 1) > anoCompetencia) {
                        ttMov.complemento06 = "MENOR";
                    }
                }
            }

            if(!ttMov.tipoPlanilha.equals("MOVIMENTO") && !ttMov.tipoPlanilha.contains("EXTRATO")){
                roteiroCRM = buscaRoteiro("getRoteiro"+ttMov.tipoPlanilha, logger);
            }else{
                roteiroCRM = getRoteiro();
            }
			
			// #DOCUMENTACAO
			// TRATA LOTES (MAIUSCULO e MINUSCULO)
			if(ttMov.lote.lastIndexOf("__") > ttMov.lote.indexOf("__")){
				ttMov.lote = nomeEmpresa +"_"+ codEmpresa +"_"+  cutString(ttMov.lote, ttMov.lote.indexOf("__"), ttMov.lote.lastIndexOf("__")).toLowerCase() +"_"+ ttMov.lote.substring(ttMov.lote.lastIndexOf("__"));
			}
			// #DOCUMENTACAO
			// EVITA GERAR 2 ARQUIVOS QUANDO TEM TRATAR COMO EXTRATO
			ttMov.lote = ttMov.lote.replace(ttMov.debitoCredito,"").replace("extrato-debito","").replace("extrato-credito","").replace("___","_").replace("__","_");

			// #DOCUMENTACAO
			// JUNCAO DOS LANCAMENTOS COM OS JUROS E DESCONTOS (TRATAR COMO JUROS OU DESCONTO)
			String chaveJuros = ttMov.dataMovimento + "-" + ttMov.documento + "-JUROS";
            ttJuros ttJ  = (ttJuros)mapaJuros.get(chaveJuros);
            if (ttJ != null && ttJ.valorLido == 0) {
                ttMov.valorJuros  = ttJ.valorJur;
                ttJ.valorLido     = 1;
                mapaJuros.put(chaveJuros,ttJ);

            }

			String chaveDesconto = ttMov.dataMovimento + "-" + ttMov.documento + "-DESCONTO";
            ttDesconto ttD  = (ttDesconto)mapaDesconto.get(chaveDesconto);
            if (ttD != null && ttD.valorLido == 0) {
                ttMov.valorDesconto  = ttD.valorDesc;
                ttD.valorLido     = 1;
                mapaDesconto.put(chaveDesconto,ttD);

            }
            contRegra++;
            int restoLinha = 0;
            restoLinha = (contRegra % 100);
            if (restoLinha == 0) putStatus(dirName, "03--Etapa 3 de 4 - " + String.valueOf(contRegra) + "--" + tipoLancamento + ".status", jStatus, logger);

            classificaPlano     = roteiroCRM.optString("classificaPlano");
            classificaFornec    = roteiroCRM.optString("classificaFornec");
            cruzaExtrato	    = roteiroCRM.optString("cruzaExtrato").toUpperCase();
            Cruza_Extrato_com_Extrato = roteiroCRM.optString("Cruza_Extrato_com_Extrato").toUpperCase();
            String integraFiscal = roteiroCRM.optString("Integracao_fiscal").toUpperCase();

            if(ttMov.tipoLancamento.contains("PAGAR")   && ttMov.debitoCredito.contains("EXTRATO-CREDITO")) continue;
            if(ttMov.tipoLancamento.contains("RECEBER") && ttMov.debitoCredito.contains("EXTRATO-DEBITO")) continue;

            // ------------------------------------------------------------------------------------------------------------------
            // 	 		INICIA PROCESSO DE CRUZAMENTO COM EXTRATO
            // ------------------------------------------------------------------------------------------------------------------
            String DATAMOVIMENTO   = "";
            String PORTADOR        = "";
            String CHAVE           = "";
            boolean jaCruzou       = false;


			// #DOCUMENTACAO
			// EXTRATO COM EXTRATO
            if (Cruza_Extrato_com_Extrato.contains("TRUE") && ttMov.tipoPlanilha.contains("EXTRATO")) {

                String tipoData = "MOVIMENTO";
                Date dataMovimentoDate = DateUtil.stringToDate(ttMov.dataMovimento, "dd/MM/yyyy");
                Calendar cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate);
                if (ttMov.valorDocumento == 0) continue;

                JSONArray extratoEmpresa = new JSONArray();
                String transferencia = "NAO";

                if(ttMov.tipoLancamento.contains("PAGAR")   && ttMov.debitoCredito.contains("EXTRATO-DEBITO"))  transferencia = "SIM";
                if(ttMov.tipoLancamento.contains("RECEBER") && ttMov.debitoCredito.contains("EXTRATO-CREDITO")) transferencia = "SIM";

                if (transferencia.equals("SIM")) {
                    for (int xx = 0;xx<1;xx++) {
                        try {
                            String dataLeitura = ttMov.dataMovimento;

                            if(ttMov.tipoLancamento.contains("PAGAR"))   chaveExtrato = codEmpresa + "-" +  dataLeitura + "-" + "EXTRATO-CREDITO" + "-" + String.format("%.2f", (ttMov.valorDocumento + ttMov.valorJuros + ttMov.valorMulta - ttMov.valorDesconto));
                            if(ttMov.tipoLancamento.contains("RECEBER")) chaveExtrato = codEmpresa + "-" +  dataLeitura + "-" + "EXTRATO-DEBITO" + "-" + String.format("%.2f", (ttMov.valorDocumento + ttMov.valorJuros + ttMov.valorMulta - ttMov.valorDesconto));

                            extratoEmpresa = dbIOCont.sql("SELECT CHAVE,CODEMPRESA, DATAMOVIMENTO, PORTADOR, HISTORICO, LOTE, COMPLEMENTO, VALORDOCUMENTO, DEBITOCREDITO, EXTRATOLIDO FROM IO_EXTRATO WHERE CHAVE LIKE ? AND EXTRATOLIDO = ? AND LOTE <> ? ")
                            .fields("CHAVE,CODEMPRESA, DATAMOVIMENTO, PORTADOR, HISTORICO, LOTE, COMPLEMENTO, VALORDOCUMENTO, DEBITOCREDITO, EXTRATOLIDO")
                            .param(chaveExtrato + "%")
                            .param(0)
                            .param(ttMov.nomeArquivo.toUpperCase())
                            .query();

                            if (extratoEmpresa != null && extratoEmpresa.length() > 0) {
                                break;
                            }
                        }
                        catch (Exception xx) {
                            break;
                        }
                    }
                }

                if (extratoEmpresa != null && extratoEmpresa.length() > 0) {
                    JSONObject recMov = extratoEmpresa.optJSONObject(0);

                    DATAMOVIMENTO   = recMov.optString("DATAMOVIMENTO");
                    PORTADOR        = recMov.optString("PORTADOR");
                    CHAVE           = recMov.optString("CHAVE");

                    ttMov.complemento04 = ttMov.nomeOrigem;
                    ttMov.nomeOrigem    = PORTADOR;
                    ttMov.dataMovimento = DATAMOVIMENTO;
                    ttMov.tipoPlanilha  = "EXTRATO-TRANSFERENCIA";

                    dbIOCont.update("IO_EXTRATO")
                    .fields("EXTRATOLIDO")
                    .where("CHAVE = ? ")
                    .param(1)
                    .param(CHAVE)
                    .execute();
                    jaCruzou = true;

                }
            }

			// #DOCUMENTACAO
			// EXTRATO COM PLANILHA
            if (cruzaExtrato.contains("TRUE")  && !jaCruzou) {

                Conta_Fixa_Cruzamento_Extrato  = roteiroCRMPrincipal.optString("Conta_Fixa_Cruzamento_Extrato");

                String tipoData = "MOVIMENTO";
                Date dataMovimentoDate = DateUtil.stringToDate(ttMov.dataMovimento, "dd/MM/yyyy");
                Date dataMovimentoDateMenosUm   = new Date();
                Date dataMovimentoDateMenosDois = new Date();
                Date dataMovimentoDateMenosTres = new Date();
                Date dataMovimentoDateMaisUm    = new Date();
                Date dataMovimentoDateMaisDois  = new Date();
                Date dataMovimentoDateMaisTres  = new Date();

                Calendar cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, -1); dataMovimentoDateMenosUm   = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate);          cal.add (Calendar.DATE, -2); dataMovimentoDateMenosDois = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate);          cal.add (Calendar.DATE, -3); dataMovimentoDateMenosTres = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate);          cal.add (Calendar.DATE, +1); dataMovimentoDateMaisUm    = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate);          cal.add (Calendar.DATE, +2); dataMovimentoDateMaisDois  = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate);          cal.add (Calendar.DATE, +3); dataMovimentoDateMaisTres  = cal.getTime();

                if (ttMov.valorDocumento == 0) continue;

                JSONArray extratoEmpresa = new JSONArray();

                String transferencia = "NAO";

                if (!ttMov.tipoPlanilha.contains("EXTRATO")) {
                    for (int xx = 0;xx<7;xx++) {
                        try {
                            String dataLeitura = ttMov.dataMovimento;
                            if (xx ==1) dataLeitura = DateUtil.dateToString(dataMovimentoDateMaisUm, "dd/MM/yyyy");
                            if (xx ==2) dataLeitura = DateUtil.dateToString(dataMovimentoDateMenosUm, "dd/MM/yyyy");
                            if (xx ==3) dataLeitura = DateUtil.dateToString(dataMovimentoDateMaisDois, "dd/MM/yyyy");
                            if (xx ==4) dataLeitura = DateUtil.dateToString(dataMovimentoDateMenosDois, "dd/MM/yyyy");
                            if (xx ==5) dataLeitura = DateUtil.dateToString(dataMovimentoDateMaisTres, "dd/MM/yyyy");
                            if (xx ==6) dataLeitura = DateUtil.dateToString(dataMovimentoDateMenosTres, "dd/MM/yyyy");


                            if(ttMov.tipoLancamento.contains("PAGAR"))   chaveExtrato = codEmpresa + "-" +  dataLeitura + "-" + "EXTRATO-DEBITO" + "-" + String.format("%.2f", (ttMov.valorDocumento + ttMov.valorJuros + ttMov.valorMulta - ttMov.valorDesconto));
                            if(ttMov.tipoLancamento.contains("RECEBER")) chaveExtrato = codEmpresa + "-" +  dataLeitura + "-" + "EXTRATO-CREDITO" + "-" + String.format("%.2f", (ttMov.valorDocumento + ttMov.valorJuros + ttMov.valorMulta - ttMov.valorDesconto));

                            extratoEmpresa = dbIOCont.sql("SELECT CHAVE,CODEMPRESA, DATAMOVIMENTO, PORTADOR, HISTORICO, LOTE, COMPLEMENTO, VALORDOCUMENTO, DEBITOCREDITO, EXTRATOLIDO FROM IO_EXTRATO WHERE CHAVE LIKE ? AND EXTRATOLIDO = ? AND LOTE <> ? ")
                            .fields("CHAVE,CODEMPRESA, DATAMOVIMENTO, PORTADOR, HISTORICO, LOTE, COMPLEMENTO, VALORDOCUMENTO, DEBITOCREDITO, EXTRATOLIDO")
                            .param(chaveExtrato + "%")
                            .param(0)
                            .param(ttMov.nomeArquivo.toUpperCase())
                            .query();

                            if (extratoEmpresa != null && extratoEmpresa.length() > 0) {
                                break;
                            }
                        }
                        catch (Exception xx) {
                            break;
                        }
                    }
                }

                if (extratoEmpresa != null && extratoEmpresa.length() > 0) {
                    JSONObject recMov = extratoEmpresa.optJSONObject(0);

                    DATAMOVIMENTO   = recMov.optString("DATAMOVIMENTO");
                    PORTADOR        = recMov.optString("PORTADOR");
                    CHAVE           = recMov.optString("CHAVE");
                    if (roteiroCRM.optString("Aloca_Checknum").toUpperCase().equals("TRUE")) ttMov.complemento02 = recMov.optString("COMPLEMENTO"); //checknum

                    ttMov.nomePortador  = PORTADOR;
                    ttMov.dataMovimento = DATAMOVIMENTO;

                    dbIOCont.update("IO_EXTRATO")
                    .fields("EXTRATOLIDO")
                    .where("CHAVE = ? ")
                    .param(1)
                    .param(CHAVE)
                    .execute();

                }

            }


            // ------------------------------------------------------------------------------------------------------------------
            // 	 		FINALO DO PROCESSO DE CRUZAMENTO COM EXTRATO
            // ------------------------------------------------------------------------------------------------------------------




            classificacao = "";

            String key2 = ttMov.chave;

            if(ttMov.dataMovimento.length() > 9){
                mesRef  = Integer.parseInt(ttMov.dataMovimento.substring(3,5));
                anoRef  = Integer.parseInt(ttMov.dataMovimento.substring(6,10));
                mesAnoAtual = StringUtil.leftPad(String.valueOf(mesRef),2,"0") + "/" + String.valueOf(anoRef);

                mesRef  = mesRef - 1;
                if (mesRef  == 0) {
                    mesRef  = 12;
                    anoRef  = anoRef - 1;
                }
                mesAnoAnterior = StringUtil.leftPad(String.valueOf(mesRef),2,"0") + "/" + String.valueOf(anoRef);
                mesRef  = mesRef - 1;
                if (mesRef  == 0) {
                    mesRef  = 12;
                    anoRef  = anoRef - 1;
                }
                mesAno2Anterior = StringUtil.leftPad(String.valueOf(mesRef),2,"0") + "/" + String.valueOf(anoRef);
            }

            String trimestreMesAnoAnterior	    = "";
            String trimestreMesAnoAtual   	    = "";
            String descricaoPlanoContaPortador  = "";
            String descricaoPlanoContaMovimento = "";

			// #DOCUMENTACAO
			// TRIMESTRE
            if (mesAnoAnterior.startsWith("01") || mesAnoAnterior.startsWith("02") || mesAnoAnterior.startsWith("03")) trimestreMesAnoAnterior = "1. Trimestre/" + mesAnoAnterior.substring(3);
            if (mesAnoAnterior.startsWith("04") || mesAnoAnterior.startsWith("05") || mesAnoAnterior.startsWith("06")) trimestreMesAnoAnterior = "2. Trimestre/" + mesAnoAnterior.substring(3);
            if (mesAnoAnterior.startsWith("07") || mesAnoAnterior.startsWith("08") || mesAnoAnterior.startsWith("09")) trimestreMesAnoAnterior = "3. Trimestre/" + mesAnoAnterior.substring(3);
            if (mesAnoAnterior.startsWith("10") || mesAnoAnterior.startsWith("11") || mesAnoAnterior.startsWith("12")) trimestreMesAnoAnterior = "4. Trimestre/" + mesAnoAnterior.substring(3);
            if (mesAnoAtual.startsWith("01") || mesAnoAtual.startsWith("02") || mesAnoAtual.startsWith("03")) trimestreMesAnoAtual = "1. Trimestre/" + mesAnoAtual.substring(3);
            if (mesAnoAtual.startsWith("04") || mesAnoAtual.startsWith("05") || mesAnoAtual.startsWith("06")) trimestreMesAnoAtual = "2. Trimestre/" + mesAnoAtual.substring(3);
            if (mesAnoAtual.startsWith("07") || mesAnoAtual.startsWith("08") || mesAnoAtual.startsWith("09")) trimestreMesAnoAtual = "3. Trimestre/" + mesAnoAtual.substring(3);
            if (mesAnoAtual.startsWith("10") || mesAnoAtual.startsWith("11") || mesAnoAtual.startsWith("12")) trimestreMesAnoAtual = "4. Trimestre/" + mesAnoAtual.substring(3);


            if (ttMov.nomeOrigem.equals("")) ttMov.nomeOrigem = ttMov.complemento01 + " " + ttMov.dataMovimento + " R$" + String.valueOf(ttMov.documento);
            ttMov.nomeOrigem = ttMov.nomeOrigem.trim();
            if (ttMov.nomePortador.equals("")) ttMov.nomePortador = "EM BRANCO";

            contaJuros        = roteiroCRM.optString("contaFixaJuros");
            contaFixaCredito  = roteiroCRM.optString("contaFixaCredito");
            contaFixaDebito   = roteiroCRM.optString("contaFixaDebito");
            contaDesconto     = roteiroCRM.optString("contaFixaDesconto");
            contaMulta        = roteiroCRM.optString("contaFixaMulta");



            contaMovimento = "";
            contaPortador  = "";


            if(ttMov.tipoLancamento.contains("PAGAR")) {
                contaMovimento = contaFixaDebito;
                contaPortador  = contaFixaCredito;
            }
            if(ttMov.tipoLancamento.contains("RECEBER")) {
                contaPortador  = contaFixaDebito;
                contaMovimento = contaFixaCredito;
            }

            // Quando pede para cruzar extrato e nao encontra relacionamento com o extrato
            // joga conta fixa de extrato em DEBITO quando for extato e CREDITO quando for planilha
            if ((cruzaExtrato.contains("TRUE") || cruzaExtrato.contains("VERDADEIRO")) && PORTADOR.equals("")) {
                if (ttMov.tipoPlanilha.contains("EXTRATO"))  contaMovimento  = Conta_Fixa_Cruzamento_Extrato;
                if (!ttMov.tipoPlanilha.contains("EXTRATO")) contaPortador   = Conta_Fixa_Cruzamento_Extrato;
            }


            ttMov.complemento03 = ttMov.complemento03 + " C4#"+ ttMov.complemento04 + " C5#" + ttMov.complemento05 + " " + " C6#" + ttMov.complemento06 + " ";

            contaMovimento    = getConta09(contaMovimento, ttMov.nomeOrigem,  ttMov.documento, "", ttMov.complemento01,  ttMov.complemento02,  ttMov.complemento03, "",  ttMov.centroCusto);
            contaPortador     = getConta09(contaPortador, "", "", ttMov.nomePortador, "", "", "", ttMov.nomeArquivo, "");
            ttMov.centroCusto = getCentroCusto("", ttMov.nomeOrigem, ttMov.documento, ttMov.nomePortador, ttMov.complemento01, ttMov.complemento02, ttMov.complemento03, "", ttMov.centroCusto);
            ttMov.codFilial   = getFilial("", ttMov.nomeOrigem, ttMov.documento, ttMov.nomePortador,
                                          ttMov.complemento01, ttMov.complemento02, ttMov.complemento03,
                                          ttMov.nomeArquivo, ttMov.centroCusto, ttMov.codFilial);

            ttMov.complemento03  = ttMov.complemento03.substring(0,ttMov.complemento03.indexOf("C4#")).trim();

            JSONObject histobj = new JSONObject();

            histobj.put("nomeOrigem", ttMov.nomeOrigem);					histobj.put("documento", ttMov.documento);
            histobj.put("complemento01", ttMov.complemento01);				histobj.put("complemento02", ttMov.complemento02);
            histobj.put("complemento03", ttMov.complemento03);				histobj.put("complemento04", ttMov.complemento04);
            histobj.put("complemento05", ttMov.complemento05);				histobj.put("complemento06", ttMov.complemento06);
            histobj.put("complemento07", ttMov.complemento07);				histobj.put("complemento08", ttMov.complemento08);
            histobj.put("complemento09", ttMov.complemento09);				histobj.put("complemento10", ttMov.complemento10);
            histobj.put("dataMovimento", ttMov.dataMovimento);				histobj.put("mesAnoAnterior", mesAnoAnterior);
            histobj.put("mesAno2Anterior", mesAno2Anterior);				histobj.put("mesAnoAtual", mesAnoAtual);
            histobj.put("nomePortador", ttMov.nomePortador);				histobj.put("contaMovimento", contaMovimento);
            histobj.put("contaPortador", contaPortador);	   			    histobj.put("contaDebito", "");
            histobj.put("contaCredito", "");								histobj.put("contaJuros", ttMov.contaJuros);
            histobj.put("contaDesconto", ttMov.contaDesconto);				histobj.put("contaMulta", ttMov.contaMulta);
            histobj.put("centroCusto", ttMov.centroCusto);    				histobj.put("valorDocumento", ttMov.valorDocumento);
            histobj.put("valorJuros", ttMov.valorJuros);   				    histobj.put("valorDesconto", ttMov.valorDesconto);
            histobj.put("valorMulta", ttMov.valorMulta); 				    histobj.put("codFilial", ttMov.codFilial);
            histobj.put("tipoPlanilha", ttMov.tipoPlanilha);                histobj.put("numeroAba", ttMov.abaPlanilha);
            histobj.put("nomeArquivo", ttMov.nomeArquivo.toUpperCase());

            ttMov.complemento01 = getReplaceTermos("complemento01", ttMov.complemento01,  histobj);
            ttMov.complemento02 = getReplaceTermos("complemento02", ttMov.complemento02,  histobj);
            ttMov.complemento03 = getReplaceTermos("complemento03", ttMov.complemento03,  histobj);
            ttMov.complemento04 = getReplaceTermos("complemento04", ttMov.complemento04,  histobj);
            ttMov.complemento05 = getReplaceTermos("complemento05", ttMov.complemento05,  histobj);
            ttMov.complemento06 = getReplaceTermos("complemento06", ttMov.complemento06,  histobj);
            ttMov.complemento07 = getReplaceTermos("complemento07", ttMov.complemento07,  histobj);
            ttMov.complemento08 = getReplaceTermos("complemento08", ttMov.complemento08,  histobj);
            ttMov.complemento09 = getReplaceTermos("complemento09", ttMov.complemento09,  histobj);
            ttMov.complemento10 = getReplaceTermos("complemento10", ttMov.complemento10,  histobj);
            ttMov.nomeOrigem    = getReplaceTermos("nomeOrigem",    ttMov.nomeOrigem,     histobj);
            ttMov.documento     = getReplaceTermos("documento",     ttMov.documento,      histobj);
            ttMov.nomePortador  = getReplaceTermos("nomePortador",  ttMov.nomePortador,   histobj);

            ttMov.complemento01 = getLimpaCampos("complemento01", ttMov.complemento01,  histobj);
            ttMov.complemento02 = getLimpaCampos("complemento02", ttMov.complemento02,  histobj);
            ttMov.complemento03 = getLimpaCampos("complemento03", ttMov.complemento03,  histobj);
            ttMov.complemento04 = getLimpaCampos("complemento04", ttMov.complemento04,  histobj);
            ttMov.complemento05 = getLimpaCampos("complemento05", ttMov.complemento05,  histobj);
            ttMov.complemento06 = getLimpaCampos("complemento06", ttMov.complemento06,  histobj);
            ttMov.complemento07 = getLimpaCampos("complemento07", ttMov.complemento07,  histobj);
            ttMov.complemento08 = getLimpaCampos("complemento09", ttMov.complemento08,  histobj);
            ttMov.complemento09 = getLimpaCampos("complemento09", ttMov.complemento09,  histobj);
            ttMov.complemento10 = getLimpaCampos("complemento10", ttMov.complemento10,  histobj);
            ttMov.nomeOrigem    = getLimpaCampos("nomeOrigem",    ttMov.nomeOrigem,     histobj);
            ttMov.documento     = getLimpaCampos("documento",     ttMov.documento,      histobj);
            ttMov.nomePortador  = getLimpaCampos("nomePortador",  ttMov.nomePortador,   histobj);

			histobj.put("nomeOrigem", ttMov.nomeOrigem);					histobj.put("documento", ttMov.documento);
            histobj.put("complemento01", ttMov.complemento01);				histobj.put("complemento02", ttMov.complemento02);
            histobj.put("complemento03", ttMov.complemento03);				histobj.put("complemento04", ttMov.complemento04);
            histobj.put("complemento05", ttMov.complemento05);				histobj.put("complemento06", ttMov.complemento06);
            histobj.put("complemento07", ttMov.complemento07);				histobj.put("complemento08", ttMov.complemento08);
            histobj.put("complemento09", ttMov.complemento09);				histobj.put("complemento10", ttMov.complemento10);
			histobj.put("nomePortador", ttMov.nomePortador);

            ttMov.complemento01 = getLimpaCamposAvancado("complemento01", ttMov.complemento01,  histobj);
            ttMov.complemento02 = getLimpaCamposAvancado("complemento02", ttMov.complemento02,  histobj);
            ttMov.complemento03 = getLimpaCamposAvancado("complemento03", ttMov.complemento03,  histobj);
            ttMov.complemento04 = getLimpaCamposAvancado("complemento04", ttMov.complemento04,  histobj);
            ttMov.complemento05 = getLimpaCamposAvancado("complemento05", ttMov.complemento05,  histobj);
            ttMov.complemento06 = getLimpaCamposAvancado("complemento06", ttMov.complemento06,  histobj);
            ttMov.complemento07 = getLimpaCamposAvancado("complemento07", ttMov.complemento07,  histobj);
            ttMov.complemento08 = getLimpaCamposAvancado("complemento09", ttMov.complemento08,  histobj);
            ttMov.complemento09 = getLimpaCamposAvancado("complemento09", ttMov.complemento09,  histobj);
            ttMov.complemento10 = getLimpaCamposAvancado("complemento10", ttMov.complemento10,  histobj);
            ttMov.nomeOrigem    = getLimpaCamposAvancado("nomeOrigem",    ttMov.nomeOrigem,     histobj);
            ttMov.documento     = getLimpaCamposAvancado("documento",     ttMov.documento,      histobj);
            ttMov.nomePortador  = getLimpaCamposAvancado("nomePortador",  ttMov.nomePortador,   histobj);

            ttMov.complemento01 = getReplaceTermosAvancado("complemento01", ttMov.complemento01,  histobj);
            ttMov.complemento02 = getReplaceTermosAvancado("complemento02", ttMov.complemento02,  histobj);
            ttMov.complemento03 = getReplaceTermosAvancado("complemento03", ttMov.complemento03,  histobj);
            ttMov.complemento04 = getReplaceTermosAvancado("complemento04", ttMov.complemento04,  histobj);
            ttMov.complemento05 = getReplaceTermosAvancado("complemento05", ttMov.complemento05,  histobj);
            ttMov.complemento06 = getReplaceTermosAvancado("complemento06", ttMov.complemento06,  histobj);
            ttMov.complemento07 = getReplaceTermosAvancado("complemento07", ttMov.complemento07,  histobj);
            ttMov.complemento08 = getReplaceTermosAvancado("complemento09", ttMov.complemento08,  histobj);
            ttMov.complemento09 = getReplaceTermosAvancado("complemento09", ttMov.complemento09,  histobj);
            ttMov.complemento10 = getReplaceTermosAvancado("complemento10", ttMov.complemento10,  histobj);
            ttMov.nomeOrigem    = getReplaceTermosAvancado("nomeOrigem",    ttMov.nomeOrigem,     histobj);
            ttMov.documento     = getReplaceTermosAvancado("documento",     ttMov.documento,      histobj);
            ttMov.nomePortador  = getReplaceTermosAvancado("nomePortador",  ttMov.nomePortador,   histobj);

            histobj.put("nomeOrigem", ttMov.nomeOrigem);					histobj.put("documento", ttMov.documento);
            histobj.put("complemento01", ttMov.complemento01);				histobj.put("complemento02", ttMov.complemento02);
            histobj.put("complemento03", ttMov.complemento03);				histobj.put("complemento04", ttMov.complemento04);
            histobj.put("complemento05", ttMov.complemento05);				histobj.put("complemento06", ttMov.complemento06);
            histobj.put("complemento07", ttMov.complemento07);				histobj.put("complemento08", ttMov.complemento08);
            histobj.put("complemento09", ttMov.complemento09);				histobj.put("complemento10", ttMov.complemento10);
            histobj.put("dataMovimento", ttMov.dataMovimento);				histobj.put("mesAnoAnterior", mesAnoAnterior);
            histobj.put("mesAno2Anterior", mesAno2Anterior);				histobj.put("mesAnoAtual", mesAnoAtual);
            histobj.put("nomePortador", ttMov.nomePortador);				histobj.put("contaMovimento", contaMovimento);
            histobj.put("contaPortador", contaPortador);	   			    histobj.put("contaDebito", "");
            histobj.put("contaCredito", "");								histobj.put("contaJuros", ttMov.contaJuros);
            histobj.put("contaDesconto", ttMov.contaDesconto);				histobj.put("contaMulta", ttMov.contaMulta);
            histobj.put("centroCusto", ttMov.centroCusto);    				histobj.put("valorDocumento", ttMov.valorDocumento);
            histobj.put("valorJuros", ttMov.valorJuros);   				    histobj.put("valorDesconto", ttMov.valorDesconto);
            histobj.put("valorMulta", ttMov.valorMulta); 				    histobj.put("codFilial", ttMov.codFilial);
            histobj.put("tipoPlanilha", ttMov.tipoPlanilha);                histobj.put("numeroAba", ttMov.abaPlanilha);
            histobj.put("nomeArquivo", ttMov.nomeArquivo.toUpperCase());

            contaMovimento = getContaMovimento(contaMovimento, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            contaPortador  = getContaPortador(contaPortador, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);

			if(roteiroCRM.optString("gravaCnpjMovimento").toUpperCase().contains("TRUE")){
				if(contaMovimento.equals("")) {
                    if(!ttMov.cpfCnpj.equals("")){
                        contaMovimento = ttMov.cpfCnpj;
                        if(roteiroCRM.optString("erpContabilidade").toUpperCase().contains("SCI UNICO") && !ttMov.cpfCnpj.equals(""))
                        contaMovimento = ttMov.cpfCnpj + "P";
                    }
                }
                else {ttMov.cpfCnpj = "";}
			}
            regraContaMovimento  = getRegraContaMovimento(contaMovimento, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);


            double valorPrincipal 	 = getValorPrincipal("", ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            if (valorPrincipal> 0 && ttMov.valorDocumento > valorPrincipal) {
                ttMov.valorJuros     = ttMov.valorDocumento - valorPrincipal;
                ttMov.valorDocumento = valorPrincipal;
            }

            ttMov.contaJuros        = getContaJuros(contaJuros,  ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            ttMov.contaDesconto     = getContaDesconto(contaDesconto,  ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            ttMov.contaMulta        = getContaMulta(contaMulta,  ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            tabelaContabil   		= getTabelaContabil("", ttMov.nomeOrigem, ttMov.documento, ttMov.nomePortador, ttMov.complemento01, ttMov.complemento02, ttMov.complemento03, ttMov.complemento04, ttMov.complemento05, ttMov.nomeArquivo);

            

            boolean regraCRM = false;
            if (!contaMovimento.equals("") && !contaMovimento.toUpperCase().contains("FISCAL")) regraCRM = true;

           //---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---~---

            if (!contaMovimento.equals("")){
			
				ttPlano ttP  = (ttPlano)mapaPlano.get(contaMovimento);
				if (ttP == null) {					
					ttP  = new ttPlano(); 
					ttP.descricaoPlano = "";
					ttP.contaAnalitica = "";


					JSONObject descricaoPlano = dbIOCont.sql("SELECT DESCRICAOPLANO, CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND CONTACONTABIL = ?")
					.fields("DESCRICAOPLANO,CONTAANALITICA")
					.param(codEmpresa)
					.param(contaMovimento)
					.queryUnique();

					if (descricaoPlano == null || !descricaoPlano.has("DESCRICAOPLANO")) {
						dbIOCont.insert("IO_PLANOCONTA")
						.fields("CODEMPRESA,CONTACONTABIL")
						.param(codEmpresa)
						.param(contaMovimento)
						.execute();
					} else {
						ttP.descricaoPlano = descricaoPlano.optString("DESCRICAOPLANO");
						ttP.contaAnalitica = descricaoPlano.optString("CONTAANALITICA");
					}		
					
					ttP.contaContabil     = contaMovimento;
 					mapaPlano.put(contaMovimento,ttP);


				}
            }

            if (contaMovimento.equals("")){
                try {
                    String classificacaoPlanoContas = ""; // padr?o por enquanto
                    // String classificacaoPlanoContas = getClassificacaoPlanoContas(histobj);
                    //	HashMap mapaPartPlano 		= new HashMap();
                    JSONObject futureObject = new JSONObject();
                    JSONObject ret = buscaContaNovo(codEmpresa, ttMov.nomeOrigem, ttMov.cpfCnpj, classificacaoPlanoContas, ttMov.tipoLancamento, logger, dbIOCont, mapaPartPlano, mapaFornecedor, futureObject);
                    // JSONObject ret = buscaConta(codEmpresa, ttMov.nomeOrigem, ttMov.cpfCnpj, ttMov.tipoLancamento, logger, dbIOCont);
                
                    if(ttMov.tipoLancamento.contains("PAGAR")) contaMovimento = ret.optString("contaDebito");
                    if(ttMov.tipoLancamento.contains("RECEBER")) contaMovimento = ret.optString("contaCredito");
                    if (contaMovimento == null || contaMovimento.trim().length() == 0) {
                        contaMovimento = "";
                    }	
				}
                catch  (Exception Ee) {continue;}
            }
			
			if(roteiroCRM.optString("erpContabilidade").contains("DEXION")){
				if (contaMovimento.equals("")) {
						JSONObject descricaoPlano = dbIOCont.sql("SELECT CONTACONTABIL FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND DESCRICAOPLANO LIKE ?")
						.fields("CONTACONTABIL")
						.param(codEmpresa)
						.param(ttMov.cpfCnpj + "%")
						.queryUnique();
						contaMovimento = descricaoPlano.optString("CONTACONTABIL").trim();
				}
			}

			if (contaPortador.equals("")) {
                try {

				
					ttFornecedor ttF  = (ttFornecedor)mapaFornecedor.get(ttMov.nomePortador+"PORT");
					if (ttF == null) {					
						ttF  = new ttFornecedor(); 

						JSONArray portadorDePara =  findPortador(dbIOCont, codEmpresa, ttMov.nomePortador);
						if (portadorDePara != null && portadorDePara.length() > 0) {
							JSONObject ret = portadorDePara.optJSONObject(0);
							contaPortador = ret.optString("CONTACONTABIL").trim();
						}

						ttF.contaMovimento = contaPortador;
						ttF.nomeOrigem     = ttMov.nomePortador + "PORT";
						mapaFornecedor.put(ttMov.nomePortador + "PORT",ttF);

						
					} else {
						contaPortador = ttF.contaMovimento;
					}
                    

                }
                catch  (Exception Ee) {}
            }

            String contaTipoFornecedor = "999333";

            boolean eFornecedor = false;
            String  razaoSocial = ttMov.nomeOrigem;
            String  razaoSocialDuplicata = ttMov.nomeOrigem;
            if (contaMovimento.toUpperCase().contains("FISCAL"))  eFornecedor = true;

            if (!contaMovimento.equals("")){			
				
				ttPlano ttP  = (ttPlano)mapaPlano.get(contaMovimento);
				if (ttP == null) {
					ttP  = new ttPlano(); 
					ttP.descricaoPlano = "";
					ttP.contaAnalitica = "";

					JSONObject descricaoPlano = dbIOCont.sql("SELECT DESCRICAOPLANO, CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND CONTACONTABIL = ?")
								.fields("DESCRICAOPLANO,CONTAANALITICA")
								.param(codEmpresa)
								.param(contaMovimento)
								.queryUnique();


					if (descricaoPlano != null && descricaoPlano.has("DESCRICAOPLANO") && descricaoPlano.has("CONTAANALITICA") ) {

						ttP.descricaoPlano = descricaoPlano.optString("DESCRICAOPLANO");
						ttP.contaAnalitica = descricaoPlano.optString("CONTAANALITICA");
						
					}
					
					ttP.contaContabil     = contaMovimento;
					mapaPlano.put(contaMovimento,ttP);
				}

				descricaoPlanoContaMovimento = ttP.descricaoPlano.replaceAll("EAMP;","&").replaceAll(";","").trim();
				if (!classificaFornec.equals("") && (ttP.contaAnalitica.replaceAll("[^0-9]*", "").trim().startsWith(classificaFornec))) {
					razaoSocial = ttP.descricaoPlano.replaceAll("EAMP;","&").replaceAll(";","").trim();
				}

				// Joga no nome do fornecedor o que esta no plano de contas
				if (!classificaPlano.equals("") && (ttP.contaAnalitica.replaceAll("[^0-9]*", "").trim().startsWith(classificaPlano))) {
					ttMov.nomeOrigem = ttP.descricaoPlano.replaceAll("EAMP;","&").replaceAll(";","").trim();
				}
				if (ttP.descricaoPlano.length() < 2 || ttP.descricaoPlano.equals("") || ttP.descricaoPlano == null) {
					eFornecedor = true;
				}		

                if (razaoSocial.length() < 4) razaoSocial = ttMov.nomeOrigem;

                if (!classificaFornec.equals("") && (ttP.contaAnalitica.replaceAll("[^0-9]*", "").trim().startsWith(classificaFornec))) {
                    eFornecedor = true;
                }  
 

            }

			if (!contaPortador.equals("")){
			
				ttPlano ttP  = (ttPlano)mapaPlano.get(contaPortador);
				if (ttP == null) {
					
					ttP  = new ttPlano(); 
					ttP.descricaoPlano = "";
					ttP.contaAnalitica = "";
					JSONObject descricaoPlano = dbIOCont.sql("SELECT DESCRICAOPLANO, CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND CONTACONTABIL = ?")
					.fields("DESCRICAOPLANO,CONTAANALITICA")
					.param(codEmpresa)
					.param(contaPortador)
					.queryUnique();

					if (descricaoPlano == null || !descricaoPlano.has("DESCRICAOPLANO")) {
						dbIOCont.insert("IO_PLANOCONTA")
						.fields("CODEMPRESA,CONTACONTABIL")
						.param(codEmpresa)
						.param(contaPortador)
						.execute();
					} else {
						ttP.descricaoPlano = descricaoPlano.optString("DESCRICAOPLANO");
						ttP.contaAnalitica = descricaoPlano.optString("CONTAANALITICA");
					}
					
					ttP.contaContabil     = contaPortador;
					mapaPlano.put(contaPortador,ttP);
				}
				descricaoPlanoContaPortador = ttP.descricaoPlano.replaceAll("EAMP;","&").replaceAll(";","").trim();
            }
            
            if(ttMov.tipoLancamento.contains("PAGAR")) {
                ttMov.contaDebito  = contaMovimento;
                ttMov.contaCredito = contaPortador;
            }
            if(ttMov.tipoLancamento.contains("RECEBER")) {
                ttMov.contaCredito  = contaMovimento;
                ttMov.contaDebito   = contaPortador;
            }
            if (ttMov.contaDebito.toUpperCase().contains("IGNORA")) {
                objetoRoteiro = getObjetoRoteiro(ttMov, objetoRoteiro, logger);
                if(ttMov.nomeArquivo.toUpperCase().contains("OTTIMIZZA")) insertIORoteiro(dbIOCont, objetoRoteiro, logger);
                mapaVariavel.put(key,ttMov);
                continue;
            }
            if (ttMov.contaCredito.toUpperCase().contains("IGNORA")) {
                objetoRoteiro = getObjetoRoteiro(ttMov, objetoRoteiro, logger);
                if(ttMov.nomeArquivo.toUpperCase().contains("OTTIMIZZA")) insertIORoteiro(dbIOCont, objetoRoteiro, logger);
                mapaVariavel.put(key,ttMov);
                continue;
            }
            String parcelaAtualeFinal = "";
            String parcelaAtual       = "";

            int parcelaBase = getParcelaBase(contaMovimento, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            int totalParcelas = getTotalParcelas(contaMovimento, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            String mesAnoBase = getMesAnoBase(contaMovimento, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);



            if (!mesAnoBase.equals("") && parcelaBase > 0) parcelaAtual       = String.valueOf(getParcelaFinanciamento(mesAnoAtual, mesAnoBase,parcelaBase, totalParcelas));
            if (!mesAnoBase.equals("")) parcelaAtualeFinal = parcelaAtual.trim() + "/" + String.valueOf(totalParcelas).trim();

            ttMov.historico = getHistorico(contaMovimento, ttMov.historico, ttMov.tipoLancamento, ttMov.nomeOrigem,
                                           ttMov.documento, ttMov.nomePortador, ttMov.complemento01, ttMov.complemento02,
                                           ttMov.complemento03, ttMov.nomeArquivo, ttMov.centroCusto);
			
			
			
            histobj.put("contaMovimento", contaMovimento);
            histobj.put("contaPortador", contaPortador);
            histobj.put("contaDebito", ttMov.contaDebito);
            histobj.put("contaCredito", ttMov.contaCredito);
            histobj.put("contaJuros", ttMov.contaJuros);
			histobj.put("contaMulta", ttMov.contaMulta);
            histobj.put("contaDesconto", ttMov.contaDesconto);
            histobj.put("parcelaAtual", parcelaAtual);
            histobj.put("parcelaAtualeFinal", parcelaAtualeFinal);
            histobj.put("trimestreMesAnoAnterior", trimestreMesAnoAnterior);
            histobj.put("trimestreMesAnoAtual", trimestreMesAnoAtual);
            histobj.put("descricaoPlanoMovimento", descricaoPlanoContaMovimento.toUpperCase());
            histobj.put("descricaoPlanoPortador", descricaoPlanoContaPortador.toUpperCase());

            if(roteiroCRM.optString("Realizar_Busca_Plano").equals("TRUE")){

				// #Fabrica(2019-08-27) @Vini
				JSONObject fornecFilial = new JSONObject();
				String cAnalitica = "";
				String auxNomeOrig = "";
				auxNomeOrig = ttMov.nomeOrigem.replaceAll("-","").replaceAll("/","").replaceAll("\\.","").replaceAll("[0-9]*", "").replaceAll("\\s+","").replaceAll("ME","").replaceAll("EPP","").replaceAll("LTDA","").replaceAll("EIRELI","").replaceAll("SA","").trim();
				if (auxNomeOrig.length()> 11) auxNomeOrig = cutString(auxNomeOrig,0,10);
				//pesquisa no banco de dados pela descricao continua para pegar a classifica??o usada na nova regra
				fornecFilial = dbIOCont.sql("SELECT CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND DESCRICAOCONTINUA LIKE ?")
				.fields("CONTAANALITICA")
				.param(codEmpresa)
				.param(auxNomeOrig+"%")
				.queryUnique();
				cAnalitica = fornecFilial.optString("CONTAANALITICA").replaceAll("[^0-9]*", "").trim();                
				histobj.put("classificacao", cAnalitica); // classificacao para criacao de regra
			}

            ttMov.historico = getHistoricoRegra(contaMovimento, ttMov.historico, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
            regraHistorico = getRegraHistoricoRegra(contaMovimento, ttMov.historico, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
						
            if (!ttMov.historicoJuros.contains("JUROS")) ttMov.historicoJuros = "JUROS REF. " + ttMov.documento + " " + ttMov.nomeOrigem;
            ttMov.historicoJuros = getHistorico(ttMov.contaJuros, ttMov.historicoJuros, ttMov.tipoLancamento, ttMov.nomeOrigem,
                                                ttMov.documento, ttMov.nomePortador, ttMov.complemento01, ttMov.complemento02,
                                                ttMov.complemento03, ttMov.nomeArquivo, ttMov.centroCusto);
            ttMov.historicoJuros = getHistoricoJuros(ttMov.contaJuros, ttMov.historicoJuros, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);

            if (!ttMov.historicoDesconto.contains("DESCONTO")) ttMov.historicoDesconto = "DESCONTO REF. " + ttMov.documento + " " + ttMov.nomeOrigem;
            ttMov.historicoDesconto = getHistorico(ttMov.contaDesconto, ttMov.historicoDesconto, ttMov.tipoLancamento, ttMov.nomeOrigem,
                                                   ttMov.documento, ttMov.nomePortador, ttMov.complemento01, ttMov.complemento02,
                                                   ttMov.complemento03, ttMov.nomeArquivo, ttMov.centroCusto);
            ttMov.historicoDesconto = getHistoricoDesconto(ttMov.contaDesconto, ttMov.historicoDesconto, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);

            if (ttMov.historicoMulta.equals("")) ttMov.historicoMulta = "MULTA REF. " + ttMov.documento + " " + ttMov.nomeOrigem;
            ttMov.historicoMulta = getHistorico(ttMov.contaMulta, ttMov.historicoMulta, ttMov.tipoLancamento, ttMov.nomeOrigem,
                                                ttMov.documento, ttMov.nomePortador, ttMov.complemento01, ttMov.complemento02,
                                                ttMov.complemento03, ttMov.nomeArquivo, ttMov.centroCusto);
            ttMov.historicoMulta = getHistoricoMulta(ttMov.contaMulta, ttMov.historicoMulta, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);

            ttMov.codFilial   = getFilial("", ttMov.nomeOrigem, ttMov.documento, ttMov.nomePortador,
                                          ttMov.complemento01, ttMov.complemento02, ttMov.complemento03,
                                          ttMov.nomeArquivo, ttMov.centroCusto, ttMov.codFilial);

            if (!ttMov.codFilial.equals("")) {
                ttMov.historico 		= ttMov.historico 			 + " Filial:" + ttMov.codFilial;
                ttMov.historicoJuros 	= ttMov.historicoJuros		 + " Filial:" + ttMov.codFilial;
                ttMov.historicoDesconto = ttMov.historicoDesconto 	 + " Filial:" + ttMov.codFilial;
                ttMov.historicoMulta 	= ttMov.historicoMulta		 + " Filial:" + ttMov.codFilial;
            }
            String codParticipante   = getParticipante("", ttMov.nomeOrigem, ttMov.documento, ttMov.nomePortador, 
														ttMov.complemento01, ttMov.complemento02, ttMov.complemento03, 
														ttMov.complemento04, ttMov.complemento05, ttMov.nomeArquivo);
                        
            if (!codParticipante.equals("")) {
                ttMov.historico 		= ttMov.historico			 + " Participante:" + codParticipante;
                ttMov.historicoJuros 	= ttMov.historicoJuros		 + " Participante:" + codParticipante;
                ttMov.historicoDesconto = ttMov.historicoDesconto 	 + " Participante:" + codParticipante;
                ttMov.historicoMulta 	= ttMov.historicoMulta		 + " Participante:" + codParticipante;
            }

            ttMov.historico 		= ttMov.historico.replaceAll(",","\\.").replaceAll(";","").replaceAll("_ ","").replaceAll(" _","").replaceAll("_","").replaceAll("  "," ").trim();
            ttMov.historicoJuros 	= ttMov.historicoJuros.replaceAll(",","\\.").replaceAll(";","").replaceAll("_ ","").replaceAll(" _","").replaceAll("_","").replaceAll("  "," ").trim();
            ttMov.historicoDesconto = ttMov.historicoDesconto.replaceAll(",","\\.").replaceAll(";","").replaceAll("_ ","").replaceAll(" _","").replaceAll("_","").replaceAll("  "," ").trim();
            ttMov.historicoMulta 	= ttMov.historicoMulta.replaceAll(",","\\.").replaceAll(";","").replaceAll("_ ","").replaceAll(" _","").replaceAll("_","").replaceAll("  "," ").trim();
									
            if(roteiroCRMPrincipal.optString("erpContabilidade").equals("JBSOFTWARE")){
                ttMov.historico += "GPLCTO:" + ttMov.contLinha;
                ttMov.historicoJuros += "GPLCTO:" + ttMov.contLinha;
                ttMov.historicoDesconto += "GPLCTO:" + ttMov.contLinha;
                ttMov.historicoMulta += "GPLCTO:" + ttMov.contLinha;
            }

            // ------------------------------------------------
            //           GERA ARQUIVO PARA O FISCAL
            // ------------------------------------------------
            ttMov.documento = ttMov.documento.trim();
            if (ttMov.documento.startsWith("0")) {
                for (int xx=0;xx<10;xx++) {
                    if (ttMov.documento.length() > 1 && ttMov.documento.startsWith("0")) ttMov.documento = ttMov.documento.substring(1);
                }
            }

            JSONObject jDescricaoDupl = new JSONObject();
            if (eFornecedor)   jDescricaoDupl.put("TIPO","FORNECEDOR");

            if(integraFiscal.contains("TRUE") && ttMov.tipoPlanilha.contains("MOVIMENTO") && !razaoSocial.equals("") && !ttMov.documento.equals("") && !regraCRM && !contaMovimento.equals("")){

				apagaStatus = true;

                

				

                if (eFornecedor) {

					dupliNaoEncontContabil	= Boolean.parseBoolean(roteiroCRM.optString("dupliNaoEncontContabil").toLowerCase().trim());
					contaTemp				= roteiroCRMPrincipal.optString("Conta_Dupl_Contabil");


					if(dupliNaoEncontContabil){
						contaMovimento = contaTemp;
						if(ttMov.tipoLancamento.contains("PAGAR"))	ttMov.contaDebito = contaTemp;
						if(ttMov.tipoLancamento.contains("RECEBER"))ttMov.contaCredito = contaTemp;

						histobj.put("contaMovimento", contaMovimento);
						ttMov.historico = getHistoricoRegra(contaMovimento, ttMov.historico, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);


					}else{
						if(jDescricaoDupl.has("TIPO") && jDescricaoDupl.optString("TIPO").equals("FORNECEDOR")) {
							if(cabecalhoNaoEncontrada){
								txtFornecedor.append("Codigo");
								txtFornecedor.append(";");
								txtFornecedor.append("Fornecedor/Cliente");
								txtFornecedor.append(";");
								txtFornecedor.append("Duplicata");
								txtFornecedor.append(";");
								txtFornecedor.append("Data");
								txtFornecedor.append(";");
								txtFornecedor.append("Valor bruto");
								txtFornecedor.append(";");
								txtFornecedor.append("Valor liquido");
								txtFornecedor.append(";");
								txtFornecedor.append("Banco");
								txtFornecedor.append(";");
								txtFornecedor.append("Obs:");
								txtFornecedor.append("\r\n");
								cabecalhoNaoEncontrada = false;
							}
							String valorFinal = String.format("%.2f", ttMov.valorDocumento);
							String valorLiquido = String.format("%.2f", ttMov.valorDocumento + ttMov.valorJuros - ttMov.valorDesconto + ttMov.valorMulta);
							
							
							jDescricaoDupl.put("NOMEORIGEM",     ttMov.nomeOrigem);
							jDescricaoDupl.put("DOCUMENTO",      ttMov.documento);
							jDescricaoDupl.put("DATAMOVIMENTO",  ttMov.dataMovimento);
							jDescricaoDupl.put("VALORFINAL",  valorFinal);
							jDescricaoDupl.put("VALORLIQUIDO",  valorLiquido);
							
							txtFornecedor.append(jDescricaoDupl.optString("CODEMPRESA"));
							txtFornecedor.append(";");
							txtFornecedor.append(jDescricaoDupl.optString("NOMEORIGEM"));
							txtFornecedor.append(";");
							txtFornecedor.append(jDescricaoDupl.optString("DOCUMENTO"));
							txtFornecedor.append(";");
							txtFornecedor.append(jDescricaoDupl.optString("DATAMOVIMENTO"));
							txtFornecedor.append(";");
							txtFornecedor.append(jDescricaoDupl.optString("VALORFINAL").replaceAll("\\.",","));
							txtFornecedor.append(";");
							txtFornecedor.append(jDescricaoDupl.optString("VALORLIQUIDO").replaceAll("\\.",","));
							txtFornecedor.append(";");
							txtFornecedor.append(ttMov.nomePortador);
							txtFornecedor.append(";");
							txtFornecedor.append("Duplicata nao encontrada no Fiscal ");
							txtFornecedor.append("\r\n");


							geraFiscal = true;
							loteFiscal = nomeEmpresa + "_" + codEmpresa + "_" + "_PELO_FISCAL_" + dataLote + "_" + ttMov.tipoLancamento;
							ttMov.tipoPlanilha = "NAO LER";
							mapaVariavel.put(key,ttMov);
							continue;
							
						}
					}
                }
            }
			boolean ctFiscal = false;
			if(ttMov.tipoLancamento.contains("PAGAR")	&& ttMov.contaDebito.toUpperCase().contains("FISCAL")) ctFiscal = true;
			if(ttMov.tipoLancamento.contains("RECEBER") && ttMov.contaCredito.toUpperCase().contains("FISCAL")) ctFiscal = true;

			dupliNaoEncontContabil	= Boolean.parseBoolean(roteiroCRM.optString("dupliNaoEncontContabil").toLowerCase().trim());
			contaTemp				= roteiroCRMPrincipal.optString("Conta_Dupl_Contabil");

			if(contaMovimento.toUpperCase().contains("FISCAL") || ctFiscal) {
				contaMovimento = contaTemp;
				if(ttMov.tipoLancamento.contains("PAGAR"))	ttMov.contaDebito = contaTemp;
				if(ttMov.tipoLancamento.contains("RECEBER"))ttMov.contaCredito = contaTemp;

				histobj.put("contaMovimento", contaMovimento);
				ttMov.historico = getHistoricoRegra(contaMovimento, ttMov.historico, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
			}

			if (!contaMovimento.equals("")){
			
				ttPlano ttP  = (ttPlano)mapaPlano.get(contaMovimento);
				if (ttP == null) {
					
					ttP  = new ttPlano(); 
					ttP.descricaoPlano = "";
					ttP.contaAnalitica = "";
					
					JSONObject descricaoPlano = dbIOCont.sql("SELECT DESCRICAOPLANO,CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND CONTACONTABIL = ?")
					.fields("DESCRICAOPLANO,CONTAANALITICA")
					.param(codEmpresa)
					.param(contaMovimento)
					.queryUnique();

					if (descricaoPlano == null || !descricaoPlano.has("DESCRICAOPLANO")) {
						dbIOCont.insert("IO_PLANOCONTA")
						.fields("CODEMPRESA,CONTACONTABIL")
						.param(codEmpresa)
						.param(contaMovimento)
						.execute();
					} else {
						ttP.descricaoPlano = descricaoPlano.optString("DESCRICAOPLANO");
						ttP.contaAnalitica = descricaoPlano.optString("CONTAANALITICA");
					}					
					ttP.contaContabil     = contaMovimento;
					mapaPlano.put(contaMovimento,ttP);


				}
            }
             //Tratamento para inverter conta em lencamento simples feito para JBSOFTWARE
            if (roteiroCRM.optString("erpContabilidade").contains("JBSOFTWARE")){
				if(ttMov.contaDebito.contains("INVERTE") && !ttMov.contaCredito.contains("INVERTE")) ttMov.contaCredito = ttMov.contaCredito+ "INVERTE";
				if(!ttMov.contaDebito.contains("INVERTE") && ttMov.contaCredito.contains("INVERTE")) ttMov.contaDebito = ttMov.contaDebito+ "INVERTE";
			}

            chave = ttMov.chave;
			//chave = getRegrasParaAcumular(ttMov.lote, ttMov.chave, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
			String testeChave = getRegrasParaAcumular(ttMov.lote, ttMov.chave, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj).replaceAll("[^0-9a-zA-Z]*", "");
			if(!testeChave.toUpperCase().contains("ACUMULAANTES") && !testeChave.toUpperCase().contains("ACUMULARANTES")) chave = testeChave;
			
			if(chave.length() > 180) chave = cutString(chave, 0, 179);
			
            chave = chave.replaceAll("[^0-9a-zA-Z]*", "") + "-CTB";
            ttMov.chave = ttMov.chave.replaceAll("[^0-9a-zA-Z]*", "") + "-CTB";

			apagaStatus = true;
            String keyAc = chave;

            ttMovimentoPadrao ttMov3       = (ttMovimentoPadrao)mapaOficial.get(keyAc);
            if (ttMov3  == null) {
                ttMov3                = new ttMovimentoPadrao(ttMov);
                ttMov3.valorDesconto   = 0;
                ttMov3.valorJuros      = 0;
                ttMov3.valorDocumento  = 0;
                ttMov3.valorMulta      = 0;
                ttMov3.documento       = "";
            }
            if (ttMov3.documento.equals("")) {
                ttMov3.documento         = ttMov.documento;
            } else ttMov3.documento = ttMov3.documento + ", " + ttMov.documento;

            ttMov3.valorDesconto     = ttMov3.valorDesconto   + ttMov.valorDesconto;
            ttMov3.valorDocumento    = ttMov3.valorDocumento  + ttMov.valorDocumento;
            ttMov3.valorMulta        = ttMov3.valorMulta      + ttMov.valorMulta;
            ttMov3.valorJuros        = ttMov3.valorJuros      + ttMov.valorJuros;
            ttMov3.chave = chave;

            if (!ttMov.chave.equals(chave)) ttMov3.contador = 3;

			// for?a lancamento aberto no FB software
			if (roteiroCRM.optString("erpContabilidade").contains("JBSOFTWARE")) ttMov3.contador = 3;

            mapaVariavel.put(key,ttMov);
            mapaOficial.put(keyAc,ttMov3);
			
			ttLote ttLot    = (ttLote)mapaLote.get(ttMov.lote);
            if (ttLot       == null) {
                ttLot       = new ttLote();
                ttLot.lote  = ttMov.lote;
            }
            mapaLote.put(ttMov.lote,ttLot);

            if(ttMov.tipoPlanilha.contains("EXTRATO") || ttMov.tipoPlanilha.contains("CARTAO")){
                if(roteiroCRMPrincipal.optString("Forcar_Partida_Simples").equals("TRUE")) ttMov3.contador = 3;
            }else if(roteiroCRM.optString("Forcar_Partida_Simples").equals("TRUE")) ttMov3.contador = 3;

            if  ((ttMov.valorJuros > 0 || ttMov.valorDesconto > 0 || ttMov.valorMulta > 0 || ttMov3.contador == 3) && !ttMov.tipoPlanilha.equals("NAO LER")) {
                chave = chave.replaceAll("CTB","CTBPORT");
                key = chave;
                ttMovimentoPadrao ttMov2       = (ttMovimentoPadrao)mapaOficial.get(key);
                if (ttMov2  == null) {
                    ttMov2                = new ttMovimentoPadrao(ttMov);
                    ttMov2.contador        = 0;
                    ttMov2.valorDesconto   = 0;
                    ttMov2.valorJuros      = 0;
                    ttMov2.valorDocumento  = 0;
                    ttMov2.valorMulta      = 0;
                }
                ttMov2.tipoMovimento     = "CTBPORT";
                ttMov2.valorDesconto     = ttMov2.valorDesconto   + ttMov.valorDesconto;
                ttMov2.valorMulta        = ttMov2.valorMulta      + ttMov.valorMulta;
                ttMov2.valorJuros        = ttMov2.valorJuros      + ttMov.valorJuros;
                ttMov2.chave             = chave;
                ttMov2.chaveExtrato      = "";
                ttMov2.documento         = ttMov3.documento;
                ttMov2.classificacao     = ttMov.classificacao;
                ttMov2.valorDocumento    = ttMov2.valorDocumento + ttMov.valorDocumento + ttMov.valorJuros - ttMov.valorDesconto + ttMov.valorMulta;
                ttMov2.contador          = ttMov2.contador + ttMov3.contador;
                if(tipoLancamento.contains("PAGAR")){
                    ttMov2.naturezaContabil  = "C";
                    ttMov2.contaDebito       = "";
                    ttMov2.contaCredito      = ttMov.contaCredito;
                }
                if(tipoLancamento.contains("RECEBER")){
                    ttMov2.naturezaContabil  = "D";
                    ttMov2.contaDebito       = ttMov.contaDebito;
                    ttMov2.contaCredito      = "";
                }
                ttMov2.historico = getHistoricoPortador(contaPortador, ttMov2.historico, ttMov2.tipoLancamento, ttMov2.documento, ttMov2.nomeOrigem, histobj);
                String tratarDiv = getTratarComoDiv(ttMov2.documento, ttMov2.nomeOrigem, histobj);
                if(!tratarDiv.equals("")){
                    String filial = cutString(tratarDiv, "-").replaceAll("[^0-9]", "");
                    if(tratarDiv.contains("FORNECEDOR"))    ttMov3.historico = cutString(ttMov3.historico,0,"Filial:") + "Filial:"+filial;
                    if(tratarDiv.contains("JUROS"))         ttMov3.historicoJuros = cutString(ttMov3.historico,0,"Filial:") + "Filial:"+filial;
                    if(tratarDiv.contains("MULTA"))         ttMov3.historicoMulta = cutString(ttMov3.historico,0,"Filial:") + "Filial:"+filial;
                    if(tratarDiv.contains("PORTADOR"))      ttMov2.historico = cutString(ttMov2.historico,0,"Filial:") + "Filial:"+filial;
                    if(tratarDiv.contains("DESCONTO"))      ttMov2.historicoDesconto = cutString(ttMov2.historico,0,"Filial:") + "Filial:"+filial;
                }

                mapaOficial.put(key,ttMov2);
				ttMov3.classificacao = ttMov2.classificacao;
				mapaOficial.put(keyAc,ttMov3);
            }
        }


        //-------------------------------------------------------------------------
        // GERA OS ARQUICOS PARA BAIXA DE DUPLICATAS -- FISCAL
        //-------------------------------------------------------------------------
        if (geraFiscal) {

            String auxExtencao = ".txt";
            if(roteiroCRMPrincipal.optString("erpContabilidade").toUpperCase().contains("CORDILHEIRA")) auxExtencao = ".csv";
            String filename = RouteEngine.INOUT_HOME + "/Contabil/" + roteiroCRMPrincipal.optString("contabilidade") + "/Arquivos/" + loteFiscal + auxExtencao;
            FileWriter writer = new FileWriter(filename);
            writer.writeNewFile(txtFiscal.toString());

            loteFiscal = loteFiscal.replaceAll("_PELO_FISCAL","_DUPLICATAS_NAO_ENCONTRADAS");

            filename = RouteEngine.INOUT_HOME + "/Contabil/" + roteiroCRMPrincipal.optString("contabilidade") + "/Arquivos/" + loteFiscal + ".csv";
            writer = new FileWriter(filename);
            writer.writeNewFile(txtFornecedor.toString());
        }


        //-------------------------------------------------------------------------
        //--- DESABILITAR AQUI SOMENTE SE O BANCO DE DADOS CONTIVER TABELA IO_RAZAO
        //-------------------------------------------------------------------------


        StringBuilder ResumoTxt = new StringBuilder();
        String rn = "\r\n";
        ResumoTxt = new StringBuilder();
        ResumoTxt.append("");
        ResumoTxt.append(rn);

        ResumoTxt.append("STATUS;");
        ResumoTxt.append("DATA;TIPO DATA;");
        ResumoTxt.append("VALOR;");
        ResumoTxt.append("DOCUMENTO;");
        ResumoTxt.append("CLIENTE/FORNECEDOR;");
        ResumoTxt.append("PORTADOR;");
        ResumoTxt.append("COMPLEMENTO01;");
        ResumoTxt.append("COMPLEMENTO02;");
        ResumoTxt.append("COMPLEMENTO03;");
        ResumoTxt.append("COMPLEMENTO04;");
        ResumoTxt.append("COMPLEMENTO05;");
        ResumoTxt.append("COMPLEMENTO06;;CTA DEBITO ENCONTRADA;CTA CREDITO ENCONTRADA;REGRA CONTA CRM;HISTORICO;REGRA HISTORICO;;");
        ResumoTxt.append("DATA;");
        ResumoTxt.append("DEBITO;");
        ResumoTxt.append("CLASS DEB;");
        ResumoTxt.append("NOME CONTA;");
        ResumoTxt.append("CREDITO;");
        ResumoTxt.append("CLASS CRED;");
        ResumoTxt.append("NOME CONTA;");
        ResumoTxt.append("VALOR;");
        ResumoTxt.append("HISTORICO;");
        ResumoTxt.append("ORIGEM");

        StringBuilder txtDePara = new StringBuilder();

        txtDePara.append("DATA;VALOR;FORNECEDOR/CLIENTE;PORTADOR;CONTA DEBITO;CONTACREDITO;DOCUMENTO;COMPLEMENTO01;COMPLEMENTO02;COMPLEMENTO03;COMPLEMENTO04;COMPLEMENTO05;C.CUSTO;ARQUIVO");
        txtDePara.append("\r\n");

        mapaVariavel		= new HashMap();

		if (apagaStatus) {
			jStatus = new JSONObject();
			putStatus(dirName, "", jStatus, logger);
		}
		
		// =======================================================================================
        // * elimina da tabela IO_MOVIMENTO os movimentos deste LOTE para evitar sujeira na base
        // =======================================================================================
           
		
		Iterator itLote = mapaLote.keySet().iterator();
        while (itLote.hasNext()) {

            String key = (String)itLote.next();
            ttLote ttLot = (ttLote)mapaLote.get(key);
             lote = ttLot.lote;

            try {
                if (dbIOCont != null) {
                    dbIOCont.closeConnection();
                    dbIOCont = null;
                }
                if (dbIOCont == null) {
                    dbIOCont = connectIOContabil(props, logger);
                }
                dbIOCont.delete("IO_MOVIMENTO")
                .where("LOTE=?")
                .param(lote)
                .execute();
            } catch (Exception eDel) {
                logger.logError("EndpointB: ERROR DELETE IO_MOVIMENTO", eDel);
            }
		}

        contRegra = -1;
        Iterator it = mapaOficial.keySet().iterator();
        while (it.hasNext()) {
            String chaveExtrato     = "";

            String key = (String)it.next();
            ttMovimentoPadrao ttMov = new ttMovimentoPadrao();
            try {
                ttMov = (ttMovimentoPadrao)mapaOficial.get(key);
            }
            catch (Exception xx) { continue;}

            if (ttMov.tipoPlanilha.equals("NAO LER")) continue;


            if (ttMov.tipoPlanilha.contains("EXTRATO")) {
                if(tipoLancamento.contains("PAGAR") && ttMov.debitoCredito.equals("EXTRATO-CREDITO")) continue;
                if(tipoLancamento.contains("RECEBER") && ttMov.debitoCredito.equals("EXTRATO-DEBITO"))  continue;

            }
            if (ttMov.contaDebito.toUpperCase().contains("IGNORA")) continue;
            if (ttMov.contaCredito.toUpperCase().contains("IGNORA")) continue;

            ttMov.nomeOrigem = ttMov.nomeOrigem.replaceAll("EAMP;","&").replaceAll(";","").trim();

            contRegra++;
            int restoLinha = 0;
            restoLinha = (contRegra % 100);
            if (restoLinha == 0) putStatus(dirName, "04--Etapa 4 de 4 - " + String.valueOf(contRegra) + "--" + tipoLancamento + ".status", jStatus, logger);

            if(tipoLancamento.contains("PAGAR")){
                ttMov.naturezaContabil = "D";
                if(ttMov.tipoMovimento.contains("CTBPORT") || ttMov.tipoMovimento.contains("CTBDES")) ttMov.naturezaContabil = "C";
            }
            if(tipoLancamento.contains("RECEBER")){
                ttMov.naturezaContabil = "C";
                if(ttMov.tipoMovimento.contains("CTBPORT") || ttMov.tipoMovimento.contains("CTBDES")) ttMov.naturezaContabil = "D";
            }

            JSONObject extratoEmpresa = new JSONObject();


            // CASO A LINHA DO EXTATO JA TENHA SIDO LIDA PELA PLANILHA DE PAGAMENTOS, DEVE SER IGNORADA
            if (ttMov.tipoPlanilha.contains("EXTRATO")) {
                chaveExtrato = ttMov.chaveExtrato;

                extratoEmpresa = dbIOCont.sql("SELECT CHAVE,CODEMPRESA, DATAMOVIMENTO, PORTADOR, HISTORICO, LOTE, COMPLEMENTO, VALORDOCUMENTO, DEBITOCREDITO, EXTRATOLIDO FROM IO_EXTRATO WHERE CHAVE LIKE ? ")
                .fields("CHAVE,CODEMPRESA, DATAMOVIMENTO, PORTADOR, HISTORICO, LOTE, COMPLEMENTO, VALORDOCUMENTO, DEBITOCREDITO, EXTRATOLIDO")
                .param(chaveExtrato + "%")
                .queryUnique();

                if (extratoEmpresa != null && extratoEmpresa.length() > 0) {
                    if (extratoEmpresa.has("EXTRATOLIDO")) {

                        double extratoLido = extratoEmpresa.optDouble("EXTRATOLIDO");

                        if (extratoLido == 1) continue;

                        dbIOCont.update("IO_EXTRATO")
                        .fields("EXTRATOLIDO")
                        .where("CHAVE = ? ")
                        .param(1)
                        .param(chaveExtrato)
                        .execute();

                    }
                }

            }


            // -----------------------------------------------------------------------------------------------------------
            // COMPARA COM RAZAO APENAS QUANDO O NOME DO ARQUIVO CONTIVER OTTIMIZZA, ASSIM FICA MAIS RAPIDA A INTEGRACAO
            // QUANDO O CLIENTE FINAL ESTIVER RODANDO.
            // -----------------------------------------------------------------------------------------------------------

            if (!ttMov.tipoMovimento.equals("CTBPORT") && ttMov.nomeArquivo.toUpperCase().contains("OTTIMIZZA")) {

                String tipoData = "MOVIMENTO";

                comparaRazao = true;


                Date dataMovimentoDate = DateUtil.stringToDate(ttMov.dataMovimento, "dd/MM/yyyy");
                Date dataMovimentoDateMenosUm= new Date();
                Date dataMovimentoDateMenosDois= new Date();
                Date dataMovimentoDateMenosTres= new Date();
                Date dataMovimentoDateMaisUm= new Date();
                Date dataMovimentoDateMaisDois= new Date();
                Date dataMovimentoDateMaisTres= new Date();

                Calendar cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, -1); dataMovimentoDateMenosUm = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, -2); dataMovimentoDateMenosDois = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, -3); dataMovimentoDateMenosTres = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, +1); dataMovimentoDateMaisUm = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, +2); dataMovimentoDateMaisDois = cal.getTime();
                cal = Calendar.getInstance(); cal = DateUtil.dateToCalendar(dataMovimentoDate); cal.add (Calendar.DATE, +3); dataMovimentoDateMaisTres = cal.getTime();

                if (ttMov.valorDocumento == 0) continue;

                String valorFinal = String.format("%.2f", ttMov.valorDocumento);
                valorFinal = valorFinal.replaceAll("\\.",",");

                JSONArray registro = new JSONArray();

                for (int xx = 0;xx<5;xx++) {
                    try {
                        Date dataLeitura = DateUtil.stringToDate(ttMov.dataMovimento, "dd/MM/yyyy");
                        if (xx ==1) {dataLeitura = dataMovimentoDateMaisUm; tipoData = "D+1";}
                        if (xx ==2) {dataLeitura = dataMovimentoDateMenosUm; tipoData = "D-1";}
                        if (xx ==3) {dataLeitura = dataMovimentoDateMaisDois; tipoData = "D+2";}
                        if (xx ==4) {dataLeitura = dataMovimentoDateMenosDois; tipoData = "D-2";}

                        registro = dbIOCont.sql("SELECT CONTADEBITO,CONTACREDITO,HISTORICO FROM IO_RAZAO WHERE CODEMPRESA = ? AND DATAMOVIMENTO = ? AND VALORDOCUMENTO = ?")
                        .fields("CONTADEBITO,CONTACREDITO,HISTORICO")
                        .param(codEmpresa)
                        .param(dataLeitura)
                        .param(ttMov.valorDocumento)
                        .query();

                        if (registro != null && registro.length() > 0) break;
                    }
                    catch (Exception xx) {
                        break;
                    }
                }



                JSONObject histobj = new JSONObject();
                ttMov.complemento01 = getReplaceTermos("complemento01", ttMov.complemento01, histobj);
                ttMov.complemento02 = getReplaceTermos("complemento02", ttMov.complemento02, histobj);
                ttMov.complemento03 = getReplaceTermos("complemento03", ttMov.complemento03, histobj);
                ttMov.complemento04 = getReplaceTermos("complemento04", ttMov.complemento04, histobj);
                ttMov.complemento05 = getReplaceTermos("complemento05", ttMov.complemento05, histobj);
                ttMov.complemento06 = getReplaceTermos("complemento06", ttMov.complemento06, histobj);
                ttMov.complemento07 = getReplaceTermos("complemento07", ttMov.complemento07, histobj);
                ttMov.complemento08 = getReplaceTermos("complemento09", ttMov.complemento08, histobj);
                ttMov.complemento09 = getReplaceTermos("complemento09", ttMov.complemento09, histobj);
                ttMov.complemento10 = getReplaceTermos("complemento10", ttMov.complemento10, histobj);
                ttMov.nomeOrigem = getReplaceTermos("nomeOrigem", ttMov.nomeOrigem, histobj);
                ttMov.documento = getReplaceTermos("documento", ttMov.documento, histobj);
                ttMov.nomePortador = getReplaceTermos("nomePortador", ttMov.nomePortador, histobj);

                histobj.put("nomeOrigem", ttMov.nomeOrigem); histobj.put("documento", ttMov.documento);
                histobj.put("complemento01", ttMov.complemento01); histobj.put("complemento02", ttMov.complemento02);
                histobj.put("complemento03", ttMov.complemento03); histobj.put("complemento04", ttMov.complemento04);
                histobj.put("complemento05", ttMov.complemento05); histobj.put("complemento06", ttMov.complemento06);
                histobj.put("complemento07", ttMov.complemento07); histobj.put("complemento08", ttMov.complemento08);
                histobj.put("complemento09", ttMov.complemento09); histobj.put("complemento10", ttMov.complemento10);
                histobj.put("dataMovimento", ttMov.dataMovimento); histobj.put("mesAnoAnterior", mesAnoAnterior);
                histobj.put("mesAno2Anterior", mesAno2Anterior); histobj.put("mesAnoAtual", mesAnoAtual);
                histobj.put("nomePortador", ttMov.nomePortador); histobj.put("contaMovimento", contaMovimento);
                histobj.put("contaPortador", contaPortador); histobj.put("contaDebito", "");
                histobj.put("contaCredito", ""); histobj.put("contaJuros", ttMov.contaJuros);
                histobj.put("contaDesconto", ttMov.contaDesconto); histobj.put("contaMulta", ttMov.contaMulta);
                histobj.put("centroCusto", ttMov.centroCusto); histobj.put("valorDocumento", ttMov.valorDocumento);
                histobj.put("valorJuros", ttMov.valorJuros); histobj.put("valorDesconto", ttMov.valorDesconto);
                histobj.put("valorMulta", ttMov.valorMulta); histobj.put("codFilial", ttMov.codFilial);
                histobj.put("tipoPlanilha", ttMov.tipoPlanilha); histobj.put("numeroAba", ttMov.abaPlanilha);

                String contaPrincipal = "";
                String contraSecundaria = "";

                if (tipoLancamento.contains("PAGAR")) {
                    contaPrincipal = ttMov.contaDebito;
                    contraSecundaria = ttMov.contaCredito;

                }
                if (tipoLancamento.contains("RECEBER")) {
                    contaPrincipal = ttMov.contaCredito;
                    contraSecundaria = ttMov.contaDebito;
                }

                regraContaMovimento = getRegraContaMovimento(contaPrincipal, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);
                regraHistorico = getRegraHistoricoRegra(contaPrincipal, ttMov.historico, ttMov.tipoLancamento, ttMov.documento, ttMov.nomeOrigem, histobj);

                if (registro != null && registro.length() > 0) {
                    for (int t=0; t<registro.length(); t++) {

                        JSONObject recMov = registro.optJSONObject(t);
                        String contaDebitoRazao = recMov.optString("CONTADEBITO");
                        String contaCreditoRazao = recMov.optString("CONTACREDITO");
                        String historicoRazao = recMov.optString("HISTORICO");

                        String descricaoCredito = "";
                        String descricaoDebito = "";
                        String classificacaoDebito = "";
                        String classificacaoCredito = "";

                        JSONObject descricaoPlano = dbIOCont.sql("SELECT DESCRICAOPLANO, CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND CONTACONTABIL = ?")
                        .fields("DESCRICAOPLANO,CONTAANALITICA")
                        .param(codEmpresa)
                        .param(contaDebitoRazao)
                        .queryUnique();

                        if (descricaoPlano != null && descricaoPlano.has("DESCRICAOPLANO")) {
                            descricaoDebito = descricaoPlano.optString("DESCRICAOPLANO");
                        }
                        if (descricaoPlano != null && descricaoPlano.has("CONTAANALITICA")) {
                            classificacaoDebito = descricaoPlano.optString("CONTAANALITICA");
                        }

                        descricaoPlano = dbIOCont.sql("SELECT DESCRICAOPLANO, CONTAANALITICA FROM IO_PLANOCONTA WHERE CODEMPRESA = ? AND CONTACONTABIL = ?")
                        .fields("DESCRICAOPLANO,CONTAANALITICA")
                        .param(codEmpresa)
                        .param(contaCreditoRazao)
                        .queryUnique();

                        if (descricaoPlano != null && descricaoPlano.has("DESCRICAOPLANO")) {
                            descricaoCredito = descricaoPlano.optString("DESCRICAOPLANO");
                        }
                        if (descricaoPlano != null && descricaoPlano.has("CONTAANALITICA")) {
                            classificacaoCredito = descricaoPlano.optString("CONTAANALITICA");
                        }

                        ResumoTxt.append("\r\n");

                        if (registro.length() == 1) ResumoTxt.append("ENCONTRADO;");
                        if (registro.length() > 1) ResumoTxt.append("REPETIDO;");
                        ResumoTxt.append(ttMov.dataMovimento);
                        ResumoTxt.append(";");
                        ResumoTxt.append(tipoData);
                        ResumoTxt.append(";");
                        ResumoTxt.append(valorFinal);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.documento);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.nomeOrigem);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.nomePortador);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.complemento01);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.complemento02);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.complemento03);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.complemento04);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.complemento05);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.complemento06);
                        ResumoTxt.append(";;");

                        ResumoTxt.append(ttMov.contaDebito);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.contaCredito);
                        ResumoTxt.append(";");
                        ResumoTxt.append(regraContaMovimento);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.historico.substring(0, ttMov.historico.indexOf("GPLCTO")));
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.historico.substring(0, ttMov.historico.indexOf("GPLCTO")));
                        ResumoTxt.append(";;");

                        ResumoTxt.append(ttMov.dataMovimento);
                        ResumoTxt.append(";");
                        ResumoTxt.append(contaDebitoRazao);
                        ResumoTxt.append(";");
                        ResumoTxt.append(classificacaoDebito);
                        ResumoTxt.append(";");


                        ResumoTxt.append(descricaoDebito);
                        ResumoTxt.append(";");
                        ResumoTxt.append(contaCreditoRazao);
                        ResumoTxt.append(";");
                        ResumoTxt.append(classificacaoCredito);
                        ResumoTxt.append(";");
                        ResumoTxt.append(descricaoCredito);
                        ResumoTxt.append(";");
                        ResumoTxt.append(valorFinal);
                        ResumoTxt.append(";");
                        ResumoTxt.append(historicoRazao);
                        ResumoTxt.append(";");
                        ResumoTxt.append(ttMov.nomeArquivo);
                        ResumoTxt.append(";");

                        objetoRoteiro = getObjetoRoteiro(ttMov, objetoRoteiro, logger);
                        objetoRoteiro.put("CHAVE", ttMov.chave + contaDebitoRazao);

                        objetoRoteiro.put("contaCreditoRazao", contaCreditoRazao);
                        objetoRoteiro.put("contaDebitoRazao", contaDebitoRazao);
                        objetoRoteiro.put("historicoRazao", historicoRazao);
                        objetoRoteiro.put("regraConta", regraContaMovimento);
                        objetoRoteiro.put("regraHistorico", regraHistorico);
                        objetoRoteiro.put("codigoHistorico", "");

                        objetoRoteiro.put("classificacaoDebito", classificacaoDebito);
                        objetoRoteiro.put("classificacaoCredito", classificacaoDebito);
                        objetoRoteiro.put("descricaoDebito", descricaoDebito);
                        objetoRoteiro.put("descricaoCredito", descricaoCredito);



                        if(ttMov.tipoMovimento.equals("CTB")) insertIORoteiro(dbIOCont, objetoRoteiro, logger);
                    }
                }
                else {
                    ResumoTxt.append("\r\n");
                    ResumoTxt.append("NAO ENCONTRADO;");
                    ResumoTxt.append(ttMov.dataMovimento);
                    ResumoTxt.append(";");
                    ResumoTxt.append(tipoData);
                    ResumoTxt.append(";");
                    ResumoTxt.append(valorFinal);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.documento);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.nomeOrigem);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.nomePortador);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.complemento01);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.complemento02);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.complemento03);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.complemento04);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.complemento05);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.complemento06);
                    ResumoTxt.append(";;");

                    ResumoTxt.append(ttMov.contaDebito);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.contaCredito);
                    ResumoTxt.append(";");
                    ResumoTxt.append(regraContaMovimento);
                    ResumoTxt.append(";");
                    ResumoTxt.append(ttMov.historico);
                    ResumoTxt.append(";");
                    ResumoTxt.append(regraHistorico);
                    ResumoTxt.append(";;");
                    ResumoTxt.append(ttMov.nomeArquivo);
                    ResumoTxt.append(";");
                    objetoRoteiro = getObjetoRoteiro(ttMov, objetoRoteiro, logger);
                    if(ttMov.tipoMovimento.equals("CTB")) insertIORoteiro(dbIOCont, objetoRoteiro, logger);

                }
            }

			if(tipoLancamento.contains("PAGAR")){

                if (ttMov.valorDesconto == 0 && ttMov.valorJuros == 0) classificacao = "X";
                if (ttMov.valorDesconto == 0 && ttMov.valorJuros > 0)  classificacao = "C";
                if (ttMov.valorDesconto >  0 && ttMov.valorJuros == 0) classificacao = "D";
                if (ttMov.valorDesconto >  0 && ttMov.valorJuros > 0)  classificacao = "V";

                if ((ttMov.contador > 1 || ttMov.valorMulta > 0) && classificacao.equals("X")) classificacao = "C";
                if (ttMov.contador > 1 && classificacao.equals("D")) classificacao = "V";
            }
            if(tipoLancamento.contains("RECEBER")){
                if (ttMov.valorDesconto == 0 && ttMov.valorJuros == 0) classificacao = "X";
                if (ttMov.valorDesconto == 0 && ttMov.valorJuros > 0)  classificacao = "D";
                if (ttMov.valorDesconto >  0 && ttMov.valorJuros == 0) classificacao = "C";
                if (ttMov.valorDesconto >  0 && ttMov.valorJuros > 0)  classificacao = "V";

                if ((ttMov.contador > 1 || ttMov.valorMulta > 0) && classificacao.equals("X")) classificacao = "D";
                if (ttMov.contador > 1 && classificacao.equals("C")) classificacao = "V";
            }

			if (roteiroCRM.optString("erpContabilidade").contains("DOMINIO")) {
				if(tipoLancamento.contains("PAGAR")){

					if (ttMov.valorDesconto == 0 && (ttMov.valorJuros + ttMov.valorMulta) == 0) classificacao = "X";
					if (ttMov.valorDesconto == 0 && (ttMov.valorJuros + ttMov.valorMulta) > 0)  classificacao = "V";
					if (ttMov.valorDesconto >  0 && (ttMov.valorJuros + ttMov.valorMulta) == 0) classificacao = "V";
					if (ttMov.valorDesconto >  0 && (ttMov.valorJuros + ttMov.valorMulta) > 0)  classificacao = "V";

					if ((ttMov.contador > 1 || ttMov.valorMulta > 0) && classificacao.equals("X")) classificacao = "V";
					if (ttMov.contador > 1 && classificacao.equals("D")) classificacao = "V";
				}
				if(tipoLancamento.contains("RECEBER")){
					if (ttMov.valorDesconto == 0 && (ttMov.valorJuros + ttMov.valorMulta) == 0) classificacao = "X";
					if (ttMov.valorDesconto == 0 && (ttMov.valorJuros + ttMov.valorMulta) > 0)  classificacao = "V";
					if (ttMov.valorDesconto >  0 && (ttMov.valorJuros + ttMov.valorMulta) == 0) classificacao = "V";
					if (ttMov.valorDesconto >  0 && (ttMov.valorJuros + ttMov.valorMulta) > 0)  classificacao = "V";

					if ((ttMov.contador > 1 || ttMov.valorMulta > 0) && classificacao.equals("X")) classificacao = "V";
					if (ttMov.contador > 1 && classificacao.equals("C")) classificacao = "V";
				}
			}

            String classificacaoFinal = classificacao + ttMov.classificacao + "01";

            if ((classificacao.startsWith("X") || roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) && ttMov.tipoMovimento.equals("CTBPORT")) { continue;}


            if (classificacao.startsWith("X")) {
                JSONObject js = new JSONObject();
                js.put("LOTE", ttMov.lote);
                js.put("CNPJEMPRESA", cnpjEmpresa);
                js.put("DOCUMENTO", ttMov.documento);
                js.put("CODEMPRESA", ttMov.codEmpresa);
                js.put("NOMEEMPRESA", ttMov.nomeEmpresa);
                js.put("DATAMOVIMENTO", ttMov.dataMovimento);
                js.put("TIPOMOVIMENTO", ttMov.tipoMovimento);
                js.put("TIPOLANCAMENTO", ttMov.tipoLancamento);
                js.put("CONTADEBITO", ttMov.contaDebito);
                js.put("CONTACREDITO", ttMov.contaCredito);
                js.put("HISTORICO", ttMov.historico);
                js.put("VALORDOCUMENTO", ttMov.valorDocumento);
                js.put("VALORLIQUIDACAO", ttMov.valorDocumento);
                js.put("VALORDESCONTO", ttMov.valorDesconto);
                js.put("VALORJUROS", ttMov.valorJuros);
                js.put("VALORMULTA", ttMov.valorMulta);
                js.put("NOMEPORTADOR", ttMov.nomePortador);
                js.put("CENTROCUSTO", ttMov.centroCusto);
                js.put("NATUREZACONTABIL", ttMov.naturezaContabil);
                js.put("NOMEORIGEM", ttMov.nomeOrigem);
                js.put("CPFCNPJ", ttMov.cpfCnpj);
                js.put("SERIE", ttMov.serie);
                js.put("STATUSMOVIMENTO", ttMov.statusMovimento);
                js.put("CHAVE", ttMov.chave  + "-CTB");
                js.put("CLASSIFICACAO", classificacaoFinal);

                js.put("COMPLEMENTO01", ttMov.complemento01);
                js.put("COMPLEMENTO02", ttMov.complemento02);
                js.put("COMPLEMENTO03", ttMov.complemento03);
                js.put("COMPLEMENTO04", ttMov.complemento04);
                js.put("COMPLEMENTO05", ttMov.complemento05);
                js.put("COMPLEMENTO06", ttMov.complemento06);
                js.put("COMPLEMENTO07", ttMov.complemento07);
                js.put("COMPLEMENTO08", ttMov.complemento08);
                js.put("COMPLEMENTO09", ttMov.complemento09);
                js.put("COMPLEMENTO10", ttMov.complemento10);
                js.put("NOMEARQUIVO", ttMov.nomeArquivo);
				
				recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTB");
				
				if (ttMov.tipoMovimento.equals("CTB")   && ttMov.contaDebito.equals("")) js.put("CONTADEBITO", "PENDENTE");
				if (ttMov.tipoMovimento.equals("CTB")   && ttMov.contaCredito.equals("")) js.put("CONTACREDITO", "PENDENTE");
				criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTB", js);

                //records.put(js);
                if (!ttMov.centroCusto.equals("")) {
					
                    JSONObject rec3 = new JSONObject(js.toString());
                    rec3.put("CONTADEBITO", ttMov.contaDebito);
					rec3.put("CONTACREDITO", ttMov.contaCredito);
				    rec3.put("TIPOMOVIMENTO", "CTBCC");
                    rec3.put("CHAVE", ttMov.chave + "-CTBCC");
                    rec3.put("CLASSIFICACAO", classificacaoFinal + "-CTBCC");
					
					recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBCC");
					criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBCC", rec3);

                    //records.put(rec3);
                }
                continue;
            }

            String classJur = "";
            String classDes = "";
            String classMul = "";

			if(tipoLancamento.contains("PAGAR")){
                if(classificacao.startsWith("C") || classificacao.startsWith("V")){
                    if (ttMov.tipoMovimento.equals("CTBPORT"))  classificacaoFinal = classificacao + ttMov.classificacao + "01";
                    if (ttMov.tipoMovimento.equals("CTB"))      classificacaoFinal = classificacao + ttMov.classificacao + "03";
                    classDes = classificacao + ttMov.classificacao + "02";
                    classJur = classificacao + ttMov.classificacao + "04";
                    classMul = classificacao + ttMov.classificacao + "05";
                }
                if(classificacao.startsWith("D")){
                    if (ttMov.tipoMovimento.equals("CTBPORT"))  classificacaoFinal = classificacao + ttMov.classificacao + "04";
                    if (ttMov.tipoMovimento.equals("CTB"))      classificacaoFinal = classificacao + ttMov.classificacao + "01";
                    classDes = classificacao + ttMov.classificacao + "05";
                    classJur = classificacao + ttMov.classificacao + "02";
                    classMul = classificacao + ttMov.classificacao + "03";
                }
            }
			
			
            if(tipoLancamento.contains("RECEBER")){
                if(classificacao.startsWith("D") || classificacao.startsWith("V")){
                    if (ttMov.tipoMovimento.equals("CTBPORT"))  classificacaoFinal = classificacao + ttMov.classificacao + "01";
                    if (ttMov.tipoMovimento.equals("CTB"))      classificacaoFinal = classificacao + ttMov.classificacao + "03";
                    classDes = classificacao + ttMov.classificacao + "02";
                    classJur = classificacao + ttMov.classificacao + "04";
                    classMul = classificacao + ttMov.classificacao + "05";
                }
                if(classificacao.startsWith("C")){
                    if (ttMov.tipoMovimento.equals("CTBPORT"))  classificacaoFinal = classificacao + ttMov.classificacao + "04";
                    if (ttMov.tipoMovimento.equals("CTB"))      classificacaoFinal = classificacao + ttMov.classificacao + "01";
                    classDes = classificacao + ttMov.classificacao + "05";
                    classJur = classificacao + ttMov.classificacao + "02";
                    classMul = classificacao + ttMov.classificacao + "03";
                }
            }
              


            if (ttMov.tipoMovimento.equals("CTBPORT")) {
                JSONObject js = new JSONObject();
                js.put("LOTE", ttMov.lote);
                js.put("CNPJEMPRESA", cnpjEmpresa);
                js.put("DOCUMENTO", ttMov.documento);
                js.put("CODEMPRESA", ttMov.codEmpresa);
                js.put("NOMEEMPRESA", ttMov.nomeEmpresa);
                js.put("DATAMOVIMENTO", ttMov.dataMovimento);
                js.put("TIPOMOVIMENTO", "CTBPORT");
                js.put("TIPOLANCAMENTO", ttMov.tipoLancamento);
                js.put("HISTORICO", ttMov.historico);
                js.put("VALORDOCUMENTO", ttMov.valorDocumento);
                js.put("VALORLIQUIDACAO", ttMov.valorDocumento);
                js.put("VALORDESCONTO", ttMov.valorDesconto);
                js.put("VALORJUROS", ttMov.valorJuros);
                js.put("VALORMULTA", ttMov.valorMulta);
                js.put("NOMEPORTADOR", ttMov.nomePortador);
                js.put("CENTROCUSTO", ttMov.centroCusto);
                js.put("NATUREZACONTABIL", ttMov.naturezaContabil);
                js.put("NOMEORIGEM", ttMov.nomeOrigem);
                js.put("CPFCNPJ", ttMov.cpfCnpj);
                js.put("SERIE", ttMov.serie);
                js.put("STATUSMOVIMENTO", ttMov.statusMovimento);
                js.put("CHAVE", ttMov.chave + "-CTBPORT");
                js.put("CLASSIFICACAO", classificacaoFinal);

                js.put("COMPLEMENTO01", ttMov.complemento01);
                js.put("COMPLEMENTO02", ttMov.complemento02);
                js.put("COMPLEMENTO03", ttMov.complemento03);
                js.put("COMPLEMENTO04", ttMov.complemento04);
                js.put("COMPLEMENTO05", ttMov.complemento05);
                js.put("COMPLEMENTO06", ttMov.complemento06);
                js.put("COMPLEMENTO07", ttMov.complemento07);
                js.put("COMPLEMENTO08", ttMov.complemento08);
                js.put("COMPLEMENTO09", ttMov.complemento09);
                js.put("COMPLEMENTO10", ttMov.complemento10);
                js.put("NOMEARQUIVO", ttMov.nomeArquivo);

                if(tipoLancamento.contains("PAGAR")){
                    js.put("CONTADEBITO", "");
                    js.put("CONTACREDITO", ttMov.contaCredito);
                }
                if(tipoLancamento.contains("RECEBER")){
                    js.put("CONTADEBITO", ttMov.contaDebito);
                    js.put("CONTACREDITO", "");
                }
				
				recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBPORT");				
				if (ttMov.tipoMovimento.equals("CTBPORT") && ttMov.tipoLancamento.equals("RECEBER") && ttMov.contaDebito.equals("")) js.put("CONTADEBITO", "PENDENTE");
				if (ttMov.tipoMovimento.equals("CTBPORT") && ttMov.tipoLancamento.equals("PAGAR") && ttMov.contaCredito.equals("")) js.put("CONTACREDITO", "PENDENTE");				
				criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBPORT", js);
             
                //records.put(js);
            }
            if (ttMov.tipoMovimento.equals("CTB")) {
                JSONObject js = new JSONObject();
                js.put("LOTE", ttMov.lote);
                js.put("CNPJEMPRESA", cnpjEmpresa);
                js.put("DOCUMENTO", ttMov.documento);
                js.put("CODEMPRESA", ttMov.codEmpresa);
                js.put("NOMEEMPRESA", ttMov.nomeEmpresa);
                js.put("DATAMOVIMENTO", ttMov.dataMovimento);
                js.put("TIPOMOVIMENTO", "CTB");
                js.put("TIPOLANCAMENTO", ttMov.tipoLancamento);
                js.put("HISTORICO", ttMov.historico);
                js.put("VALORDOCUMENTO", ttMov.valorDocumento);
                js.put("VALORLIQUIDACAO", ttMov.valorDocumento);
                js.put("VALORDESCONTO", ttMov.valorDesconto);
                js.put("VALORJUROS", ttMov.valorJuros);
                js.put("VALORMULTA", ttMov.valorMulta);
                js.put("NOMEPORTADOR", ttMov.nomePortador);
                js.put("CENTROCUSTO", ttMov.centroCusto);
                js.put("NATUREZACONTABIL", ttMov.naturezaContabil);
                js.put("NOMEORIGEM", ttMov.nomeOrigem);
                js.put("CPFCNPJ", ttMov.cpfCnpj);
                js.put("SERIE", ttMov.serie);
                js.put("STATUSMOVIMENTO", ttMov.statusMovimento);
                js.put("CHAVE", ttMov.chave + "-CTB");
                js.put("CLASSIFICACAO", classificacaoFinal);

                js.put("COMPLEMENTO01", ttMov.complemento01);
                js.put("COMPLEMENTO02", ttMov.complemento02);
                js.put("COMPLEMENTO03", ttMov.complemento03);
                js.put("COMPLEMENTO04", ttMov.complemento04);
                js.put("COMPLEMENTO05", ttMov.complemento05);
                js.put("COMPLEMENTO06", ttMov.complemento06);
                js.put("COMPLEMENTO07", ttMov.complemento07);
                js.put("COMPLEMENTO08", ttMov.complemento08);
                js.put("COMPLEMENTO09", ttMov.complemento09);
                js.put("COMPLEMENTO10", ttMov.complemento10);
                js.put("NOMEARQUIVO", ttMov.nomeArquivo);

                if(tipoLancamento.contains("PAGAR")){
                    js.put("CONTADEBITO", ttMov.contaDebito);
                    js.put("CONTACREDITO", "");
                    if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) js.put("CONTACREDITO", ttMov.contaCredito);
                }
                if(tipoLancamento.contains("RECEBER")){
                    js.put("CONTADEBITO", "");
                    js.put("CONTACREDITO", ttMov.contaCredito);
                    if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) js.put("CONTADEBITO", ttMov.contaDebito);

                }
				
				recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTB");				
				if (ttMov.tipoMovimento.equals("CTB") && ttMov.tipoLancamento.equals("PAGAR") && ttMov.contaDebito.equals("")) js.put("CONTADEBITO", "PENDENTE");
				if (ttMov.tipoMovimento.equals("CTB") && ttMov.tipoLancamento.equals("RECEBER") && ttMov.contaCredito.equals("")) js.put("CONTACREDITO", "PENDENTE");				
				criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTB", js);
				
                //records.put(js);
                if (!ttMov.centroCusto.equals("")) {
                    JSONObject rec3 = new JSONObject(js.toString());
                    rec3.put("CONTADEBITO", ttMov.contaDebito);
					rec3.put("CONTACREDITO", ttMov.contaCredito);
				    rec3.put("TIPOMOVIMENTO", "CTBCC");
                    rec3.put("CHAVE", ttMov.chave + "-CTBCC");
                    rec3.put("CLASSIFICACAO", classificacaoFinal + "-CTBCC");
					
					recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBCC");
					criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBCC", rec3);
                    //records.put(rec3);
                }

				 
                if (ttMov.valorJuros > 0)  {
                    classificacaoFinal = classJur;
                    JSONObject jsJUR = new JSONObject(js.toString());
                    jsJUR.put("LOTE", ttMov.lote);
                    jsJUR.put("CNPJEMPRESA", cnpjEmpresa);
                    jsJUR.put("DOCUMENTO", ttMov.documento);
                    jsJUR.put("CODEMPRESA", ttMov.codEmpresa);
                    jsJUR.put("NOMEEMPRESA", ttMov.nomeEmpresa);
                    jsJUR.put("DATAMOVIMENTO", ttMov.dataMovimento);
                    jsJUR.put("TIPOMOVIMENTO", "CTBJUR");
                    jsJUR.put("TIPOLANCAMENTO", ttMov.tipoLancamento);
                    jsJUR.put("HISTORICO", ttMov.historicoJuros);
                    jsJUR.put("VALORDOCUMENTO", ttMov.valorDocumento);
                    jsJUR.put("VALORLIQUIDACAO", ttMov.valorDocumento);
                    jsJUR.put("VALORDESCONTO", ttMov.valorDesconto);
                    jsJUR.put("VALORJUROS", ttMov.valorJuros);
                    jsJUR.put("VALORMULTA", ttMov.valorMulta);
                    jsJUR.put("NOMEPORTADOR", ttMov.nomePortador);
                    jsJUR.put("CENTROCUSTO", ttMov.centroCusto);
                    jsJUR.put("NATUREZACONTABIL", "D");
                    jsJUR.put("NOMEORIGEM", ttMov.nomeOrigem);
                    jsJUR.put("CPFCNPJ", ttMov.cpfCnpj);
                    jsJUR.put("SERIE", ttMov.serie);
                    jsJUR.put("STATUSMOVIMENTO", ttMov.statusMovimento);
                    jsJUR.put("CHAVE", ttMov.chave + "-CTBJUR");
                    jsJUR.put("CLASSIFICACAO", classificacaoFinal);

                    jsJUR.put("COMPLEMENTO01", ttMov.complemento01);
                    jsJUR.put("COMPLEMENTO02", ttMov.complemento02);
                    jsJUR.put("COMPLEMENTO03", ttMov.complemento03);
                    jsJUR.put("COMPLEMENTO04", ttMov.complemento04);
                    jsJUR.put("COMPLEMENTO05", ttMov.complemento05);
                    jsJUR.put("COMPLEMENTO06", ttMov.complemento06);
                    jsJUR.put("COMPLEMENTO07", ttMov.complemento07);
                    jsJUR.put("COMPLEMENTO08", ttMov.complemento08);
                    jsJUR.put("COMPLEMENTO09", ttMov.complemento09);
                    jsJUR.put("COMPLEMENTO10", ttMov.complemento10);
                    jsJUR.put("NOMEARQUIVO", ttMov.nomeArquivo);

                    if(tipoLancamento.contains("PAGAR")){
                        jsJUR.put("CONTADEBITO",  ttMov.contaJuros);
                        jsJUR.put("CONTACREDITO", "");
                        if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) jsJUR.put("CONTACREDITO", ttMov.contaCredito);

                    }
                    if(tipoLancamento.contains("RECEBER")){
                        jsJUR.put("CONTADEBITO",  "");
                        jsJUR.put("CONTACREDITO", ttMov.contaJuros);
                        if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) jsJUR.put("CONTADEBITO", ttMov.contaDebito);

                    }
					
					
					recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBJUR");				
					criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBJUR", jsJUR);
				
                
                    //records.put(jsJUR);
                    if (!ttMov.centroCusto.equals("")) {
                        JSONObject rec3 = new JSONObject(jsJUR.toString());
                         rec3.put("CONTADEBITO", ttMov.contaDebito);
						rec3.put("CONTACREDITO", ttMov.contaCredito);
						rec3.put("TIPOMOVIMENTO", "CTBJURCC");
                        rec3.put("CHAVE", ttMov.chave + "-CTBJURCC");
                        rec3.put("CLASSIFICACAO", classificacaoFinal + "-CTBJURCC");
						recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBJURCC");
						criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBJURCC", rec3);
                       // records.put(rec3);
                    }
                }
                if (ttMov.valorDesconto > 0)  {
                    classificacaoFinal = classDes;
                    JSONObject jsDES = new JSONObject(js.toString());
                    jsDES.put("LOTE", ttMov.lote);
                    jsDES.put("CNPJEMPRESA", cnpjEmpresa);
                    jsDES.put("DOCUMENTO", ttMov.documento);
                    jsDES.put("CODEMPRESA", ttMov.codEmpresa);
                    jsDES.put("NOMEEMPRESA", ttMov.nomeEmpresa);
                    jsDES.put("DATAMOVIMENTO", ttMov.dataMovimento);
                    jsDES.put("TIPOMOVIMENTO", "CTBDES");
                    jsDES.put("TIPOLANCAMENTO", ttMov.tipoLancamento);
                    jsDES.put("HISTORICO", ttMov.historicoDesconto);
                    jsDES.put("VALORDOCUMENTO", ttMov.valorDocumento);
                    jsDES.put("VALORLIQUIDACAO", ttMov.valorDocumento);
                    jsDES.put("VALORDESCONTO", ttMov.valorDesconto);
                    jsDES.put("VALORJUROS", ttMov.valorJuros);
                    jsDES.put("VALORMULTA", ttMov.valorMulta);
                    jsDES.put("NOMEPORTADOR", ttMov.nomePortador);
                    jsDES.put("CENTROCUSTO", ttMov.centroCusto);
                    jsDES.put("NATUREZACONTABIL", "C");
                    jsDES.put("NOMEORIGEM", ttMov.nomeOrigem);
                    jsDES.put("CPFCNPJ", ttMov.cpfCnpj);
                    jsDES.put("SERIE", ttMov.serie);
                    jsDES.put("STATUSMOVIMENTO", ttMov.statusMovimento);
                    jsDES.put("CHAVE", ttMov.chave + "-CTBDES");
                    jsDES.put("CLASSIFICACAO", classificacaoFinal);

                    jsDES.put("COMPLEMENTO01", ttMov.complemento01);
                    jsDES.put("COMPLEMENTO02", ttMov.complemento02);
                    jsDES.put("COMPLEMENTO03", ttMov.complemento03);
                    jsDES.put("COMPLEMENTO04", ttMov.complemento04);
                    jsDES.put("COMPLEMENTO05", ttMov.complemento05);
                    jsDES.put("COMPLEMENTO06", ttMov.complemento06);
                    jsDES.put("COMPLEMENTO07", ttMov.complemento07);
                    jsDES.put("COMPLEMENTO08", ttMov.complemento08);
                    jsDES.put("COMPLEMENTO09", ttMov.complemento09);
                    jsDES.put("COMPLEMENTO10", ttMov.complemento10);
                    jsDES.put("NOMEARQUIVO", ttMov.nomeArquivo);

                    if(tipoLancamento.contains("PAGAR")){
                        jsDES.put("CONTADEBITO", "");
                        jsDES.put("CONTACREDITO", ttMov.contaDesconto);
                        if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) jsDES.put("CONTADEBITO", ttMov.contaCredito);

                    }
                    if(tipoLancamento.contains("RECEBER")){
                        jsDES.put("CONTADEBITO",  ttMov.contaDesconto);
                        jsDES.put("CONTACREDITO", "");
                        if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) jsDES.put("CONTACREDITO", ttMov.contaDebito);

                    }
					
					
					recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBDES");				
					criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBDES", jsDES);
				 
                    //records.put(jsDES);
                    if (!ttMov.centroCusto.equals("")) {
                        JSONObject rec3 = new JSONObject(jsDES.toString());
                        rec3.put("CONTADEBITO", ttMov.contaDebito);
						rec3.put("CONTACREDITO", ttMov.contaCredito);
						rec3.put("TIPOMOVIMENTO", "CTBDESCC");
                        rec3.put("CHAVE", ttMov.chave + "-CTBDESCC");
                        rec3.put("CLASSIFICACAO", classificacaoFinal + "-CTBDESCC");
                        recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBDESCC");
						criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBDESCC", rec3);
                       // records.put(rec3);
                    }
                }
                if (ttMov.valorMulta > 0)  {
                    classificacaoFinal = classMul;
                    JSONObject jsMUL = new JSONObject(js.toString());
                    jsMUL.put("LOTE", ttMov.lote);
                    jsMUL.put("CNPJEMPRESA", cnpjEmpresa);
                    jsMUL.put("DOCUMENTO", ttMov.documento);
                    jsMUL.put("CODEMPRESA", ttMov.codEmpresa);
                    jsMUL.put("NOMEEMPRESA", ttMov.nomeEmpresa);
                    jsMUL.put("DATAMOVIMENTO", ttMov.dataMovimento);
                    jsMUL.put("TIPOMOVIMENTO", "CTBMUL");
                    jsMUL.put("TIPOLANCAMENTO", ttMov.tipoLancamento);
                    jsMUL.put("HISTORICO", ttMov.historicoMulta);
                    jsMUL.put("VALORDOCUMENTO", ttMov.valorDocumento);
                    jsMUL.put("VALORLIQUIDACAO", ttMov.valorDocumento);
                    jsMUL.put("VALORDESCONTO", ttMov.valorDesconto);
                    jsMUL.put("VALORJUROS", ttMov.valorJuros);
                    jsMUL.put("VALORMULTA", ttMov.valorMulta);
                    jsMUL.put("NOMEPORTADOR", ttMov.nomePortador);
                    jsMUL.put("CENTROCUSTO", ttMov.centroCusto);
                    jsMUL.put("NATUREZACONTABIL", "D");
                    jsMUL.put("NOMEORIGEM", ttMov.nomeOrigem);
                    jsMUL.put("CPFCNPJ", ttMov.cpfCnpj);
                    jsMUL.put("SERIE", ttMov.serie);
                    jsMUL.put("STATUSMOVIMENTO", ttMov.statusMovimento);
                    jsMUL.put("CHAVE", ttMov.chave + "-CTBMUL");
                    jsMUL.put("CLASSIFICACAO", classificacaoFinal);

                    jsMUL.put("COMPLEMENTO01", ttMov.complemento01);
                    jsMUL.put("COMPLEMENTO02", ttMov.complemento02);
                    jsMUL.put("COMPLEMENTO03", ttMov.complemento03);
                    jsMUL.put("COMPLEMENTO04", ttMov.complemento04);
                    jsMUL.put("COMPLEMENTO05", ttMov.complemento05);
                    jsMUL.put("COMPLEMENTO06", ttMov.complemento06);
                    jsMUL.put("COMPLEMENTO07", ttMov.complemento07);
                    jsMUL.put("COMPLEMENTO08", ttMov.complemento08);
                    jsMUL.put("COMPLEMENTO09", ttMov.complemento09);
                    jsMUL.put("COMPLEMENTO10", ttMov.complemento10);
                    jsMUL.put("NOMEARQUIVO", ttMov.nomeArquivo);

                    if(tipoLancamento.contains("PAGAR")){
                        jsMUL.put("CONTADEBITO",  ttMov.contaMulta);
                        jsMUL.put("CONTACREDITO", "");
                        if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) jsMUL.put("CONTACREDITO", ttMov.contaCredito);

                    }
                    if(tipoLancamento.contains("RECEBER")){
                        jsMUL.put("CONTADEBITO",  "");
                        jsMUL.put("CONTACREDITO", ttMov.contaMulta);
                        if (roteiroCRMPrincipal.optString("Forcar_Partida_Dobrada").toUpperCase().equals("TRUE")) jsMUL.put("CONTADEBITO", ttMov.contaDebito);

                    }
					
					
					recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBMUL");				
					criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBMUL", jsMUL);				 
                    
                    //records.put(jsMUL);
                    if (!ttMov.centroCusto.equals("")) {
                        JSONObject rec3 = new JSONObject(jsMUL.toString());
                        rec3.put("CONTADEBITO", ttMov.contaDebito);
						rec3.put("CONTACREDITO", ttMov.contaCredito);
						rec3.put("TIPOMOVIMENTO", "CTBMULCC");
                        rec3.put("CHAVE", ttMov.chave + "-CTBMULCC");
                        rec3.put("CLASSIFICACAO", classificacaoFinal + "-CTBMULCC");
						recordF = findMovimentoPorChave(dbIOCont, ttMov.chave+ "-CTBMULCC");
						criaMovimento(dbIOCont, recordF, ttMov.chave+ "-CTBMULCC", rec3);
                       //records.put(rec3);
                    }
                }
            }
        }

        if (apagaExtrato) {
            dbIOCont.delete("IO_EXTRATO")
            .where("CODEMPRESA=?")
            .param(codEmpresa)
            .execute();
        }
        // resumo comparativo com razao
        if (comparaRazao) {
            String filenameRazao = RouteEngine.INOUT_HOME + "/contabil/" + roteiroCRMPrincipal.optString("contabilidade") + "/Arquivos/RESUMO_APOS_IMPORTACAO_" + tipoLancamento + "_" + nomeEmpresa + "_"+codEmpresa +".csv";
            FileWriter writerRazao = new FileWriter(filenameRazao);
            writerRazao.writeNewFile(ResumoTxt.toString());
        }

        //-------------------------------------------------------------------------------------
        // GERA ARQUIVO COM CONTAS NAO ENCONTRADAS
        //-------------------------------------------------------------------------------------
        String filename = backupDirName + "/ARQUIVO_APOIO_" + tipoLancamento + ".csv";
        // Cria o arquivo de DE-PARA FORNECEDOR
        FileWriter writer = new FileWriter(filename);
        writer.writeNewFile(txtDePara.toString());

        Iterator ite = mapaLote.keySet().iterator();
        while (ite.hasNext()) {
            String key = (String)ite.next();
            ttLote ttLot = (ttLote)mapaLote.get(key);
            // =======================================================================================
            // * elimina da tabela IO_MOVIMENTO os movimentos deste LOTE para evitar sujeira na base *
            // =======================================================================================
            lote = ttLot.lote;             
            ultimoJS = new JSONObject();
            ultimoJS.put("LOTE", lote);
            ultimoJS.put("DOCUMENTO", "");
            ultimoJS.put("CODEMPRESA", codEmpresa);
            ultimoJS.put("NOMEEMPRESA", nomeEmpresa);
            ultimoJS.put("DATAMOVIMENTO", "");
            ultimoJS.put("TIPOMOVIMENTO", "");
            ultimoJS.put("TIPOLANCAMENTO", "");
            ultimoJS.put("CONTADEBITO", "LOTE_ENCERRADO");
            ultimoJS.put("CONTACREDITO", "LOTE_ENCERRADO");
            ultimoJS.put("HISTORICO", "");
            ultimoJS.put("VALORLIQUIDACAO", 0);
            ultimoJS.put("VALORDOCUMENTO", 0);
            ultimoJS.put("VALORDESCONTO", 0);
            ultimoJS.put("VALORJUROS", 0);
            ultimoJS.put("VALORMULTA", 0);
            ultimoJS.put("NOMEPORTADOR", "");
            ultimoJS.put("CENTROCUSTO", "");
            ultimoJS.put("NATUREZACONTABIL", "");
            ultimoJS.put("NOMEORIGEM", "");
            ultimoJS.put("CPFCNPJ", "");
            ultimoJS.put("SERIE", "");
            ultimoJS.put("STATUSMOVIMENTO", 0);
            ultimoJS.put("CHAVE","LOTE_ENCERRADO " + lote );
            ultimoJS.put("CLASSIFICACAO", "LOTE_ENCERRADO");
            ultimoJS.put("STATUSMOVIMENTO", 1);
            records.put(ultimoJS);
            // Resumo Planilha
            try {
                String dirName1 = dirName.substring(0, dirName.lastIndexOf("/"))+"/DePara/";
                File file = new File(dirName1);
                try {
                    String diretorio = dirName1;
                    File file2 = new File(diretorio);
                    File[] files = file2.listFiles();
                    if (FileUtil.dirHasFiles(diretorio)) {
                        for (File fl: files) {
                            if (fl.isFile()){
                                if(fl.getName().contains(lote) && fl.getName().toLowerCase().endsWith(".csv") && !fl.getName().startsWith("OK_") ){
                                    // ELIMINA ARQUIVO IMPORTADO
                                    file = new File(dirName1);
                                    if (file.exists()){
                                        FileUtil.deleteFile(dirName1+fl.getName());
                                    }
                                }
                            }
                        }
                    }
                } catch (Exception ee) {
                    logger.logError(ee);
                }
            }catch (Exception e) {
                logger.logError(e);
            }
        }
    } catch (Exception ee) {
        logger.logError("EndpointA: ", ee);
    } finally {
        if (dbIOCont != null) {
            dbIOCont.closeConnection();
        }
    }
    return records;
}

class ttLote {
    public String lote;
    public ttLote(){}
    public ttLote(ttLote tt){
        lote=tt.lote;
    }
}

class ttJuros {
    public String documento;
	public double valorJur;
	public int valorLido;
    public ttJuros(){}
    public ttJuros(ttJuros ttJ){
        documento = ttJ.documento;
		valorLido = ttJ.valorLido;
		valorJur  = ttJ.valorJur;
    }
}

class ttDesconto {
    public String documento;
	public double valorDesc;
	public int valorLido;
    public ttDesconto(){}
    public ttDesconto(ttDesconto ttD){
        documento  = ttD.documento;
		valorDesc  = ttD.valorDesc;
		valorLido  = ttD.valorLido;
    }
}

class ttPlano {
    public String contaContabil;
    public String descricaoPlano;
    public String contaAnalitica;
    public ttPlano(){}
    public ttPlano(ttPlano ttP){
        contaContabil = ttP.contaContabil;
		descricaoPlano = ttP.descricaoPlano;
		contaAnalitica = ttP.contaAnalitica;
    }
}

class ttFornecedor {
    public String nomeOrigem;
    public String contaMovimento;
    public ttFornecedor(){}
    public ttFornecedor(ttFornecedor ttF){
        nomeOrigem 	 = ttF.nomeOrigem;
        contaMovimento = ttF.contaMovimento;
    }
}

public void criaMovimento(DataBase dbIO, JSONObject recordRec, String chave, JSONObject js) {
	if (recordRec != null)  {
		try {
			updateMovimento(dbIO, js);						 
		} catch (Exception eUpdateMovimento) {						 
			logger.logError("EndpointB: Erro ao Atualizar Movimento", eUpdateMovimento);
		}
	} else {
		try {
			insertMovimento(dbIO, js); 
		} catch (Exception eInsertMovimento) { 						 
			logger.logError("EndpointB: Erro ao fazer insert no Movimento", eInsertMovimento);
		}
	}
}

public int getIndiceRoteiro(String nomeCampo, JSONObject roteiroIndice) {
    int validaCampo = -1;
    try {
        if (!roteiroIndice.optString(nomeCampo).equals("")) {
            try {
                validaCampo = Integer.parseInt(roteiroIndice.optString(nomeCampo).replaceAll("@","").trim());
            }
            catch (Exception xx) { validaCampo = -1;}
        }
    }
    catch (Exception xx) {validaCampo = -1;}
    return  validaCampo;
}

public ttMovimentoPadrao geralancamentoExtraInterno(ttMovimentoPadrao ttMov4 , ttMovimentoPadrao ttMov2, String chave,boolean gerarApenasValorDocumento, int complemento , String textoComplemento, String classificacao){
    if (ttMov4 == null) {
        ttMov4 = new ttMovimentoPadrao(ttMov2);
        ttMov4.chave                    = chave;
        if(gerarApenasValorDocumento){
            ttMov4.valorDesconto            = 0;
            ttMov4.valorMulta               = 0;
            ttMov4.valorJuros               = 0;
        }
        ttMov4.classificacao            = classificacao;
        switch(complemento){
            case 1: ttMov4.complemento01 = textoComplemento; break;
            case 2: ttMov4.complemento02 = textoComplemento; break;
            case 3: ttMov4.complemento03 = textoComplemento; break;
            case 4: ttMov4.complemento04 = textoComplemento; break;
            case 5: ttMov4.complemento05 = textoComplemento; break;
            case 6: ttMov4.complemento06 = textoComplemento; break;
        }
    }
    return ttMov4;
}













































































































































































//## CODIGO GERADO A PARTIR DAS REGRAS NO SALESFORCE ##
//## NAO ALTERAR DAQUI ATE O FINAL DO SCRIPT!!!!     ##
public JSONObject getRoteiro() {
    JSONObject js = new JSONObject();
    js.put("codigo", "ROT-2019-127466");
    js.put("idRoteiro", "a0A1C00000yJBjXUAW");
    js.put("idEmpresa", "a0q1C000007zbIpQAI");
    js.put("idContabilidade", "a091C00001kFvp1");
    js.put("CnpjContabilidade", "25.568.056/0001-78");
    js.put("CnpjEmpresa", "25.944.992/0001-36");
    js.put("ignoraExel", "FALSE");
    js.put("fornecedor", "COLUNA(17,60)");
    js.put("dataMovimento", "COLUNA(1,8)");
    js.put("portador", "");
    js.put("documentoNF", "");
    js.put("valorDocumento", "COLUNA(62,75)");
    js.put("valorJuros", "COLUNA(90,102)");
    js.put("valorDesconto", "");
    js.put("valorMulta", "");
    js.put("valorPagamento", "");
    js.put("complemento01", "COLUNA(17,60)");
    js.put("complemento02", "COLUNA(90,102)");
    js.put("complemento03", "COLUNA(77,83)");
    js.put("complemento04", "COLUNA(1,60)");
    js.put("complemento05", "");
    js.put("complemento06", "");
    js.put("centroCusto", "");
    js.put("valorAlternativo", "");
    js.put("cpfCnpj", "");
    js.put("gravaCnpjMovimento", "FALSE");
    js.put("cnpjSomenteNumeros", "FALSE");
    js.put("dataFake", "");

    js.put("Abas_Especificas", "");
    js.put("classificaFornec", "");
    js.put("classificaPlano", "");
    js.put("contaFixaCredito", "");
    js.put("contaFixaDebito", "");
    js.put("contaFixaDesconto", "");
    js.put("contaFixaJuros", "1652");
    js.put("contaFixaMulta", "");
    js.put("contabilidade", "Savere");
    js.put("Contabilizacao_Atraves_Fornecedor", "FALSE");
    js.put("Conta_Fixa_Cruzamento_Extrato", "");
    js.put("Cruza_Extrato_com_Extrato", "FALSE");
    js.put("cruzaExtrato", "FALSE");
    js.put("empresa", "Colegionossasenhora");
    js.put("empresaDir", "");
    js.put("erpContabilidade", "ALTERDATA");
    js.put("Forcar_Partida_Dobrada", "FALSE");
    js.put("Forcar_Partida_Simples", "FALSE");
    js.put("Realizar_Busca_Plano", "FALSE");
    js.put("geraGerencial", "FALSE");
    js.put("Integracao_fiscal", "FALSE");
    js.put("Integracao_contratos", "false");
    js.put("Usa_Filial_Questor", "false");
    js.put("Ler_Planilha_Pelo_Cabecalho", "FALSE");
    js.put("movimentoPortador", "PARTIDA DOBRADA");
    js.put("naoZerarValores", "FALSE");
    js.put("lerAposPrincipal", "");
    js.put("campoLinhaPrincipal", "VALOR DOCUMENTO");
    js.put("nomeRelatorioRef", "NORMAL");
    js.put("Planilhas_Padroes", "");
    js.put("statusRoteiro", "EM DESENVOLVIMENTO");
    js.put("tipoArquivo", ".TXT - ARQUIVO TEXTO");
    js.put("tipoIntegracao", "CONTAS RECEBIDAS");
    js.put("fazerShrink", "FALSE");
    js.put("colunaShrink", "0");
    js.put("dupliNaoEncontContabil", "FALSE");
    js.put("Conta_Dupl_Contabil", "");
    js.put("Aloca_Checknum", "FALSE");

    js.put("usarComplementoVencimento", "NAO USAR");
    js.put("usarComplementoParcela", "NAO USAR");
    js.put("especiaisBaixaFiscal", "");
    js.put("Arredonda", "false");
    js.put("Colunas_de_Valores_Extras", "");
    js.put("Rotulos_Para_Valores_Extras", "");
    js.put("Colunas_de_Portadores_Extras", "");
    js.put("Coluna_Valor_Duplicata_Dominio", "9");
    js.put("delimitadorDoArquivo", "");
    js.put("agrupaArquivos", "FALSE");

    js.put("X001_ROB", "");
    js.put("X002_Despesas", "");
    js.put("X003_Despesas_Detalhe", "");
    js.put("X004_Geracao_Caixa_Mes", "");
    js.put("X005_Geracao_Caixa_Acumulado", "");
    js.put("X006_Despesas_sobre_Faturamento", "");
    js.put("X007_Lucro", "");
    js.put("X008_Deducoes_Receitas", "");
    js.put("X009_CMV", "");
    js.put("X010_CPV", "");
    js.put("X011_CSP", "");
    js.put("X012_Indicador", "");
    js.put("X013_Indicador", "");
    js.put("X014_Indicador", "");
    js.put("X015_Indicador", "");
    js.put("X016_Indicador", "");
    js.put("X017_Indicador", "");
    js.put("X018_Indicador", "");
    js.put("X019_Indicador", "");
    js.put("X020_Indicador", "");
    js.put("X021_Indicador", "");

    js.put("X015_Label", "");
    js.put("X016_Label", "");
    js.put("X017_Label", "");
    js.put("X018_Label", "");
    js.put("X019_Label", "");
    js.put("X020_Label", "");
    js.put("Email_Logo", "");
    js.put("BuscaCnpjCRM", "FALSE");
    js.put("Idioma", "PORTUGUES");
    js.put("Ordem_dos_Indicadores", "");
    js.put("Rotulo_Complemento_01", "");
    js.put("Rotulo_Complemento_02", "");
    js.put("Rotulo_Complemento_03", "");
    js.put("Rotulo_Complemento_04", "");
    js.put("Rotulo_Complemento_05", "");
    js.put("Gera_LOG", "false");
    js.put("Gera_LOG_PARAMETROS", "");

    return js;
}

public JSONObject getRoteiroZZPADRAOOTTIMIZZAREC1() {
    JSONObject js = new JSONObject();
    js.put("codigo", "ROT-2021-1016996");
    js.put("idRoteiro", "a0A1C00000yJBjXUAW");
    js.put("idEmpresa", "a0q6R000007KGdjQAG");
    js.put("idContabilidade", "a091500001BVcOf");
    js.put("CnpjContabilidade", "10.000.000/0000-0");
    js.put("CnpjEmpresa", "1");
    js.put("fornecedor", "2");
    js.put("dataMovimento", "0");
    js.put("portador", "6");
    js.put("documentoNF", "1");
    js.put("valorDocumento", "4");
    js.put("valorJuros", "");
    js.put("valorDesconto", "");
    js.put("valorMulta", "");
    js.put("valorPagamento", "5");
    js.put("complemento01", "3");
    js.put("complemento02", "7");
    js.put("complemento03", "");
    js.put("complemento04", "");
    js.put("complemento05", "");
    js.put("complemento06", "");
    js.put("centroCusto", "");
    js.put("dataFake", "");

    js.put("cpfCnpj", "");
    js.put("gravaCnpjMovimento", "FALSE");
    js.put("cnpjSomenteNumeros", "FALSE");
    js.put("valorAlternativo", "");
    js.put("Abas_Especificas", "1");
    js.put("classificaFornec", "");
    js.put("classificaPlano", "");
    js.put("contaFixaCredito", "");
    js.put("contaFixaDebito", "");
    js.put("contaFixaDesconto", "");
    js.put("contaFixaJuros", "");
    js.put("contaFixaMulta", "");
    js.put("contabilidade", "Savere");
    js.put("Contabilizacao_Atraves_Fornecedor", "FALSE");
    js.put("Conta_Fixa_Cruzamento_Extrato", "");
    js.put("Cruza_Extrato_com_Extrato", "false");
    js.put("cruzaExtrato", "false");
    js.put("empresa", "Colegionossasenhora");
    js.put("empresaDir", "");
    js.put("erpContabilidade", "QUESTOR");
    js.put("Forcar_Partida_Dobrada", "FALSE");
    js.put("Forcar_Partida_Simples", "FALSE");
    js.put("Realizar_Busca_Plano", "FALSE");
    js.put("geraGerencial", "FALSE");
    js.put("Integracao_fiscal", "false");
    js.put("Integracao_contratos", "false");
    js.put("Ler_Planilha_Pelo_Cabecalho", "FALSE");
    js.put("movimentoPortador", "PARTIDA DOBRADA");
    js.put("naoZerarValores", "FALSE");
    js.put("lerAposPrincipal", "");
    js.put("campoLinhaPrincipal", "VALOR DOCUMENTO");
    js.put("nomeRelatorioRef", "PLANILHA PADRAO OTTIMIZZA");
    js.put("Planilhas_Padroes", "");
    js.put("statusRoteiro", "EM DESENVOLVIMENTO");
    js.put("tipoArquivo", ".XLSX - EXCEL");
    js.put("tipoIntegracao", "CONTAS RECEBIDAS");
    js.put("fazerShrink", "FALSE");
    js.put("colunaShrink", "0");
    js.put("dupliNaoEncontContabil", "FALSE");
    js.put("Conta_Dupl_Contabil", "");
    js.put("Aloca_Checknum", "FALSE");
    js.put("Rotulo_Complemento_01", "");
    js.put("Rotulo_Complemento_02", "");
    js.put("Rotulo_Complemento_03", "");
    js.put("Rotulo_Complemento_04", "");
    js.put("Rotulo_Complemento_05", "");
    js.put("Colunas_de_Valores_Extras", "");
    js.put("Rotulos_Para_Valores_Extras", "");
    js.put("Colunas_de_Portadores_Extras", "");

    return js;
}

public String getTipoPlanilha(String line, String tipoPlanilha, String nomeArquivo, JSONObject jDadosObj) {
    boolean achouTipo = true;
    return tipoPlanilha;
}
public String getConta(String nomeOrigem, String documento, String nomePortador,
                       String complemento01, String complemento02, String complemento03, 
                       String nomeArquivo, String codCentroCusto) {
    String conta = "";
    String complemento04 = "";
    String complemento05 = "";
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public String getConta09(String contaMovimento, String nomeOrigem, String documento, 
                       String nomePortador, String complemento01, String complemento02, 
                       String complemento03, String nomeArquivo, String codCentroCusto) {
    String conta = contaMovimento;
    String complemento04 = "";
    String complemento05 = "";
    String complemento06 = "";
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public String getContaMovimento(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaMovimento;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    if (Integer.parseInt(dataMovimento.substring(3,5)) <= 9 &&
        Integer.parseInt(dataMovimento.substring(6)) <= 2019) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (Integer.parseInt(dataMovimento.substring(6)) <= 2018) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (!StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("PADRAOOTTIMIZZA")) {
        conta = "4864";
        contaMovimento = "4864";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000002")) {
        conta = "250272";
        contaMovimento = "250272";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000003")) {
        conta = "250273";
        contaMovimento = "250273";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000004")) {
        conta = "250274";
        contaMovimento = "250274";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000005")) {
        conta = "250275";
        contaMovimento = "250275";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101020000001")) {
        conta = "350286";
        contaMovimento = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*12010013")) {
        conta = "243705";
        contaMovimento = "243705";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013")) {
        conta = "93112";
        contaMovimento = "93112";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111208")) {
        conta = "350486";
        contaMovimento = "350486";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111209")) {
        conta = "350489";
        contaMovimento = "350489";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111201")) {
        conta = "350209";
        contaMovimento = "350209";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111207")) {
        conta = "350483";
        contaMovimento = "350483";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111210")) {
        conta = "350494";
        contaMovimento = "350494";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111202")) {
        conta = "350212";
        contaMovimento = "350212";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100025")) {
        conta = "250242";
        contaMovimento = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*21000820")) {
        conta = "250252";
        contaMovimento = "250252";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010012")) {
        conta = "250242";
        contaMovimento = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("COLINHA")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("FILANTROPICA")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("SINDICATO")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("MENSALIDA")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("FUNDAMENTA")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("MEDIO")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("INFANTIL")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("CURRICULA")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("01/") &&
        StringUtil.removeSpecialCharsToUC(complemento04).contains("CURRICULA")) {
        conta = "IGNORAR";
        contaMovimento = "IGNORAR";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO")) {
        conta = "93112INVERTE";
        contaMovimento = "93112INVERTE";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21000820") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO")) {
        conta = "250252INVERTE";
        contaMovimento = "250252INVERTE";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("12010013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("IGUAL")) {
        conta = "243705";
        contaMovimento = "243705";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("12010013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("MENOR")) {
        conta = "4948";
        contaMovimento = "4948";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*1210")) {
        conta = "250246";
        contaMovimento = "250246";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111212")) {
        conta = "350509";
        contaMovimento = "350509";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100039")) {
        conta = "250242";
        contaMovimento = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*31000300")) {
        conta = "350286";
        contaMovimento = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("IGUAL")) {
        conta = "243705";
        contaMovimento = "243705";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("MENOR")) {
        conta = "4948";
        contaMovimento = "4948";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-JUROS")) {
        conta = "1652";
        contaMovimento = "1652";
    }
    return conta;
}
public String getContaMovimento2(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaMovimento;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public String getContaMovimento3(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaMovimento;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public String getRegraContaMovimento(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaMovimento;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    if (Integer.parseInt(dataMovimento.substring(3,5)) <= 9 &&
        Integer.parseInt(dataMovimento.substring(6)) <= 2019) {
        conta = "Quando Mes Movimento menor ou igual a '09', Ano Movimento menor ou igual a '2019', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (Integer.parseInt(dataMovimento.substring(6)) <= 2018) {
        conta = "Quando Ano Movimento menor ou igual a '2018', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (!StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("PADRAOOTTIMIZZA")) {
        conta = "Quando Fornecedor/Cliente nao contem 'PADRAOOTTIMIZZA', CONTA MOVIMENTO SERA = '4864'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000002")) {
        conta = "Quando Complemento (04) contem '*3101010000002', CONTA MOVIMENTO SERA = '250272'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000003")) {
        conta = "Quando Complemento (04) contem '*3101010000003', CONTA MOVIMENTO SERA = '250273'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000004")) {
        conta = "Quando Complemento (04) contem '*3101010000004', CONTA MOVIMENTO SERA = '250274'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000005")) {
        conta = "Quando Complemento (04) contem '*3101010000005', CONTA MOVIMENTO SERA = '250275'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101020000001")) {
        conta = "Quando Complemento (04) contem '*3101020000001', CONTA MOVIMENTO SERA = '350286'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*12010013")) {
        conta = "Quando Complemento (04) contem '*12010013', CONTA MOVIMENTO SERA = '243705'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013")) {
        conta = "Quando Complemento (04) contem '21030013', CONTA MOVIMENTO SERA = '93112'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111208")) {
        conta = "Quando Complemento (04) contem '*111208', CONTA MOVIMENTO SERA = '350486'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111209")) {
        conta = "Quando Complemento (04) contem '*111209', CONTA MOVIMENTO SERA = '350489'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111201")) {
        conta = "Quando Complemento (04) contem '*111201', CONTA MOVIMENTO SERA = '350209'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111207")) {
        conta = "Quando Complemento (04) contem '*111207', CONTA MOVIMENTO SERA = '350483'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111210")) {
        conta = "Quando Complemento (04) contem '*111210', CONTA MOVIMENTO SERA = '350494'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111202")) {
        conta = "Quando Complemento (04) contem '*111202', CONTA MOVIMENTO SERA = '350212'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100025")) {
        conta = "Quando Complemento (04) contem '*3100025', CONTA MOVIMENTO SERA = '250242'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*21000820")) {
        conta = "Quando Complemento (04) contem '*21000820', CONTA MOVIMENTO SERA = '250252'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010012")) {
        conta = "Quando Complemento (04) contem '*11010012', CONTA MOVIMENTO SERA = '250242'";
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("COLINHA")) {
        conta = "Quando Fornecedor/Cliente contem 'COLINHA', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("FILANTROPICA")) {
        conta = "Quando Fornecedor/Cliente contem 'FILANTROPICA', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("SINDICATO")) {
        conta = "Quando Fornecedor/Cliente contem 'SINDICATO', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("MENSALIDA")) {
        conta = "Quando Fornecedor/Cliente contem 'MENSALIDA', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("FUNDAMENTA")) {
        conta = "Quando Fornecedor/Cliente contem 'FUNDAMENTA', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("MEDIO")) {
        conta = "Quando Fornecedor/Cliente contem 'MEDIO', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("INFANTIL")) {
        conta = "Quando Fornecedor/Cliente contem 'INFANTIL', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("CURRICULA")) {
        conta = "Quando Fornecedor/Cliente contem 'CURRICULA', CONTA MOVIMENTO SERA = 'IGNORAR'";
        return conta;
    }
    if (StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("01/") &&
        StringUtil.removeSpecialCharsToUC(complemento04).contains("CURRICULA")) {
        conta = "Quando Fornecedor/Cliente contem '01/', Complemento (04) contem 'CURRICULA', CONTA MOVIMENTO SERA = 'IGNORAR'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO")) {
        conta = "Quando Complemento (04) contem '21030013', Complemento (06) contem 'EXTRA-ANTECIPACAO', CONTA MOVIMENTO SERA = '93112' PORT: '4864'INVERTE";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21000820") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO")) {
        conta = "Quando Complemento (04) contem '21000820', Complemento (06) contem 'EXTRA-ANTECIPACAO', CONTA MOVIMENTO SERA = '250252' PORT: '250242'INVERTE";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("12010013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("IGUAL")) {
        conta = "Quando Complemento (04) contem '12010013', Complemento (06) contem 'IGUAL', CONTA MOVIMENTO SERA = '243705'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("12010013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("MENOR")) {
        conta = "Quando Complemento (04) contem '12010013', Complemento (06) contem 'MENOR', CONTA MOVIMENTO SERA = '4948'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*1210")) {
        conta = "Quando Complemento (04) contem '*1210', CONTA MOVIMENTO SERA = '250246'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111212")) {
        conta = "Quando Complemento (04) contem '*111212', CONTA MOVIMENTO SERA = '350509'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100039")) {
        conta = "Quando Complemento (04) contem '*3100039', CONTA MOVIMENTO SERA = '250242'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*31000300")) {
        conta = "Quando Complemento (04) contem '*31000300', CONTA MOVIMENTO SERA = '350286'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("IGUAL")) {
        conta = "Quando Complemento (04) contem '*3101013000001', Complemento (06) contem 'IGUAL', CONTA MOVIMENTO SERA = '243705' PORT: '93164'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("MENOR")) {
        conta = "Quando Complemento (04) contem '*3101013000001', Complemento (06) contem 'MENOR', CONTA MOVIMENTO SERA = '4948' PORT: '93164'";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-JUROS")) {
        conta = "Quando Complemento (06) contem 'EXTRA-JUROS', CONTA MOVIMENTO SERA = '1652'";
    }
    return conta;
}
public String getContaPortador(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaMovimento;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000005")) {
        conta = "97790";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000002")) {
        conta = "4864";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000003")) {
        conta = "4864";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000004")) {
        conta = "4864";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101010000005")) {
        conta = "4864";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000002")) {
        conta = "97787";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000003")) {
        conta = "97788";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000004")) {
        conta = "97789";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000005")) {
        conta = "97790";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000007")) {
        conta = "97792";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000008")) {
        conta = "97793";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000009")) {
        conta = "97794";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000010")) {
        conta = "97795";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000034")) {
        conta = "250033";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000035")) {
        conta = "250034";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101017000001")) {
        conta = "243203";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101020000001")) {
        conta = "244780";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101012000001")) {
        conta = "104506";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001")) {
        conta = "102214";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*12010013")) {
        conta = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*21030013")) {
        conta = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010011")) {
        conta = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111208")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111209")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111201")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111207")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111210")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111202")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100025")) {
        conta = "350510";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*1210")) {
        conta = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*21000820")) {
        conta = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010012")) {
        conta = "350286";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*111212")) {
        conta = "250242";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100039")) {
        conta = "350510";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("31000300")) {
        conta = "356150";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO")) {
        conta = "4864INVERTE";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("21000820") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO")) {
        conta = "250242INVERTE";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("IGUAL")) {
        conta = "93164";
    }
    if (StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001") &&
        StringUtil.removeSpecialCharsToUC(complemento06).contains("MENOR")) {
        conta = "93164";
    }
    return conta;
}
public String getContaJuros(String contaJuros, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaJuros;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public String getContaDesconto(String contaDesconto, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaDesconto;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public String getContaMulta(String contaMulta, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaJuros      = objHistorico.optString("cntaJuros");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String conta = contaMulta;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return conta;
}
public boolean getTratarComoExtrato(String line, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    boolean tratarComoExtrato = false;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return tratarComoExtrato;
}
public boolean getTratarComoDesconto(String line, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    boolean tratarComoDesconto = false;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return tratarComoDesconto;
}
public boolean getTratarComoJuros(String line, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    boolean tratarComoJuros = false;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return tratarComoJuros;
}
public boolean getTratarLinhaIgnorar(String line, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    boolean tratarIgnoraLinha = false;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return tratarIgnoraLinha;
}
public String getTratarValorAlternativo(JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String tipoLancamento  = objHistorico.optString("tipoLancamento");
    String documento    = objHistorico.optString("documento");
    String nomeOrigem    = objHistorico.optString("nomeOrigem");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    String retornoAlternativo  = "";

    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornoAlternativo;
}
public String getTratarComoDiv(String documento, String nomeOrigem, JSONObject objHistorico){
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String tipoLancamento  = objHistorico.optString("tipoLancamento");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    String classificacao  = objHistorico.optString("classificacao");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    String retornoDiv  = "";

    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornoDiv;
}
public String getCodigoClassificacao(String nomeOrigem, JSONObject objHistorico){
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String documento   = objHistorico.optString("documento");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String tipoLancamento  = objHistorico.optString("tipoLancamento");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    String classificacao  = objHistorico.optString("classificacao");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    String retornoClassificacao  = "";

    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornoClassificacao;
}
public String getModificaData(JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String tipoLancamento  = objHistorico.optString("tipoLancamento");
    String documento    = objHistorico.optString("documento");
    String nomeOrigem    = objHistorico.optString("nomeOrigem");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    String retornoData  = "";

    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornoData;
}
public String getCampoFiscal(String parametro, JSONObject objHistorico) {
    String especie         = objHistorico.optString("especie");
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String documento       = objHistorico.optString("documento");
    String nomeOrigem      = objHistorico.optString("nomeOrigem");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    int    numeroAba       = objHistorico.optInt("numeroAba");

    String returnaCodigo  = "";

    return returnaCodigo.trim();
}
public int getContadorCabecalho(int contador, String line) {
    return contador;
}
public double getValorPrincipal(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    double valorPrincipal = 0;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return valorPrincipal;
}
public String getHistorico(String conta, String histParam, String tipoLancamento, String nomeOrigem, String documento, 
                           String nomePortador, String complemento01, String complemento02, String complemento03, 
                           String nomeArquivo, String codCentroCusto) {
    String historico = "";
    if(!histParam.equals("")) historico = histParam;

    if(histParam.equals("") && tipoLancamento.contains("PAGAR"))    historico = "PAGAMENTO " + documento + " " + nomeOrigem;
    if(histParam.equals("") && tipoLancamento.contains("RECEBER"))  historico = "RECEBIMENTO " + documento + " " + nomeOrigem;


    return historico.replaceAll("  "," ").trim();
}
public String getHistoricoRegra(String conta, String histParam, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String historico = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento").replaceAll("INVERTE","");
    String contaPortador   = objHistorico.optString("contaPortador").replaceAll("INVERTE","");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String parcelaAtual    = objHistorico.optString("parcelaAtual");
    String parcelaAtualeFinal  = objHistorico.optString("parcelaAtualeFinal");
    String trimestreMesAnoAnterior = objHistorico.optString("trimestreMesAnoAnterior");
    String trimestreMesAnoAtual = objHistorico.optString("trimestreMesAnoAtual");
    String descricaoPlanoMovimento  = objHistorico.optString("descricaoPlanoMovimento");
    String descricaoPlanoPortador  = objHistorico.optString("descricaoPlanoPortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!histParam.equals("")) historico = histParam;

    if(histParam.equals("") && tipoLancamento.contains("PAGAR"))    historico = "PAGAMENTO " + documento + " " + nomeOrigem;
    if(histParam.equals("") && tipoLancamento.contains("RECEBER"))  historico = "RECEBIMENTO " + documento + " " + nomeOrigem;

    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250272"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250273"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250274"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250275"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350486"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350489"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350209"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350483"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350494"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350212"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350286"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:910";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250263"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:945";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("243705"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:911";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4948"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:911";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250246"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:911";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("93112") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*21030013"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:912";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250252"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:912";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250242") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100025"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:935";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250242") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*21000820"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:930";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250242") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010012"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:913";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000002"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:918";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000003"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:919";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000004"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:920";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000007"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:922";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000008"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:923";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000009"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:924";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000010"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:925";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000034"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:942";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000035"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:943";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101017000001"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:909";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101012000001"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:927";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:935";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010011"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:913";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("1652"))  historico = ""  + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:353";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000005"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:921";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("93112") && StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013") && StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:930";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250252") && StringUtil.removeSpecialCharsToUC(complemento04).contains("21000820") && StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO"))  historico = "" + " " + complemento03 + " " + "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:930";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350509"))  historico = "" + " " + nomeOrigem + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:901";
    

    return historico.replaceAll("  "," ").trim();
}
public String getRegraHistoricoRegra(String conta, String histParam, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String historico = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250272"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250272, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250273"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250273, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250274"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250274, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250275"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250275, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350486"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350486, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350489"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350489, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350209"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350209, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350483"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350483, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350494"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350494, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350212"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350212, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350286"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350286, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250263"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250263, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("243705"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 243705, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4948"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4948, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250246"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250246, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("93112") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*21030013"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 93112, Complemento (04) contem *21030013, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250252"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250252, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250242") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3100025"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250242, Complemento (04) contem *3100025, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250242") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*21000820"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250242, Complemento (04) contem *21000820, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250242") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010012"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250242, Complemento (04) contem *11010012, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000002"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000002, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000003"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000003, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000004"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000004, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000007"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000007, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000008"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000008, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000009"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000009, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000010"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000010, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000034"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000034, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000035"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000035, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101017000001"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101017000001, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101012000001"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101012000001, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101013000001"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101013000001, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*11010011"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *11010011, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("1652"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 1652, HISTORICO =";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("4864") && StringUtil.removeSpecialCharsToUC(complemento04).contains("*3101011000005"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 4864, Complemento (04) contem *3101011000005, HISTORICO = Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("93112") && StringUtil.removeSpecialCharsToUC(complemento04).contains("21030013") && StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 93112, Complemento (04) contem 21030013, Complemento (06) contem EXTRA-ANTECIPACAO, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("250252") && StringUtil.removeSpecialCharsToUC(complemento04).contains("21000820") && StringUtil.removeSpecialCharsToUC(complemento06).contains("EXTRA-ANTECIPACAO"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 250252, Complemento (04) contem 21000820, Complemento (06) contem EXTRA-ANTECIPACAO, HISTORICO = Complemento (03) Fornecedor/Cliente";
    
    if (StringUtil.removeSpecialCharsToUC(contaMovimento).equals("350509"))  historico = "HISTORICO POR REGRA = Quando Conta Normal - Movimento - igual a 350509, HISTORICO = Fornecedor/Cliente";
    

    return historico.replaceAll("  "," ").trim();
}
public int getParcelaBase(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    int parcelaBase = 0;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return parcelaBase;
}
public int getTotalParcelas(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    int parcelaBase = 0;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return parcelaBase;
}
public String getMesAnoBase(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    String mesAnoBase = "";
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return mesAnoBase;
}
public double getTaxaTarifa(String contaMovimento, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    double valorTaxaTarifa = 0;
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return valorTaxaTarifa;
}
public String getHistoricoPortador(String conta, String histParam, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String historico = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String parcelaAtual    = objHistorico.optString("parcelaAtual");
    String parcelaAtualeFinal  = objHistorico.optString("parcelaAtualeFinal");
    String trimestreMesAnoAnterior = objHistorico.optString("trimestreMesAnoAnterior");
    String trimestreMesAnoAtual = objHistorico.optString("trimestreMesAnoAtual");
    String descricaoPlanoMovimento  = objHistorico.optString("descricaoPlanoMovimento");
    String descricaoPlanoPortador  = objHistorico.optString("descricaoPlanoPortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!histParam.equals("")) historico = histParam;

    if(histParam.equals("") && tipoLancamento.contains("PAGAR"))    historico = "PAGAMENTO " + documento + " " + nomeOrigem;
    if(histParam.equals("") && tipoLancamento.contains("RECEBER"))  historico = "RECEBIMENTO " + documento + " " + nomeOrigem;


    return historico.replaceAll("  "," ").trim();
}
public String getHistoricoJuros(String conta, String histParam, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String historico = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String parcelaAtual    = objHistorico.optString("parcelaAtual");
    String parcelaAtualeFinal  = objHistorico.optString("parcelaAtualeFinal");
    String trimestreMesAnoAnterior = objHistorico.optString("trimestreMesAnoAnterior");
    String trimestreMesAnoAtual = objHistorico.optString("trimestreMesAnoAtual");
    String descricaoPlanoMovimento  = objHistorico.optString("descricaoPlanoMovimento");
    String descricaoPlanoPortador  = objHistorico.optString("descricaoPlanoPortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!histParam.equals("")) historico = histParam;

    if(histParam.equals("") && tipoLancamento.contains("PAGAR"))    historico = "PAGAMENTO " + documento + " " + nomeOrigem;
    if(histParam.equals("") && tipoLancamento.contains("RECEBER"))  historico = "RECEBIMENTO " + documento + " " + nomeOrigem;

    if (!StringUtil.removeSpecialCharsToUC(nomeOrigem).contains("XXXXXX"))  historico = ""  + " " + ""  + " " + ""  + " " + ""  + " " + "" + "  CodigoHistorico:353";
    

    return historico.replaceAll("  "," ").trim();
}
public String getHistoricoDesconto(String conta, String histParam, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String historico = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String parcelaAtual    = objHistorico.optString("parcelaAtual");
    String parcelaAtualeFinal  = objHistorico.optString("parcelaAtualeFinal");
    String trimestreMesAnoAnterior = objHistorico.optString("trimestreMesAnoAnterior");
    String trimestreMesAnoAtual = objHistorico.optString("trimestreMesAnoAtual");
    String descricaoPlanoMovimento  = objHistorico.optString("descricaoPlanoMovimento");
    String descricaoPlanoPortador  = objHistorico.optString("descricaoPlanoPortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!histParam.equals("")) historico = histParam;

    if(histParam.equals("") && tipoLancamento.contains("PAGAR"))    historico = "PAGAMENTO " + documento + " " + nomeOrigem;
    if(histParam.equals("") && tipoLancamento.contains("RECEBER"))  historico = "RECEBIMENTO " + documento + " " + nomeOrigem;


    return historico.replaceAll("  "," ").trim();
}
public String getHistoricoMulta(String conta, String histParam, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String historico = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    int    numeroAba       = objHistorico.optInt("numeroAba");
    String parcelaAtual    = objHistorico.optString("parcelaAtual");
    String parcelaAtualeFinal  = objHistorico.optString("parcelaAtualeFinal");
    String trimestreMesAnoAnterior = objHistorico.optString("trimestreMesAnoAnterior");
    String trimestreMesAnoAtual = objHistorico.optString("trimestreMesAnoAtual");
    String descricaoPlanoMovimento  = objHistorico.optString("descricaoPlanoMovimento");
    String descricaoPlanoPortador  = objHistorico.optString("descricaoPlanoPortador");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!histParam.equals("")) historico = histParam;

    if(histParam.equals("") && tipoLancamento.contains("PAGAR"))    historico = "PAGAMENTO " + documento + " " + nomeOrigem;
    if(histParam.equals("") && tipoLancamento.contains("RECEBER"))  historico = "RECEBIMENTO " + documento + " " + nomeOrigem;


    return historico.replaceAll("  "," ").trim();
}
public String getCentroCusto(String CentroCusto, String nomeOrigem, String documento, String nomePortador,
                             String complemento01, String complemento02, String complemento03, 
                             String nomeArquivo, String codCentroCusto) {
          String retornaCentroCusto = CentroCusto;
    String complemento04 = "";
    String complemento05 = "";
    String complemento06 = "";
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornaCentroCusto;
}
public String getTabelaContabil(String TabelaContabil, String nomeOrigem, String documento, String nomePortador,
                             String complemento01, String complemento02, String complemento03, String complemento04, String complemento05, 
                             String nomeArquivo) {
          String retornaTabelaContabil = TabelaContabil;
    String complemento06 = "";
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornaTabelaContabil;
}
public String getParticipante(String participante, String nomeOrigem, String documento, String nomePortador,
                             String complemento01, String complemento02, String complemento03, String complemento04, String complemento05, 
                             String nomeArquivo) {
          String retornaParticipantePai = participante;
    complemento04 = "";
    complemento05 = "";
    String complemento06 = "";
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornaParticipantePai;
}
public String getFilial(String codFilial, String nomeOrigem, String documento, String nomePortador,
                             String complemento01, String complemento02, String complemento03, 
                             String nomeArquivo, String codCentroCusto, String filial) {
          String retornaFilial = codFilial;
    String complemento04 = "";
    String complemento05 = "";
    String complemento06 = "";
    if (complemento03.contains("C6#")) { complemento06 = complemento03.substring(complemento03.indexOf("C6#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C6#")).trim(); }
    if (complemento03.contains("C5#")) { complemento05 = complemento03.substring(complemento03.indexOf("C5#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C5#")).trim(); }
    if (complemento03.contains("C4#")) { complemento04 = complemento03.substring(complemento03.indexOf("C4#")+3).trim(); complemento03 = complemento03.substring(0,complemento03.indexOf("C4#")).trim(); }
    return retornaFilial;
}
public String getRegrasParaAcumular(String loteParam, String chave, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String lote = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String nomePortador    = objHistorico.optString("nomePortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!chave.equals("")) lote = chave;



    return lote.trim();
}
public String getRegrasParaAcumularPortador(String loteParam, String chave, String tipoLancamento, String documento, String nomeOrigem, JSONObject objHistorico) {
    String lote = "";
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String tipoPlanilha     = objHistorico.optString("tipoPlanilha");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String nomePortador    = objHistorico.optString("nomePortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");
    if(!chave.equals("")) lote = chave;



    return lote.trim();
}
public String  getReplaceTermos(String parametro, String parametro2, JSONObject objHistorico) {
    String lote = "";
    String nomeOrigem      = objHistorico.optString("nomeOrigem");
    String documento       = objHistorico.optString("documento");
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaMovimento  = objHistorico.optString("contaMovimento");
    String contaPortador   = objHistorico.optString("contaPortador");
    String nomePortador    = objHistorico.optString("nomePortador");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    return parametro2.trim();
}
public String  getReplaceTermosAvancado(String parametro, String parametro2, JSONObject objHistorico) {
    String lote = parametro2;
    String nomeOrigem      = objHistorico.optString("nomeOrigem");
    String documento       = objHistorico.optString("documento");
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String nomePortador    = objHistorico.optString("nomePortador");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    return lote.trim();
}
public String  getLimpaCampos(String parametro, String parametro2, JSONObject objHistorico) {
    String lote = parametro2;
    String nomeOrigem      = objHistorico.optString("nomeOrigem");
    String documento       = objHistorico.optString("documento");
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String nomePortador    = objHistorico.optString("nomePortador");

    return lote.trim();
}
public String  getLimpaCamposAvancado(String parametro, String parametro2, JSONObject objHistorico) {
    String lote = parametro2;
    String nomeOrigem      = objHistorico.optString("nomeOrigem");
    String documento       = objHistorico.optString("documento");
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String nomePortador    = objHistorico.optString("nomePortador");
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String mesAnoAnterior  = objHistorico.optString("mesAnoAnterior");
    String mesAno2Anterior = objHistorico.optString("mesAno2Anterior");
    String mesAnoAtual     = objHistorico.optString("mesAnoAtual");
    String contaDebito     = objHistorico.optString("contaDebito");
    String contaCredito    = objHistorico.optString("contaCredito");
    String contaJuros      = objHistorico.optString("contaJuros");
    String contaDesconto   = objHistorico.optString("contaDesconto");
    String contaMulta      = objHistorico.optString("contaMulta");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    double valorDocumento  = objHistorico.optDouble("valorDocumento");
    double valorDesconto   = objHistorico.optDouble("valorDesconto");
    double valorJuros      = objHistorico.optDouble("valorJuros");

    return lote.trim();
}
public String getTipoGrafico(JSONObject objGrafico) {
    String complemento01   = objGrafico.optString("complemento01");
    String complemento02   = objGrafico.optString("complemento02");
    String complemento03   = objGrafico.optString("complemento03");
    String complemento04   = objGrafico.optString("complemento04");
    String complemento05   = objGrafico.optString("complemento05");
    String complemento06   = objGrafico.optString("complemento06");
    String graph = "";

    //feito para manter o legado sem problemas, sera sobreposto por regras! ;-)
    //tipos esperados: Column, Multiple_Column_Stacked, Multiple_Columns, Line, Multiple_Lines, Pie, Donut
    //Card refere-se ao Lucro/Prejuizo
    complemento01 = StringUtil.removeSpecialCharsToUC(complemento01);

    if (complemento01.startsWith("07") || complemento01.startsWith("12")) graph = "CardChart";

    if (complemento01.startsWith("01") || complemento01.startsWith("02") || complemento01.startsWith("04") || 
    	complemento01.startsWith("08") || complemento01.startsWith("09") || complemento01.startsWith("10") || 
    	complemento01.startsWith("11") || complemento01.startsWith("21"))  graph = "ColumnChart";

    if (complemento01.startsWith("15") || complemento01.startsWith("16") || complemento01.startsWith("17")) 
    	graph = "ColumnChartStacked";

    if (complemento01.startsWith("05") || complemento01.startsWith("06")) graph = "LineChart";

    if (complemento01.startsWith("18") || complemento01.startsWith("19") || complemento01.startsWith("20")) 
    	graph = "LineChartMultiple";

    if (complemento01.startsWith("03") || complemento01.startsWith("13") || complemento01.startsWith("14")) 
    	graph = "DonutChart";

    return graph;
}
public String getSimboloValor(JSONObject objGrafico) {
    String complemento01   = objGrafico.optString("complemento01");
    String complemento02   = objGrafico.optString("complemento02");
    String complemento03   = objGrafico.optString("complemento03");
    String complemento04   = objGrafico.optString("complemento04");
    String complemento05   = objGrafico.optString("complemento05");
    String complemento06   = objGrafico.optString("complemento06");
    String simboloValor = "R$";

    complemento01 = StringUtil.removeSpecialCharsToUC(complemento01);

    return simboloValor.replaceAll("Nenhum","");
}
public String getSeriesGrafico(JSONObject objGrafico) {
    String complemento01   = objGrafico.optString("complemento01");
    String complemento02   = objGrafico.optString("complemento02");
    String complemento03   = objGrafico.optString("complemento03");
    String complemento04   = objGrafico.optString("complemento04");
    String complemento05   = objGrafico.optString("complemento05");
    String complemento06   = objGrafico.optString("complemento06");
    String series = "";

    complemento01 = StringUtil.removeSpecialCharsToUC(complemento01);

    return series;
}
public String getTituloGrafico(JSONObject objGrafico) {
    String complemento01   = objGrafico.optString("complemento01");
    String complemento02   = objGrafico.optString("complemento02");
    String complemento03   = objGrafico.optString("complemento03");
    String complemento04   = objGrafico.optString("complemento04");
    String complemento05   = objGrafico.optString("complemento05");
    String complemento06   = objGrafico.optString("complemento06");
    String Titulo_Grafico = "";

    complemento01 = StringUtil.removeSpecialCharsToUC(complemento01);

    return Titulo_Grafico;
}
public String getColunaAlternativa(String parametro, JSONObject objHistorico) {
    String complemento01   = objHistorico.optString("complemento01");
    String complemento02   = objHistorico.optString("complemento02");
    String complemento03   = objHistorico.optString("complemento03");
    String complemento04   = objHistorico.optString("complemento04");
    String complemento05   = objHistorico.optString("complemento05");
    String complemento06   = objHistorico.optString("complemento06");
    String complemento07   = objHistorico.optString("complemento07");
    String complemento08   = objHistorico.optString("complemento08");
    String complemento09   = objHistorico.optString("complemento09");
    String complemento10   = objHistorico.optString("complemento10");
    String nomeArquivo     = objHistorico.optString("nomeArquivo").toUpperCase();
    String dataMovimento   = objHistorico.optString("dataMovimento");
    String nomePortador    = objHistorico.optString("nomePortador");
    String tipoPlanilha    = objHistorico.optString("tipoPlanilha");
    String documento       = objHistorico.optString("documento");
    String nomeOrigem      = objHistorico.optString("nomeOrigem");
    String codCentroCusto  = objHistorico.optString("centroCusto");
    int    numeroAba       = objHistorico.optInt("numeroAba");

    String retornaColunas  = "";

    return retornaColunas.replace(",",";").trim();
}

/*#############################################@ EXTRATO-BOTICARIO-EXCEL @##############################################*/

/*#############################################@ EXTRATO-BOTICARIO-EXCEL @##############################################*/

/*#############################################@ EXTRATO-BOTICARIO-EXCEL @##############################################*/
